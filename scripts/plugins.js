function FourierTransform(t,e){this.bufferSize=t,this.sampleRate=e,this.bandwidth=2/t*e/2,this.spectrum=new Float32Array(t/2),this.real=new Float32Array(t),this.imag=new Float32Array(t),this.peakBand=0,this.peak=0,this.getBandFrequency=function(t){return this.bandwidth*t+this.bandwidth/2},this.calculateSpectrum=function(){for(var e,n,i,r=this.spectrum,s=this.real,o=this.imag,a=2/this.bufferSize,l=Math.sqrt,u=0,h=t/2;h>u;u++)e=s[u],n=o[u],i=a*l(e*e+n*n),i>this.peak&&(this.peakBand=u,this.peak=i),r[u]=i}}function FFT(t,e){FourierTransform.call(this,t,e),this.reverseTable=new Uint32Array(t);for(var n,i=1,r=t>>1;t>i;){for(n=0;i>n;n++)this.reverseTable[n+i]=this.reverseTable[n]+r;i<<=1,r>>=1}for(this.sinTable=new Float32Array(t),this.cosTable=new Float32Array(t),n=0;t>n;n++)this.sinTable[n]=Math.sin(-Math.PI/n),this.cosTable[n]=Math.cos(-Math.PI/n)}+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.affix"),s="object"==typeof e&&e;r||i.data("bs.affix",r=new n(this,s)),"string"==typeof e&&r[e]()})}var n=function(e,i){this.options=t.extend({},n.DEFAULTS,i),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};n.VERSION="3.3.6",n.RESET="affix affix-top affix-bottom",n.DEFAULTS={offset:0,target:window},n.prototype.getState=function(t,e,n,i){var r=this.$target.scrollTop(),s=this.$element.offset(),o=this.$target.height();if(null!=n&&"top"==this.affixed)return n>r?"top":!1;if("bottom"==this.affixed)return null!=n?r+this.unpin<=s.top?!1:"bottom":t-i>=r+o?!1:"bottom";var a=null==this.affixed,l=a?r:s.top,u=a?o:e;return null!=n&&n>=r?"top":null!=i&&l+u>=t-i?"bottom":!1},n.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(n.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},n.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},n.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),i=this.options.offset,r=i.top,s=i.bottom,o=Math.max(t(document).height(),t(document.body).height());"object"!=typeof i&&(s=r=i),"function"==typeof r&&(r=i.top(this.$element)),"function"==typeof s&&(s=i.bottom(this.$element));var a=this.getState(o,e,r,s);if(this.affixed!=a){null!=this.unpin&&this.$element.css("top","");var l="affix"+(a?"-"+a:""),u=t.Event(l+".bs.affix");if(this.$element.trigger(u),u.isDefaultPrevented())return;this.affixed=a,this.unpin="bottom"==a?this.getPinnedOffset():null,this.$element.removeClass(n.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==a&&this.$element.offset({top:o-e-s})}};var i=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=n,t.fn.affix.noConflict=function(){return t.fn.affix=i,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var n=t(this),i=n.data();i.offset=i.offset||{},null!=i.offsetBottom&&(i.offset.bottom=i.offsetBottom),null!=i.offsetTop&&(i.offset.top=i.offsetTop),e.call(n,i)})})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),r=n.data("bs.alert");r||n.data("bs.alert",r=new i(this)),"string"==typeof e&&r[e].call(n)})}var n='[data-dismiss="alert"]',i=function(e){t(e).on("click",n,this.close)};i.VERSION="3.3.6",i.TRANSITION_DURATION=150,i.prototype.close=function(e){function n(){o.detach().trigger("closed.bs.alert").remove()}var r=t(this),s=r.attr("data-target");s||(s=r.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,""));var o=t(s);e&&e.preventDefault(),o.length||(o=r.closest(".alert")),o.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(o.removeClass("in"),t.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",n).emulateTransitionEnd(i.TRANSITION_DURATION):n())};var r=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=r,this},t(document).on("click.bs.alert.data-api",n,i.prototype.close)}(jQuery),+function(t){"use strict";function e(e){var n=e.attr("data-target");n||(n=e.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&t(n);return i&&i.length?i:e.parent()}function n(n){n&&3===n.which||(t(r).remove(),t(s).each(function(){var i=t(this),r=e(i),s={relatedTarget:this};r.hasClass("open")&&(n&&"click"==n.type&&/input|textarea/i.test(n.target.tagName)&&t.contains(r[0],n.target)||(r.trigger(n=t.Event("hide.bs.dropdown",s)),n.isDefaultPrevented()||(i.attr("aria-expanded","false"),r.removeClass("open").trigger(t.Event("hidden.bs.dropdown",s)))))}))}function i(e){return this.each(function(){var n=t(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new o(this)),"string"==typeof e&&i[e].call(n)})}var r=".dropdown-backdrop",s='[data-toggle="dropdown"]',o=function(e){t(e).on("click.bs.dropdown",this.toggle)};o.VERSION="3.3.6",o.prototype.toggle=function(i){var r=t(this);if(!r.is(".disabled, :disabled")){var s=e(r),o=s.hasClass("open");if(n(),!o){"ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",n);var a={relatedTarget:this};if(s.trigger(i=t.Event("show.bs.dropdown",a)),i.isDefaultPrevented())return;r.trigger("focus").attr("aria-expanded","true"),s.toggleClass("open").trigger(t.Event("shown.bs.dropdown",a))}return!1}},o.prototype.keydown=function(n){if(/(38|40|27|32)/.test(n.which)&&!/input|textarea/i.test(n.target.tagName)){var i=t(this);if(n.preventDefault(),n.stopPropagation(),!i.is(".disabled, :disabled")){var r=e(i),o=r.hasClass("open");if(!o&&27!=n.which||o&&27==n.which)return 27==n.which&&r.find(s).trigger("focus"),i.trigger("click");var a=" li:not(.disabled):visible a",l=r.find(".dropdown-menu"+a);if(l.length){var u=l.index(n.target);38==n.which&&u>0&&u--,40==n.which&&u<l.length-1&&u++,~u||(u=0),l.eq(u).trigger("focus")}}}};var a=t.fn.dropdown;t.fn.dropdown=i,t.fn.dropdown.Constructor=o,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=a,this},t(document).on("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",s,o.prototype.toggle).on("keydown.bs.dropdown.data-api",s,o.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",o.prototype.keydown)}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.tooltip"),s="object"==typeof e&&e;(r||!/destroy|hide/.test(e))&&(r||i.data("bs.tooltip",r=new n(this,s)),"string"==typeof e&&r[e]())})}var n=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};n.VERSION="3.3.6",n.TRANSITION_DURATION=150,n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(e,n,i){if(this.enabled=!0,this.type=e,this.$element=t(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&t(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var r=this.options.trigger.split(" "),s=r.length;s--;){var o=r[s];if("click"==o)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=o){var a="hover"==o?"mouseenter":"focusin",l="hover"==o?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},n.prototype.getDelegateOptions=function(){var e={},n=this.getDefaults();return this._options&&t.each(this._options,function(t,i){n[t]!=i&&(e[t]=i)}),e},n.prototype.enter=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusin"==e.type?"focus":"hover"]=!0),n.tip().hasClass("in")||"in"==n.hoverState?void(n.hoverState="in"):(clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show())},n.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},n.prototype.leave=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusout"==e.type?"focus":"hover"]=!1),n.isInStateTrue()?void 0:(clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide())},n.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var i=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!i)return;var r=this,s=this.tip(),o=this.getUID(this.type);this.setContent(),s.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&s.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,s[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,u=l.test(a);u&&(a=a.replace(l,"")||"top"),s.detach().css({top:0,left:0,display:"block"}).addClass(a).data("bs."+this.type,this),this.options.container?s.appendTo(this.options.container):s.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var h=this.getPosition(),c=s[0].offsetWidth,f=s[0].offsetHeight;if(u){var d=a,p=this.getPosition(this.$viewport);a="bottom"==a&&h.bottom+f>p.bottom?"top":"top"==a&&h.top-f<p.top?"bottom":"right"==a&&h.right+c>p.width?"left":"left"==a&&h.left-c<p.left?"right":a,s.removeClass(d).addClass(a)}var m=this.getCalculatedOffset(a,h,c,f);this.applyPlacement(m,a);var g=function(){var t=r.hoverState;r.$element.trigger("shown.bs."+r.type),r.hoverState=null,"out"==t&&r.leave(r)};t.support.transition&&this.$tip.hasClass("fade")?s.one("bsTransitionEnd",g).emulateTransitionEnd(n.TRANSITION_DURATION):g()}},n.prototype.applyPlacement=function(e,n){var i=this.tip(),r=i[0].offsetWidth,s=i[0].offsetHeight,o=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(a)&&(a=0),e.top+=o,e.left+=a,t.offset.setOffset(i[0],t.extend({using:function(t){i.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),i.addClass("in");var l=i[0].offsetWidth,u=i[0].offsetHeight;"top"==n&&u!=s&&(e.top=e.top+s-u);var h=this.getViewportAdjustedDelta(n,e,l,u);h.left?e.left+=h.left:e.top+=h.top;var c=/top|bottom/.test(n),f=c?2*h.left-r+l:2*h.top-s+u,d=c?"offsetWidth":"offsetHeight";i.offset(e),this.replaceArrow(f,i[0][d],c)},n.prototype.replaceArrow=function(t,e,n){this.arrow().css(n?"left":"top",50*(1-t/e)+"%").css(n?"top":"left","")},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},n.prototype.hide=function(e){function i(){"in"!=r.hoverState&&s.detach(),r.$element.removeAttr("aria-describedby").trigger("hidden.bs."+r.type),e&&e()}var r=this,s=t(this.$tip),o=t.Event("hide.bs."+this.type);return this.$element.trigger(o),o.isDefaultPrevented()?void 0:(s.removeClass("in"),t.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",i).emulateTransitionEnd(n.TRANSITION_DURATION):i(),this.hoverState=null,this)},n.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(e){e=e||this.$element;var n=e[0],i="BODY"==n.tagName,r=n.getBoundingClientRect();null==r.width&&(r=t.extend({},r,{width:r.right-r.left,height:r.bottom-r.top}));var s=i?{top:0,left:0}:e.offset(),o={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},a=i?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},r,o,a,s)},n.prototype.getCalculatedOffset=function(t,e,n,i){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-n/2}:"top"==t?{top:e.top-i,left:e.left+e.width/2-n/2}:"left"==t?{top:e.top+e.height/2-i/2,left:e.left-n}:{top:e.top+e.height/2-i/2,left:e.left+e.width}},n.prototype.getViewportAdjustedDelta=function(t,e,n,i){var r={top:0,left:0};if(!this.$viewport)return r;var s=this.options.viewport&&this.options.viewport.padding||0,o=this.getPosition(this.$viewport);if(/right|left/.test(t)){var a=e.top-s-o.scroll,l=e.top+s-o.scroll+i;a<o.top?r.top=o.top-a:l>o.top+o.height&&(r.top=o.top+o.height-l)}else{var u=e.left-s,h=e.left+s+n;u<o.left?r.left=o.left-u:h>o.right&&(r.left=o.left+o.width-h)}return r},n.prototype.getTitle=function(){var t,e=this.$element,n=this.options;return t=e.attr("data-original-title")||("function"==typeof n.title?n.title.call(e[0]):n.title)},n.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},n.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(e){var n=this;e&&(n=t(e.currentTarget).data("bs."+this.type),n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n))),e?(n.inState.click=!n.inState.click,n.isInStateTrue()?n.enter(n):n.leave(n)):n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null})};var i=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=n,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(jQuery),+function(t){"use strict";function e(e,i){return this.each(function(){var r=t(this),s=r.data("bs.modal"),o=t.extend({},n.DEFAULTS,r.data(),"object"==typeof e&&e);s||r.data("bs.modal",s=new n(this,o)),"string"==typeof e?s[e](i):o.show&&s.show(i)})}var n=function(e,n){this.options=n,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};n.VERSION="3.3.6",n.TRANSITION_DURATION=300,n.BACKDROP_TRANSITION_DURATION=150,n.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},n.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},n.prototype.show=function(e){var i=this,r=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(r),this.isShown||r.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){i.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(i.$element)&&(i.ignoreBackdropClick=!0)})}),this.backdrop(function(){var r=t.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),i.adjustDialog(),r&&i.$element[0].offsetWidth,i.$element.addClass("in"),i.enforceFocus();var s=t.Event("shown.bs.modal",{relatedTarget:e});r?i.$dialog.one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(s)}).emulateTransitionEnd(n.TRANSITION_DURATION):i.$element.trigger("focus").trigger(s)}))},n.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(n.TRANSITION_DURATION):this.hideModal())},n.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},n.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},n.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},n.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},n.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},n.prototype.backdrop=function(e){var i=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=t.support.transition&&r;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+r).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;s?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var o=function(){i.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):o()}else e&&e()},n.prototype.handleUpdate=function(){this.adjustDialog()},n.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},n.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},n.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},n.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},n.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},n.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var i=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=n,t.fn.modal.noConflict=function(){return t.fn.modal=i,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(n){var i=t(this),r=i.attr("href"),s=t(i.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),o=s.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(r)&&r},s.data(),i.data());i.is("a")&&n.preventDefault(),s.one("show.bs.modal",function(t){t.isDefaultPrevented()||s.one("hidden.bs.modal",function(){i.is(":visible")&&i.trigger("focus")})}),e.call(s,o,this)})}(jQuery),+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(void 0!==t.style[n])return{end:e[n]};return!1}t.fn.emulateTransitionEnd=function(e){var n=!1,i=this;t(this).one("bsTransitionEnd",function(){n=!0});var r=function(){n||t(i).trigger(t.support.transition.end)};return setTimeout(r,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){return t(e.target).is(this)?e.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.button"),s="object"==typeof e&&e;r||i.data("bs.button",r=new n(this,s)),"toggle"==e?r.toggle():e&&r.setState(e)})}var n=function(e,i){this.$element=t(e),this.options=t.extend({},n.DEFAULTS,i),this.isLoading=!1};n.VERSION="3.3.6",n.DEFAULTS={loadingText:"loading..."},n.prototype.setState=function(e){var n="disabled",i=this.$element,r=i.is("input")?"val":"html",s=i.data();e+="Text",null==s.resetText&&i.data("resetText",i[r]()),setTimeout(t.proxy(function(){i[r](null==s[e]?this.options[e]:s[e]),"loadingText"==e?(this.isLoading=!0,i.addClass(n).attr(n,n)):this.isLoading&&(this.isLoading=!1,i.removeClass(n).removeAttr(n))},this),0)},n.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var n=this.$element.find("input");"radio"==n.prop("type")?(n.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==n.prop("type")&&(n.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),t&&n.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var i=t.fn.button;t.fn.button=e,t.fn.button.Constructor=n,t.fn.button.noConflict=function(){return t.fn.button=i,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(n){var i=t(n.target);i.hasClass("btn")||(i=i.closest(".btn")),e.call(i,"toggle"),t(n.target).is('input[type="radio"]')||t(n.target).is('input[type="checkbox"]')||n.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.popover"),s="object"==typeof e&&e;(r||!/destroy|hide/.test(e))&&(r||i.data("bs.popover",r=new n(this,s)),"string"==typeof e&&r[e]())})}var n=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.3.6",n.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),n.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),n.prototype.constructor=n,n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),n=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof n?"html":"append":"text"](n),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var i=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=n,t.fn.popover.noConflict=function(){return t.fn.popover=i,this}}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.carousel"),s=t.extend({},n.DEFAULTS,i.data(),"object"==typeof e&&e),o="string"==typeof e?e:s.slide;r||i.data("bs.carousel",r=new n(this,s)),"number"==typeof e?r.to(e):o?r[o]():s.interval&&r.pause().cycle()})}var n=function(e,n){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};n.VERSION="3.3.6",n.TRANSITION_DURATION=600,n.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},n.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},n.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},n.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},n.prototype.getItemForDirection=function(t,e){var n=this.getItemIndex(e),i="prev"==t&&0===n||"next"==t&&n==this.$items.length-1;if(i&&!this.options.wrap)return e;var r="prev"==t?-1:1,s=(n+r)%this.$items.length;return this.$items.eq(s)},n.prototype.to=function(t){var e=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",this.$items.eq(t))},n.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},n.prototype.next=function(){return this.sliding?void 0:this.slide("next")},n.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},n.prototype.slide=function(e,i){var r=this.$element.find(".item.active"),s=i||this.getItemForDirection(e,r),o=this.interval,a="next"==e?"left":"right",l=this;if(s.hasClass("active"))return this.sliding=!1;var u=s[0],h=t.Event("slide.bs.carousel",{relatedTarget:u,direction:a});if(this.$element.trigger(h),!h.isDefaultPrevented()){if(this.sliding=!0,o&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var c=t(this.$indicators.children()[this.getItemIndex(s)]);c&&c.addClass("active")}var f=t.Event("slid.bs.carousel",{relatedTarget:u,direction:a});return t.support.transition&&this.$element.hasClass("slide")?(s.addClass(e),s[0].offsetWidth,r.addClass(a),s.addClass(a),r.one("bsTransitionEnd",function(){s.removeClass([e,a].join(" ")).addClass("active"),r.removeClass(["active",a].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(f)},0)}).emulateTransitionEnd(n.TRANSITION_DURATION)):(r.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger(f)),o&&this.cycle(),this}};var i=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=n,t.fn.carousel.noConflict=function(){return t.fn.carousel=i,this};var r=function(n){var i,r=t(this),s=t(r.attr("data-target")||(i=r.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""));if(s.hasClass("carousel")){var o=t.extend({},s.data(),r.data()),a=r.attr("data-slide-to");a&&(o.interval=!1),e.call(s,o),a&&s.data("bs.carousel").to(a),n.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",r).on("click.bs.carousel.data-api","[data-slide-to]",r),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var n=t(this);e.call(n,n.data())})})}(jQuery),+function(t){"use strict";function e(n,i){this.$body=t(document.body),this.$scrollElement=t(t(n).is(document.body)?window:n),this.options=t.extend({},e.DEFAULTS,i),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function n(n){return this.each(function(){var i=t(this),r=i.data("bs.scrollspy"),s="object"==typeof n&&n;r||i.data("bs.scrollspy",r=new e(this,s)),"string"==typeof n&&r[n]()})}e.VERSION="3.3.6",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e=this,n="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(n="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=t(this),r=e.data("target")||e.attr("href"),s=/^#./.test(r)&&t(r);return s&&s.length&&s.is(":visible")&&[[s[n]().top+i,r]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,n=this.getScrollHeight(),i=this.options.offset+n-this.$scrollElement.height(),r=this.offsets,s=this.targets,o=this.activeTarget;if(this.scrollHeight!=n&&this.refresh(),e>=i)return o!=(t=s[s.length-1])&&this.activate(t);if(o&&e<r[0])return this.activeTarget=null,this.clear();for(t=r.length;t--;)o!=s[t]&&e>=r[t]&&(void 0===r[t+1]||e<r[t+1])&&this.activate(s[t])},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var n=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',i=t(n).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var i=t.fn.scrollspy;t.fn.scrollspy=n,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=i,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){
var e=t(this);n.call(e,e.data())})})}(jQuery),+function(t){"use strict";function e(e){var n,i=e.attr("data-target")||(n=e.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return t(i)}function n(e){return this.each(function(){var n=t(this),r=n.data("bs.collapse"),s=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e);!r&&s.toggle&&/show|hide/.test(e)&&(s.toggle=!1),r||n.data("bs.collapse",r=new i(this,s)),"string"==typeof e&&r[e]()})}var i=function(e,n){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,n),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};i.VERSION="3.3.6",i.TRANSITION_DURATION=350,i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,r=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(r&&r.length&&(e=r.data("bs.collapse"),e&&e.transitioning))){var s=t.Event("show.bs.collapse");if(this.$element.trigger(s),!s.isDefaultPrevented()){r&&r.length&&(n.call(r,"hide"),e||r.data("bs.collapse",null));var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var a=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return a.call(this);var l=t.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",t.proxy(a,this)).emulateTransitionEnd(i.TRANSITION_DURATION)[o](this.$element[0][l])}}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var r=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return t.support.transition?void this.$element[n](0).one("bsTransitionEnd",t.proxy(r,this)).emulateTransitionEnd(i.TRANSITION_DURATION):r.call(this)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},i.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(n,i){var r=t(i);this.addAriaAndCollapsedClass(e(r),r)},this)).end()},i.prototype.addAriaAndCollapsedClass=function(t,e){var n=t.hasClass("in");t.attr("aria-expanded",n),e.toggleClass("collapsed",!n).attr("aria-expanded",n)};var r=t.fn.collapse;t.fn.collapse=n,t.fn.collapse.Constructor=i,t.fn.collapse.noConflict=function(){return t.fn.collapse=r,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var r=t(this);r.attr("data-target")||i.preventDefault();var s=e(r),o=s.data("bs.collapse"),a=o?"toggle":r.data();n.call(s,a)})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.tab");r||i.data("bs.tab",r=new n(this)),"string"==typeof e&&r[e]()})}var n=function(e){this.element=t(e)};n.VERSION="3.3.6",n.TRANSITION_DURATION=150,n.prototype.show=function(){var e=this.element,n=e.closest("ul:not(.dropdown-menu)"),i=e.data("target");if(i||(i=e.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var r=n.find(".active:last a"),s=t.Event("hide.bs.tab",{relatedTarget:e[0]}),o=t.Event("show.bs.tab",{relatedTarget:r[0]});if(r.trigger(s),e.trigger(o),!o.isDefaultPrevented()&&!s.isDefaultPrevented()){var a=t(i);this.activate(e.closest("li"),n),this.activate(a,a.parent(),function(){r.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:r[0]})})}}},n.prototype.activate=function(e,i,r){function s(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),a?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),r&&r()}var o=i.find("> .active"),a=r&&t.support.transition&&(o.length&&o.hasClass("fade")||!!i.find("> .fade").length);o.length&&a?o.one("bsTransitionEnd",s).emulateTransitionEnd(n.TRANSITION_DURATION):s(),o.removeClass("in")};var i=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=n,t.fn.tab.noConflict=function(){return t.fn.tab=i,this};var r=function(n){n.preventDefault(),e.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',r).on("click.bs.tab.data-api",'[data-toggle="pill"]',r)}(jQuery);var Stats=function(){function t(t,e,n){return t=document.createElement(t),t.id=e,t.style.cssText=n,t}function e(e,n,i){var r=t("div",e,"padding:0 0 3px 3px;text-align:left;background:"+i),s=t("div",e+"Text","font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:"+n);for(s.innerHTML=e.toUpperCase(),r.appendChild(s),e=t("div",e+"Graph","width:74px;height:30px;background:"+n),r.appendChild(e),n=0;74>n;n++)e.appendChild(t("span","","width:1px;height:30px;float:left;opacity:0.9;background:"+i));return r}function n(t){for(var e=u.children,n=0;n<e.length;n++)e[n].style.display=n===t?"block":"none";l=t}function i(t,e){t.appendChild(t.firstChild).style.height=Math.min(30,30-30*e)+"px"}var r=self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now,s=r(),o=s,a=0,l=0,u=t("div","stats","width:80px;opacity:0.9;cursor:pointer");u.addEventListener("mousedown",function(t){t.preventDefault(),n(++l%u.children.length)},!1);var h=0,c=1/0,f=0,d=e("fps","#0ff","#002"),p=d.children[0],m=d.children[1];u.appendChild(d);var g=0,v=1/0,b=0,d=e("ms","#0f0","#020"),y=d.children[0],_=d.children[1];if(u.appendChild(d),self.performance&&self.performance.memory){var w=0,x=1/0,A=0,d=e("mb","#f08","#201"),k=d.children[0],S=d.children[1];u.appendChild(d)}return n(l),{REVISION:14,domElement:u,setMode:n,begin:function(){s=r()},end:function(){var t=r();if(g=t-s,v=Math.min(v,g),b=Math.max(b,g),y.textContent=(0|g)+" MS ("+(0|v)+"-"+(0|b)+")",i(_,g/200),a++,t>o+1e3&&(h=Math.round(1e3*a/(t-o)),c=Math.min(c,h),f=Math.max(f,h),p.textContent=h+" FPS ("+c+"-"+f+")",i(m,h/100),o=t,a=0,void 0!==w)){var e=performance.memory.usedJSHeapSize,n=performance.memory.jsHeapSizeLimit;w=Math.round(9.54e-7*e),x=Math.min(x,w),A=Math.max(A,w),k.textContent=w+" MB ("+x+"-"+A+")",i(S,e/n)}return t},update:function(){s=this.end()}}};"object"==typeof module&&(module.exports=Stats),"function"!=typeof JSON.decycle&&(JSON.decycle=function(t){"use strict";var e=[],n=[];return function i(t,r){var s,o,a;if(!("object"!=typeof t||null===t||t instanceof Boolean||t instanceof Date||t instanceof Number||t instanceof RegExp||t instanceof String)){for(s=0;s<e.length;s+=1)if(e[s]===t)return{$ref:n[s]};if(e.push(t),n.push(r),"[object Array]"===Object.prototype.toString.apply(t))for(a=[],s=0;s<t.length;s+=1)a[s]=i(t[s],r+"["+s+"]");else{a={};for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&(a[o]=i(t[o],r+"["+JSON.stringify(o)+"]"))}return a}return t}(t,"$")}),"function"!=typeof JSON.retrocycle&&(JSON.retrocycle=function retrocycle($){"use strict";var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;return function rez(value){var i,item,name,path;if(value&&"object"==typeof value)if("[object Array]"===Object.prototype.toString.apply(value))for(i=0;i<value.length;i+=1)item=value[i],item&&"object"==typeof item&&(path=item.$ref,"string"==typeof path&&px.test(path)?value[i]=eval(path):rez(item));else for(name in value)"object"==typeof value[name]&&(item=value[name],item&&(path=item.$ref,"string"==typeof path&&px.test(path)?value[name]=eval(path):rez(item)))}($),$}),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.pixicam=t()}}(function(){var t;return function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[o]={exports:{}};t[o][0].call(h.exports,function(e){var n=t[o][1][e];return r(n?n:e)},h,h.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e,n){(function(n){var i=e.exports={Camera:t("./camera"),World:t("./world"),Minimap:t("./minimap"),mixins:t("./mixins")};n.pixicam=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./camera":52,"./minimap":56,"./mixins":57,"./world":61}],2:[function(t,e,n){function i(t){if(l(t)&&!a(t)&&!(t instanceof r)){if(t instanceof s)return t;if(c.call(t,"__chain__")&&c.call(t,"__wrapped__"))return u(t)}return new s(t)}var r=t("../internal/LazyWrapper"),s=t("../internal/LodashWrapper"),o=t("../internal/baseLodash"),a=t("../lang/isArray"),l=t("../internal/isObjectLike"),u=t("../internal/wrapperClone"),h=Object.prototype,c=h.hasOwnProperty;i.prototype=o.prototype,e.exports=i},{"../internal/LazyWrapper":6,"../internal/LodashWrapper":7,"../internal/baseLodash":13,"../internal/isObjectLike":32,"../internal/wrapperClone":39,"../lang/isArray":41}],3:[function(t,e,n){var i=t("../internal/getNative"),r=i(Date,"now"),s=r||function(){return(new Date).getTime()};e.exports=s},{"../internal/getNative":27}],4:[function(t,e,n){var i=t("../internal/baseFlatten"),r=t("../internal/createWrapper"),s=t("../object/functions"),o=t("./restParam"),a=1,l=o(function(t,e){e=e.length?i(e):s(t);for(var n=-1,o=e.length;++n<o;){var l=e[n];t[l]=r(t[l],a,t)}return t});e.exports=l},{"../internal/baseFlatten":10,"../internal/createWrapper":23,"../object/functions":45,"./restParam":5}],5:[function(t,e,n){function i(t,e){if("function"!=typeof t)throw new TypeError(r);return e=s(void 0===e?t.length-1:+e||0,0),function(){for(var n=arguments,i=-1,r=s(n.length-e,0),o=Array(r);++i<r;)o[i]=n[e+i];switch(e){case 0:return t.call(this,o);case 1:return t.call(this,n[0],o);case 2:return t.call(this,n[0],n[1],o)}var a=Array(e+1);for(i=-1;++i<e;)a[i]=n[i];return a[e]=o,t.apply(this,a)}}var r="Expected a function",s=Math.max;e.exports=i},{}],6:[function(t,e,n){function i(t){this.__wrapped__=t,this.__actions__=null,this.__dir__=1,this.__dropCount__=0,this.__filtered__=!1,this.__iteratees__=null,this.__takeCount__=o,this.__views__=null}var r=t("./baseCreate"),s=t("./baseLodash"),o=Number.POSITIVE_INFINITY;i.prototype=r(s.prototype),i.prototype.constructor=i,e.exports=i},{"./baseCreate":9,"./baseLodash":13}],7:[function(t,e,n){function i(t,e,n){this.__wrapped__=t,this.__actions__=n||[],this.__chain__=!!e}var r=t("./baseCreate"),s=t("./baseLodash");i.prototype=r(s.prototype),i.prototype.constructor=i,e.exports=i},{"./baseCreate":9,"./baseLodash":13}],8:[function(t,e,n){function i(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}e.exports=i},{}],9:[function(t,e,n){var i=t("../lang/isObject"),r=function(){function t(){}return function(e){if(i(e)){t.prototype=e;var n=new t;t.prototype=null}return n||{}}}();e.exports=r},{"../lang/isObject":44}],10:[function(t,e,n){function i(t,e,n){for(var l=-1,u=t.length,h=-1,c=[];++l<u;){var f=t[l];if(a(f)&&o(f)&&(n||s(f)||r(f))){e&&(f=i(f,e,n));for(var d=-1,p=f.length;++d<p;)c[++h]=f[d]}else n||(c[++h]=f)}return c}var r=t("../lang/isArguments"),s=t("../lang/isArray"),o=t("./isArrayLike"),a=t("./isObjectLike");e.exports=i},{"../lang/isArguments":40,"../lang/isArray":41,"./isArrayLike":28,"./isObjectLike":32}],11:[function(t,e,n){function i(t,e){for(var n=-1,i=e.length,s=-1,o=[];++n<i;){var a=e[n];r(t[a])&&(o[++s]=a)}return o}var r=t("../lang/isFunction");e.exports=i},{"../lang/isFunction":42}],12:[function(t,e,n){function i(t){return"function"==typeof t||!1}e.exports=i},{}],13:[function(t,e,n){function i(){}e.exports=i},{}],14:[function(t,e,n){function i(t){return function(e){return null==e?void 0:e[t]}}e.exports=i},{}],15:[function(t,e,n){var i=t("../utility/identity"),r=t("./metaMap"),s=r?function(t,e){return r.set(t,e),t}:i;e.exports=s},{"../utility/identity":48,"./metaMap":34}],16:[function(t,e,n){function i(t){return"string"==typeof t?t:null==t?"":t+""}e.exports=i},{}],17:[function(t,e,n){function i(t,e,n){for(var i=n.length,s=-1,o=r(t.length-i,0),a=-1,l=e.length,u=Array(o+l);++a<l;)u[a]=e[a];for(;++s<i;)u[n[s]]=t[s];for(;o--;)u[a++]=t[s++];return u}var r=Math.max;e.exports=i},{}],18:[function(t,e,n){function i(t,e,n){for(var i=-1,s=n.length,o=-1,a=r(t.length-s,0),l=-1,u=e.length,h=Array(a+u);++o<a;)h[o]=t[o];for(var c=o;++l<u;)h[c+l]=e[l];for(;++i<s;)h[c+n[i]]=t[o++];return h}var r=Math.max;e.exports=i},{}],19:[function(t,e,n){(function(n){function i(t,e){function i(){var r=this&&this!==n&&this instanceof i?s:t;return r.apply(e,arguments)}var s=r(t);return i}var r=t("./createCtorWrapper");e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./createCtorWrapper":20}],20:[function(t,e,n){function i(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4])}var n=r(t.prototype),i=t.apply(n,e);return s(i)?i:n}}var r=t("./baseCreate"),s=t("../lang/isObject");e.exports=i},{"../lang/isObject":44,"./baseCreate":9}],21:[function(t,e,n){(function(n){function i(t,e,w,x,A,k,S,T,C,M){function I(){for(var p=arguments.length,m=p,g=Array(p);m--;)g[m]=arguments[m];if(x&&(g=s(g,x,A)),k&&(g=o(g,k,S)),D||P){var y=I.placeholder,N=h(g,y);if(p-=N.length,M>p){var F=T?r(T):null,B=_(M-p,0),$=D?N:null,z=D?null:N,q=D?g:null,W=D?null:g;e|=D?v:b,e&=~(D?b:v),L||(e&=~(f|d));var V=[t,e,w,q,$,W,z,F,C,B],G=i.apply(void 0,V);return l(t)&&c(G,V),G.placeholder=y,G}}var U=E?w:this,H=R?U[t]:t;return T&&(g=u(g,T)),O&&C<g.length&&(g.length=C),this&&this!==n&&this instanceof I&&(H=j||a(t)),H.apply(U,g)}var O=e&y,E=e&f,R=e&d,D=e&m,L=e&p,P=e&g,j=R?null:a(t);return I}var r=t("./arrayCopy"),s=t("./composeArgs"),o=t("./composeArgsRight"),a=t("./createCtorWrapper"),l=t("./isLaziable"),u=t("./reorder"),h=t("./replaceHolders"),c=t("./setData"),f=1,d=2,p=4,m=8,g=16,v=32,b=64,y=128,_=Math.max;e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./arrayCopy":8,"./composeArgs":17,"./composeArgsRight":18,"./createCtorWrapper":20,"./isLaziable":30,"./reorder":36,"./replaceHolders":37,"./setData":38}],22:[function(t,e,n){(function(n){function i(t,e,i,o){function a(){for(var e=-1,r=arguments.length,s=-1,h=o.length,c=Array(r+h);++s<h;)c[s]=o[s];for(;r--;)c[s++]=arguments[++e];var f=this&&this!==n&&this instanceof a?u:t;return f.apply(l?i:this,c)}var l=e&s,u=r(t);return a}var r=t("./createCtorWrapper"),s=1;e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./createCtorWrapper":20}],23:[function(t,e,n){function i(t,e,n,i,v,b,y,_){var w=e&f;if(!w&&"function"!=typeof t)throw new TypeError(m);var x=i?i.length:0;if(x||(e&=~(d|p),i=v=null),x-=v?v.length:0,e&p){var A=i,k=v;i=v=null}var S=w?null:l(t),T=[t,e,n,i,v,A,k,b,y,_];if(S&&(u(T,S),e=T[1],_=T[9]),T[9]=null==_?w?0:t.length:g(_-x,0)||0,e==c)var C=s(T[0],T[2]);else C=e!=d&&e!=(c|d)||T[4].length?o.apply(void 0,T):a.apply(void 0,T);var M=S?r:h;return M(C,T)}var r=t("./baseSetData"),s=t("./createBindWrapper"),o=t("./createHybridWrapper"),a=t("./createPartialWrapper"),l=t("./getData"),u=t("./mergeData"),h=t("./setData"),c=1,f=2,d=32,p=64,m="Expected a function",g=Math.max;e.exports=i},{"./baseSetData":15,"./createBindWrapper":19,"./createHybridWrapper":21,"./createPartialWrapper":22,"./getData":24,"./mergeData":33,"./setData":38}],24:[function(t,e,n){var i=t("./metaMap"),r=t("../utility/noop"),s=i?function(t){return i.get(t)}:r;e.exports=s},{"../utility/noop":49,"./metaMap":34}],25:[function(t,e,n){function i(t){for(var e=t.name,n=r[e],i=n?n.length:0;i--;){var s=n[i],o=s.func;if(null==o||o==t)return s.name}return e}var r=t("./realNames");e.exports=i},{"./realNames":35}],26:[function(t,e,n){var i=t("./baseProperty"),r=i("length");e.exports=r},{"./baseProperty":14}],27:[function(t,e,n){function i(t,e){var n=null==t?void 0:t[e];return r(n)?n:void 0}var r=t("../lang/isNative");e.exports=i},{"../lang/isNative":43}],28:[function(t,e,n){function i(t){return null!=t&&s(r(t))}var r=t("./getLength"),s=t("./isLength");e.exports=i},{"./getLength":26,"./isLength":31}],29:[function(t,e,n){function i(t,e){return t="number"==typeof t||r.test(t)?+t:-1,e=null==e?s:e,t>-1&&t%1==0&&e>t}var r=/^\d+$/,s=9007199254740991;e.exports=i},{}],30:[function(t,e,n){function i(t){var e=o(t);if(!(e in r.prototype))return!1;var n=a[e];if(t===n)return!0;var i=s(n);return!!i&&t===i[0]}var r=t("./LazyWrapper"),s=t("./getData"),o=t("./getFuncName"),a=t("../chain/lodash");e.exports=i},{"../chain/lodash":2,"./LazyWrapper":6,"./getData":24,"./getFuncName":25}],31:[function(t,e,n){function i(t){return"number"==typeof t&&t>-1&&t%1==0&&r>=t}var r=9007199254740991;e.exports=i},{}],32:[function(t,e,n){function i(t){return!!t&&"object"==typeof t}e.exports=i},{}],33:[function(t,e,n){function i(t,e){var n=t[1],i=e[1],m=n|i,g=c>m,v=i==c&&n==h||i==c&&n==f&&t[7].length<=e[8]||i==(c|f)&&n==h;if(!g&&!v)return t;i&l&&(t[2]=e[2],m|=n&l?0:u);var b=e[3];if(b){var y=t[3];t[3]=y?s(y,b,e[4]):r(b),t[4]=y?a(t[3],d):r(e[4])}return b=e[5],b&&(y=t[5],t[5]=y?o(y,b,e[6]):r(b),t[6]=y?a(t[5],d):r(e[6])),b=e[7],b&&(t[7]=r(b)),i&c&&(t[8]=null==t[8]?e[8]:p(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=m,t}var r=t("./arrayCopy"),s=t("./composeArgs"),o=t("./composeArgsRight"),a=t("./replaceHolders"),l=1,u=4,h=8,c=128,f=256,d="__lodash_placeholder__",p=Math.min;e.exports=i},{"./arrayCopy":8,"./composeArgs":17,"./composeArgsRight":18,"./replaceHolders":37}],34:[function(t,e,n){(function(n){var i=t("./getNative"),r=i(n,"WeakMap"),s=r&&new r;e.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./getNative":27}],35:[function(t,e,n){var i={};e.exports=i},{}],36:[function(t,e,n){function i(t,e){for(var n=t.length,i=o(e.length,n),a=r(t);i--;){var l=e[i];t[i]=s(l,n)?a[l]:void 0}return t}var r=t("./arrayCopy"),s=t("./isIndex"),o=Math.min;e.exports=i},{"./arrayCopy":8,"./isIndex":29}],37:[function(t,e,n){function i(t,e){for(var n=-1,i=t.length,s=-1,o=[];++n<i;)t[n]===e&&(t[n]=r,o[++s]=n);return o}var r="__lodash_placeholder__";e.exports=i},{}],38:[function(t,e,n){var i=t("./baseSetData"),r=t("../date/now"),s=150,o=16,a=function(){var t=0,e=0;return function(n,a){var l=r(),u=o-(l-e);if(e=l,u>0){if(++t>=s)return n}else t=0;return i(n,a)}}();e.exports=a},{"../date/now":3,"./baseSetData":15}],39:[function(t,e,n){function i(t){return t instanceof r?t.clone():new s(t.__wrapped__,t.__chain__,o(t.__actions__))}var r=t("./LazyWrapper"),s=t("./LodashWrapper"),o=t("./arrayCopy");e.exports=i},{"./LazyWrapper":6,"./LodashWrapper":7,"./arrayCopy":8}],40:[function(t,e,n){function i(t){return s(t)&&r(t)&&l.call(t)==o}var r=t("../internal/isArrayLike"),s=t("../internal/isObjectLike"),o="[object Arguments]",a=Object.prototype,l=a.toString;e.exports=i},{"../internal/isArrayLike":28,"../internal/isObjectLike":32}],41:[function(t,e,n){var i=t("../internal/getNative"),r=t("../internal/isLength"),s=t("../internal/isObjectLike"),o="[object Array]",a=Object.prototype,l=a.toString,u=i(Array,"isArray"),h=u||function(t){return s(t)&&r(t.length)&&l.call(t)==o};e.exports=h},{"../internal/getNative":27,"../internal/isLength":31,"../internal/isObjectLike":32}],42:[function(t,e,n){(function(n){var i=t("../internal/baseIsFunction"),r=t("../internal/getNative"),s="[object Function]",o=Object.prototype,a=o.toString,l=r(n,"Uint8Array"),u=i(/x/)||l&&!i(l)?function(t){return a.call(t)==s}:i;e.exports=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../internal/baseIsFunction":12,"../internal/getNative":27}],43:[function(t,e,n){function i(t){return null==t?!1:c.call(t)==o?f.test(u.call(t)):s(t)&&a.test(t)}var r=t("../string/escapeRegExp"),s=t("../internal/isObjectLike"),o="[object Function]",a=/^\[object .+?Constructor\]$/,l=Object.prototype,u=Function.prototype.toString,h=l.hasOwnProperty,c=l.toString,f=RegExp("^"+r(u.call(h)).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=i},{"../internal/isObjectLike":32,"../string/escapeRegExp":47}],44:[function(t,e,n){function i(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}e.exports=i},{}],45:[function(t,e,n){function i(t){return r(t,s(t))}var r=t("../internal/baseFunctions"),s=t("./keysIn");e.exports=i},{"../internal/baseFunctions":11,"./keysIn":46}],46:[function(t,e,n){function i(t){if(null==t)return[];l(t)||(t=Object(t));var e=t.length;e=e&&a(e)&&(s(t)||r(t))&&e||0;for(var n=t.constructor,i=-1,u="function"==typeof n&&n.prototype===t,c=Array(e),f=e>0;++i<e;)c[i]=i+"";for(var d in t)f&&o(d,e)||"constructor"==d&&(u||!h.call(t,d))||c.push(d);return c}var r=t("../lang/isArguments"),s=t("../lang/isArray"),o=t("../internal/isIndex"),a=t("../internal/isLength"),l=t("../lang/isObject"),u=Object.prototype,h=u.hasOwnProperty;e.exports=i},{"../internal/isIndex":29,"../internal/isLength":31,"../lang/isArguments":40,"../lang/isArray":41,"../lang/isObject":44}],47:[function(t,e,n){function i(t){return t=r(t),t&&o.test(t)?t.replace(s,"\\$&"):t}var r=t("../internal/baseToString"),s=/[.*+?^${}()|[\]\/\\]/g,o=RegExp(s.source);e.exports=i},{"../internal/baseToString":16}],48:[function(t,e,n){function i(t){return t}e.exports=i},{}],49:[function(t,e,n){function i(){}e.exports=i},{}],50:[function(t,e,n){var i=(t("lodash/function/bindAll"),t("./vendor/augment")),r=(t("./vendor/gl-matrix"),t("./math/rectangle"),t("./math/point")),s=i.defclass({constructor:function(t){this.maxZoom=t.maxZoom||5,this.minZoom=t.minZoom||.1,this.worldBounds=t.worldBounds},clampZoom:function(t){return t>this.maxZoom?this.maxZoom:t<this.minZoom?this.minZoom:t},limitToWorld:function(t){var e=(new r,t.getViewport()),n=this.worldBounds;if(e.y+e.height>n.y+n.height){var i=t.y+(n.y+n.height-(e.y+e.height));t.y=i}if(e.x<n.x){var i=t.x+(n.x-e.x);t.x=i}if(e.x+e.width>n.x+n.width){var i=t.x+(n.x+n.width-(e.x+e.width));t.x=i}if(e.y<n.y){var i=t.y+(n.y-e.y);t.y=i}},update:function(t){t.zoom=this.clampZoom(t.zoom),this.limitToWorld(t)}});e.exports=s},{"./math/point":53,"./math/rectangle":54,"./vendor/augment":59,"./vendor/gl-matrix":60,"lodash/function/bindAll":4}],51:[function(t,e,n){var i=t("lodash/function/bindAll"),r=t("./vendor/augment"),s=t("./vendor/gl-matrix"),o=(t("./math/rectangle"),t("./math/point"),s.vec2),a={NONE:-1,PAN:2},l=r.defclass({constructor:function(t){i(this),this.camera=t,this.state=a.NONE,this.panStart=o.fromValues(0,0),this.panEnd=o.fromValues(0,0),this.panDelta=o.fromValues(0,0),this.panCamera=o.fromValues(0,0)},startAt:function(t,e){this.state=a.PAN,o.set(this.panStart,t,e)},end:function(){this.state=a.NONE},pan:function(t,e,n){this.state!=a.NONE&&(n=n||1,this.panLeft(t*n),this.panUp(e*n))},panLeft:function(t){this.panCamera[0]=t},panUp:function(t){this.panCamera[1]=t},applyPan:function(t,e,n){o.set(this.panEnd,t,e),o.subtract(this.panDelta,this.panStart,this.panEnd),this.pan(this.panDelta[0],this.panDelta[1],this.camera.zoom),o.copy(this.panStart,this.panEnd)},update:function(){var t=this.camera.zoom;this.camera.x+=this.panCamera[0]/t,this.camera.y+=this.panCamera[1]/t,o.set(this.panCamera,0,0)}});e.exports=l},{"./math/point":53,"./math/rectangle":54,"./vendor/augment":59,"./vendor/gl-matrix":60,"lodash/function/bindAll":4}],52:[function(t,e,n){var i=t("lodash/function/bindAll"),r=t("./vendor/augment"),s=t("./vendor/gl-matrix"),o=t("./math/rectangle"),a=t("./math/point"),l=s.mat2d,u=r.defclass({constructor:function(t,e){i(this),this._position=new a(0,0),this._positionLimited=new a(0,0),this._zoomPivot=new a(0,0),this._viewCenter=new a(0,0),this._zoom=1,this.view=new o(0,0,t,e),this._viewport=new o(0,0,0,0),this.transform=new PIXI.Matrix,this.limited=!1},unfollow:function(){this.followTarget=void 0},follow:function(t){this.followTarget=t},getInverseMatrix:function(){var t=this.getMatrix();return l.invert([],t)},cameraToWorldPoint:function(t){return this.worldToScreen(t)},worldToCameraPoint:function(t){return this.screenToWorld(t)},transformPoint:function(t,e){var n=[t.x,t.y];return n=s.vec2.transformMat2d([],n,e),{x:n[0],y:n[1]}},worldToScreen:function(t){return this.transformPoint(t,this.getMatrix())},screenToWorld:function(t){return this.transformPoint(t,this.getInverseMatrix())},tranformRect:function(t,e){var n=this.transformPoint(t.tl,e),i=this.transformPoint({x:t.width,y:t.height},e);return new o(n.x,n.y,i.x-n.x,i.y-n.y)},worldRectToScreen:function(t){return this.tranformRect(t,this.getInverseMatrix())},getViewSize:function(){return this.view},setScreenSize:function(t,e){this.view.width=t,this.view.height=e},getViewport:function(){var t=this.worldToScreen(a.ZERO),e=this.worldToScreen({x:this.view.width,y:this.view.height});return this._viewport.set(t.x,t.y,e.x-t.x,e.y-t.y),this._viewport},getMatrix:function(){var t=l.identity([]);l.translate(t,t,[this._zoomPivot.x,this._zoomPivot.y]);var e=[this.view.x,this.view.y];return l.translate(t,t,[-this._viewCenter.x,-this._viewCenter.y]),l.translate(t,t,e),l.scale(t,t,[1/this.zoom,1/this.zoom]),l.translate(t,t,[-this._zoomPivot.x,-this._zoomPivot.y]),t},update:function(){this.followTarget&&(this.x=this.followTarget.x,this.y=this.followTarget.y),this.updateTransform()},updateTransform:function(){var t=this.getInverseMatrix(),e=this.transform;e.a=t[0],e.b=t[1],e.c=t[2],e.d=t[3],e.tx=t[4],e.ty=t[5]}});Object.defineProperty(u.prototype,"zoom",{get:function(){return this._zoom},set:function(t){.1>t&&(t=.1),this._zoom=t}}),Object.defineProperty(u.prototype,"viewCenterX",{get:function(){return this._viewCenter.x},set:function(t){this._viewCenter.x=t}}),Object.defineProperty(u.prototype,"viewCenterY",{get:function(){return this._viewCenter.y},set:function(t){this._viewCenter.y=t}}),Object.defineProperty(u.prototype,"zoomPivotX",{get:function(){return this._zoomPivot.x},set:function(t){this._zoomPivot.x=t}}),Object.defineProperty(u.prototype,"zoomPivotY",{get:function(){return this._zoomPivot.y},set:function(t){this._zoomPivot.y=t}}),Object.defineProperty(u.prototype,"position",{get:function(){return this._position.set(this.view.x,this.view.y),this._position},set:function(t){"undefined"!=typeof t.x&&(this.view.x=t.x),"undefined"!=typeof t.y&&(this.view.y=t.y)}}),Object.defineProperty(u.prototype,"positionLimited",{get:function(){return this._positionLimited},set:function(t){"undefined"!=typeof t.x&&(this._positionLimited.x=t.x),"undefined"!=typeof t.y&&(this._positionLimited.y=t.y)}}),Object.defineProperty(u.prototype,"x",{get:function(){return this.view.x},set:function(t){this.view.x=t}}),Object.defineProperty(u.prototype,"y",{get:function(){return this.view.y},set:function(t){this.view.y=t}}),e.exports=u},{"./math/point":53,"./math/rectangle":54,"./vendor/augment":59,"./vendor/gl-matrix":60,"lodash/function/bindAll":4}],53:[function(t,e,n){var i=t("./../vendor/augment"),r=i.defclass({constructor:function(t,e){t=t||0,e=e||0,this.x=t,this.y=e},subtract:function(t){return this.x=this.x-t.x,this.y=this.y-t.y,this},add:function(t){return this.x=this.x+t.x,this.y=this.y+t.y,this},toArray:function(){return[this.x,this.y]},reset:function(){this.set(0,0)},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},divideScalar:function(t){if(0!==t){var e=1/t;this.x*=e,this.y*=e}else this.x=0,this.y=0;return this},clone:function(){return new r(this.x,this.y)},normalize:function(){return this.divideScalar(this.length())},set:function(t,e){return this.x=t,this.y=e,this}});r.ZERO=new r,r.subtract=function(t,e){var n=new r(t.x,t.y),i=new r(e.x,e.y);return n.clone().subtract(i)},r.fromAngle=function(t,e){var n=Math.cos(t)*e,i=Math.sin(t)*e;return new r(n,i)},e.exports=r},{"./../vendor/augment":59}],54:[function(t,e,n){var i=t("./../vendor/augment"),r=t("./../math/point"),s=i.defclass({constructor:function(t,e,n,i){t=t||0,e=e||0,n=n||0,i=i||0,this.x=t,this.y=e,this.width=n,this.height=i},clone:function(){return new s(this.x,this.y,this.width,this.height)},scaleWithPoint:function(t){return this.scale(t.x,t.y)},scale:function(t,e){return"undefined"==typeof e&&(e=t),this.x=this.x*t,this.y=this.y*e,this.width=this.width*t,this.height=this.height*e,this},set:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this}});Object.defineProperty(s.prototype,"left",{get:function(){return this.x}}),Object.defineProperty(s.prototype,"right",{get:function(){return this.x+this.width}}),Object.defineProperty(s.prototype,"top",{get:function(){return this.y}}),Object.defineProperty(s.prototype,"bottom",{get:function(){return this.y+this.height}}),Object.defineProperty(s.prototype,"tl",{get:function(){return new r(this.x,this.y)},set:function(t){this.x=t.x,this.y=t.y}}),Object.defineProperty(s.prototype,"tr",{get:function(){return new r(this.x+this.width,this.y)}}),Object.defineProperty(s.prototype,"bl",{get:function(){return new r(this.x,this.bottom)}}),Object.defineProperty(s.prototype,"br",{get:function(){return new r(this.right,this.bottom)}}),Object.defineProperty(s.prototype,"centerX",{get:function(){return this.x+this.halfWidth}}),Object.defineProperty(s.prototype,"centerY",{get:function(){return this.y+this.halfHeight}}),Object.defineProperty(s.prototype,"halfWidth",{get:function(){return Math.round(this.width/2)}}),Object.defineProperty(s.prototype,"halfHeight",{get:function(){return Math.round(this.height/2)}}),e.exports=s},{"./../math/point":53,"./../vendor/augment":59}],55:[function(t,e,n){var i=t("lodash/function/bindAll"),r=t("./vendor/augment"),s=t("./vendor/gl-matrix"),o=(t("./math/rectangle"),t("./math/point")),a=t("./camera-pan"),l=(s.mat2d,r.defclass({constructor:function(t){i(this),this.minimap=t,t.interactive=!0,t.on("mousedown",this.handleMouseDown),this.camera=this.minimap.camera,this.cameraPan=new a(this.minimap.camera)},handleMouseDown:function(t){var e=this.minimap;e.mouseup=e.mouseupoutside=e.touchend=e.touchendoutside=this.handleMouseUp,e.mousemove=this.handleMouseMove;var n=this.mouseToGlobal(t.data.global);this.cameraPan.startAt(-n.x,-n.y)},handleMouseUp:function(t){var e=this.minimap;e.mouseup=e.mouseupoutside=e.touchend=e.touchendoutside=void 0,e.mousemove=void 0,this.cameraPan.end()},mouseToGlobal:function(t){var e=this.minimap.toLocal(t);return e=new o(e.x,e.y),e=this.minimap.minimapToWorld(e)},handleMouseMove:function(t){var e=this.mouseToGlobal(t.data.global);this.cameraPan.applyPan(-e.x,-e.y)},update:function(){this.cameraPan.update()}}));e.exports=l},{"./camera-pan":51,"./math/point":53,"./math/rectangle":54,"./vendor/augment":59,"./vendor/gl-matrix":60,"lodash/function/bindAll":4}],56:[function(t,e,n){var i=(t("lodash/function/bindAll"),t("./vendor/augment")),r=t("./vendor/gl-matrix"),s=t("./math/rectangle"),o=t("./minimap-navigator"),a=t("./math/point"),l=r.mat2d,u=i(PIXI.Container,function(t){
this.constructor=function(e,n,i,r){t.constructor.apply(this,arguments),this.camera=i,this.minimapDimensions={width:e,height:n},this.worldBoundRect=new s(0,0,100,100),this.viewportRect=new s(0,0,100,100),this.items=[],this.build(),this.navigator=new o(this)},this.build=function(){this.worldBounds=new PIXI.Graphics,this.worldBounds.alpha=.5,this.addChild(this.worldBounds),this.viewport=new PIXI.Graphics,this.viewport.alpha=.5,this.addChild(this.viewport),this.itemsLayer=new PIXI.Graphics,this.addChild(this.itemsLayer),this.debugLayer=new PIXI.Graphics,this.addChild(this.debugLayer)},this.add=function(t){this.items.push(t)},this.drawObjects=function(){this.itemsLayer.clear();for(var t,e=0,n=this.items.length;n>e;e++){t=this.items[e];var i=t.getLocalBounds(),r=0,o=0;t.anchor&&(r=t.width*-t.anchor.x,o=t.height*-t.anchor.y),i=new s(t.x+r,t.y+o,t.width,t.height),this.drawObject(i)}},this.drawObject=function(t){var e=this.worldRectToMinimap(t);this.drawRect(this.itemsLayer,e.x,e.y,e.width,e.height,{color:65535})},this.setWorldBounds=function(t){this.worldBoundRect=t},this.update=function(){this.navigator.update(),this.viewportRect=this.camera.getViewport(),this.draw()},this.getWorldToMinimapRatio=function(){var t=this.getRatios(this.minimapDimensions,this.worldBoundRect);return{x:t.x,y:t.y}},this.getRatios=function(t,e){var n=t.width,i=t.height,r=e.width,s=e.height,o=n/r,a=i/s,l={x:o,y:a,min:Math.min(o,a),max:Math.max(o,a)};return l},this.worldRectToMinimap=function(t){var e=this.getWorldToMinimapRatio(),n=t.clone();return n.tl=n.tl.subtract(this.worldBoundRect.tl),n.scaleWithPoint(e),n},this.minimapToWorld=function(t){t instanceof a||(t=new a(t.x,t.y));var e=t.toArray(),n=l.identity([]),i=this.getWorldToMinimapRatio();return l.translate(n,n,[this.worldBoundRect.x,this.worldBoundRect.y]),l.scale(n,n,[1/i.x,1/i.y]),r.vec2.transformMat2d(e,e,n),new a(e[0],e[1])},this.worldPointToMinimap=function(t){t instanceof a||(t=new a(t.x,t.y));var e=t.toArray(),n=l.identity([]),i=this.getWorldToMinimapRatio();return l.scale(n,n,[i.x,i.y]),l.translate(n,n,[-this.worldBoundRect.x,-this.worldBoundRect.y]),r.vec2.transformMat2d(e,e,n),new a(e[0],e[1])},this.draw=function(){this.drawViewport(this.viewportRect,16776960),this.drawWorldBounds(this.worldBoundRect,0),this.drawObjects()},this.drawViewport=function(t,e){t=this.worldRectToMinimap(t),this.viewport,this.viewport.position.set(t.x,t.y),this.viewport.clear(),this.drawRect(this.viewport,0,0,t.width,t.height,{color:e})},this.drawWorldBounds=function(t,e){var n=t.clone();n.scaleWithPoint(this.getWorldToMinimapRatio()),this.worldBounds.clear(),this.drawRect(this.worldBounds,0,0,n.width,n.height,{color:e}),this.drawOrigin(this.worldBounds,-n.x,-n.y,n.width,n.height)},this.drawDot=function(t,e,n,i,r){var r=r||{};r.center=!0,r.color=65280,this.drawRect(t,e,n,i,i,r)},this.drawRect=function(t,e,n,i,r,s){var s=s||{},o=s.hasOwnProperty("color")?s.color:16777215,a=s.center===!0;t.beginFill(o),a?t.drawRect(e-i/2,n-r/2,i,r):t.drawRect(e,n,i,r),t.endFill()},this.drawOrigin=function(t,e,n,i,r){var s=e,o=n;t.lineStyle(1,16777215,1),t.drawPolygon(e-s,n,e+i-s,n),t.drawPolygon(e,n-o,e,n+r-o)}});Object.defineProperties(u.prototype,{width:{get:function(){return this.minimapDimensions.width}},height:{get:function(){return this.minimapDimensions.height}}}),e.exports=u},{"./math/point":53,"./math/rectangle":54,"./minimap-navigator":55,"./vendor/augment":59,"./vendor/gl-matrix":60,"lodash/function/bindAll":4}],57:[function(t,e,n){var i=t("./pixi");e.exports={addContainerUpdates:function(){i()}}},{"./pixi":58}],58:[function(t,e,n){var i=function(){PIXI.Container.prototype.update=function(){for(var t=0,e=this.children.length;e>t;++t)this.children[t].update()},PIXI.Container.prototype.preUpdate=function(){for(var t=0,e=this.children.length;e>t;++t)this.children[t].preUpdate()},PIXI.Container.prototype.postUpdate=function(){this.body&&this.body.postUpdate();for(var t=0,e=this.children.length;e>t;++t)this.children[t].postUpdate()}};e.exports=i},{}],59:[function(e,n,i){!function(e,i){"function"==typeof t&&t.amd?t(i):"object"==typeof n?n.exports=i():e.augment=i()}(this,function(){"use strict";var t=function(){},e=Array.prototype.slice,n=function(n,i){var r=t.prototype="function"==typeof n?n.prototype:n,s=new t,o=i.apply(s,e.call(arguments,2).concat(r));if("object"==typeof o)for(var a in o)s[a]=o[a];if(!s.hasOwnProperty("constructor"))return s;var l=s.constructor;return l.prototype=s,l};return n.defclass=function(t){var e=t.constructor;return e.prototype=t,e},n.extend=function(t,e){return n(t,function(t){return this.uber=t,e})},n})},{}],60:[function(e,n,i){!function(e){"use strict";var n={};"undefined"==typeof i?"function"==typeof t&&"object"==typeof t.amd&&t.amd?(n.exports={},t(function(){return n.exports})):n.exports="undefined"!=typeof window?window:e:n.exports=i,function(t){if(!e)var e=1e-6;if(!n)var n="undefined"!=typeof Float32Array?Float32Array:Array;if(!i)var i=Math.random;var r={};r.setMatrixArrayType=function(t){n=t},"undefined"!=typeof t&&(t.glMatrix=r);var s=Math.PI/180;r.toRadian=function(t){return t*s};var o={};o.create=function(){var t=new n(2);return t[0]=0,t[1]=0,t},o.clone=function(t){var e=new n(2);return e[0]=t[0],e[1]=t[1],e},o.fromValues=function(t,e){var i=new n(2);return i[0]=t,i[1]=e,i},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},o.set=function(t,e,n){return t[0]=e,t[1]=n,t},o.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},o.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},o.sub=o.subtract,o.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},o.mul=o.multiply,o.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},o.div=o.divide,o.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},o.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},o.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},o.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t},o.distance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(n*n+i*i)},o.dist=o.distance,o.squaredDistance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},o.len=o.length,o.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},o.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},o.normalize=function(t,e){var n=e[0],i=e[1],r=n*n+i*i;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},o.cross=function(t,e,n){var i=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=i,t},o.lerp=function(t,e,n,i){var r=e[0],s=e[1];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t},o.random=function(t,e){e=e||1;var n=2*i()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},o.transformMat2=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t},o.transformMat2d=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t},o.transformMat3=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t},o.transformMat4=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t},o.forEach=function(){var t=o.create();return function(e,n,i,r,s,o){var a,l;for(n||(n=2),i||(i=0),l=r?Math.min(r*n+i,e.length):e.length,a=i;l>a;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}}(),o.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},"undefined"!=typeof t&&(t.vec2=o);var a={};a.create=function(){var t=new n(3);return t[0]=0,t[1]=0,t[2]=0,t},a.clone=function(t){var e=new n(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},a.fromValues=function(t,e,i){var r=new n(3);return r[0]=t,r[1]=e,r[2]=i,r},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.set=function(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},a.sub=a.subtract,a.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},a.mul=a.multiply,a.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},a.div=a.divide,a.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},a.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},a.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},a.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t},a.distance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(n*n+i*i+r*r)},a.dist=a.distance,a.squaredDistance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],n=t[1],i=t[2];return Math.sqrt(e*e+n*n+i*i)},a.len=a.length,a.squaredLength=function(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},a.normalize=function(t,e){var n=e[0],i=e[1],r=e[2],s=n*n+i*i+r*r;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},a.cross=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=r*l-s*a,t[1]=s*o-i*l,t[2]=i*a-r*o,t},a.lerp=function(t,e,n,i){var r=e[0],s=e[1],o=e[2];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=o+i*(n[2]-o),t},a.random=function(t,e){e=e||1;var n=2*i()*Math.PI,r=2*i()-1,s=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*s,t[1]=Math.sin(n)*s,t[2]=r*e,t},a.transformMat4=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[3]*i+n[7]*r+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*i+n[4]*r+n[8]*s+n[12])/o,t[1]=(n[1]*i+n[5]*r+n[9]*s+n[13])/o,t[2]=(n[2]*i+n[6]*r+n[10]*s+n[14])/o,t},a.transformMat3=function(t,e,n){var i=e[0],r=e[1],s=e[2];return t[0]=i*n[0]+r*n[3]+s*n[6],t[1]=i*n[1]+r*n[4]+s*n[7],t[2]=i*n[2]+r*n[5]+s*n[8],t},a.transformQuat=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],l=n[2],u=n[3],h=u*i+a*s-l*r,c=u*r+l*i-o*s,f=u*s+o*r-a*i,d=-o*i-a*r-l*s;return t[0]=h*u+d*-o+c*-l-f*-a,t[1]=c*u+d*-a+f*-o-h*-l,t[2]=f*u+d*-l+h*-a-c*-o,t},a.rotateX=function(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t},a.rotateY=function(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t},a.rotateZ=function(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t},a.forEach=function(){var t=a.create();return function(e,n,i,r,s,o){var a,l;for(n||(n=3),i||(i=0),l=r?Math.min(r*n+i,e.length):e.length,a=i;l>a;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}}(),a.angle=function(t,e){var n=a.fromValues(t[0],t[1],t[2]),i=a.fromValues(e[0],e[1],e[2]);a.normalize(n,n),a.normalize(i,i);var r=a.dot(n,i);return r>1?0:Math.acos(r)},a.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},"undefined"!=typeof t&&(t.vec3=a);var l={};l.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},l.clone=function(t){var e=new n(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},l.fromValues=function(t,e,i,r){var s=new n(4);return s[0]=t,s[1]=e,s[2]=i,s[3]=r,s},l.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},l.set=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},l.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},l.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},l.sub=l.subtract,l.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},l.mul=l.multiply,l.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},l.div=l.divide,l.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},l.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},l.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},l.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t},l.distance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return Math.sqrt(n*n+i*i+r*r+s*s)},l.dist=l.distance,l.squaredDistance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return n*n+i*i+r*r+s*s},l.sqrDist=l.squaredDistance,l.length=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.sqrt(e*e+n*n+i*i+r*r)},l.len=l.length,l.squaredLength=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r},l.sqrLen=l.squaredLength,l.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},l.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},l.normalize=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t[3]=e[3]*o),t},l.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},l.lerp=function(t,e,n,i){var r=e[0],s=e[1],o=e[2],a=e[3];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=o+i*(n[2]-o),t[3]=a+i*(n[3]-a),t},l.random=function(t,e){return e=e||1,t[0]=i(),t[1]=i(),t[2]=i(),t[3]=i(),l.normalize(t,t),l.scale(t,t,e),t},l.transformMat4=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*s+n[12]*o,t[1]=n[1]*i+n[5]*r+n[9]*s+n[13]*o,t[2]=n[2]*i+n[6]*r+n[10]*s+n[14]*o,t[3]=n[3]*i+n[7]*r+n[11]*s+n[15]*o,t},l.transformQuat=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],l=n[2],u=n[3],h=u*i+a*s-l*r,c=u*r+l*i-o*s,f=u*s+o*r-a*i,d=-o*i-a*r-l*s;return t[0]=h*u+d*-o+c*-l-f*-a,t[1]=c*u+d*-a+f*-o-h*-l,t[2]=f*u+d*-l+h*-a-c*-o,t},l.forEach=function(){var t=l.create();return function(e,n,i,r,s,o){var a,l;for(n||(n=4),i||(i=0),l=r?Math.min(r*n+i,e.length):e.length,a=i;l>a;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}(),l.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.vec4=l);var u={};u.create=function(){var t=new n(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},u.clone=function(t){var e=new n(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},u.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},u.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},u.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},u.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*s-r*i;return o?(o=1/o,t[0]=s*o,t[1]=-i*o,t[2]=-r*o,t[3]=n*o,t):null},u.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},u.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},u.multiply=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=n[0],l=n[1],u=n[2],h=n[3];return t[0]=i*a+s*l,t[1]=r*a+o*l,t[2]=i*u+s*h,t[3]=r*u+o*h,t},u.mul=u.multiply,u.rotate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+s*a,t[1]=r*l+o*a,t[2]=i*-a+s*l,t[3]=r*-a+o*l,t},u.scale=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=n[0],l=n[1];return t[0]=i*a,t[1]=r*a,t[2]=s*l,t[3]=o*l,t},u.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},u.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},u.LDU=function(t,e,n,i){return t[2]=i[2]/i[0],n[0]=i[0],n[1]=i[1],n[3]=i[3]-t[2]*n[1],[t,e,n]},"undefined"!=typeof t&&(t.mat2=u);var h={};h.create=function(){var t=new n(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},h.clone=function(t){var e=new n(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},h.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},h.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},h.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=n*s-i*r;return l?(l=1/l,t[0]=s*l,t[1]=-i*l,t[2]=-r*l,t[3]=n*l,t[4]=(r*a-s*o)*l,t[5]=(i*o-n*a)*l,t):null},h.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},h.multiply=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=n[0],h=n[1],c=n[2],f=n[3],d=n[4],p=n[5];return t[0]=i*u+s*h,t[1]=r*u+o*h,t[2]=i*c+s*f,t[3]=r*c+o*f,t[4]=i*d+s*p+a,t[5]=r*d+o*p+l,t},h.mul=h.multiply,h.rotate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=Math.sin(n),h=Math.cos(n);return t[0]=i*h+s*u,t[1]=r*h+o*u,t[2]=i*-u+s*h,t[3]=r*-u+o*h,t[4]=a,t[5]=l,t},h.scale=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=n[0],h=n[1];return t[0]=i*u,t[1]=r*u,t[2]=s*h,t[3]=o*h,t[4]=a,t[5]=l,t},h.translate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=n[0],h=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=o,t[4]=i*u+s*h+a,t[5]=r*u+o*h+l,t},h.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},h.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},"undefined"!=typeof t&&(t.mat2d=h);var c={};c.create=function(){var t=new n(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},c.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},c.clone=function(t){var e=new n(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},c.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},c.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},c.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},c.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],c=h*o-a*u,f=-h*s+a*l,d=u*s-o*l,p=n*c+i*f+r*d;return p?(p=1/p,t[0]=c*p,t[1]=(-h*i+r*u)*p,t[2]=(a*i-r*o)*p,t[3]=f*p,t[4]=(h*n-r*l)*p,t[5]=(-a*n+r*s)*p,t[6]=d*p,t[7]=(-u*n+i*l)*p,t[8]=(o*n-i*s)*p,t):null},c.adjoint=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8];return t[0]=o*h-a*u,t[1]=r*u-i*h,t[2]=i*a-r*o,t[3]=a*l-s*h,t[4]=n*h-r*l,t[5]=r*s-n*a,t[6]=s*u-o*l,t[7]=i*l-n*u,t[8]=n*o-i*s,t},c.determinant=function(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],u=t[8];return e*(u*s-o*l)+n*(-u*r+o*a)+i*(l*r-s*a)},c.multiply=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],c=e[8],f=n[0],d=n[1],p=n[2],m=n[3],g=n[4],v=n[5],b=n[6],y=n[7],_=n[8];return t[0]=f*i+d*o+p*u,t[1]=f*r+d*a+p*h,t[2]=f*s+d*l+p*c,t[3]=m*i+g*o+v*u,t[4]=m*r+g*a+v*h,t[5]=m*s+g*l+v*c,t[6]=b*i+y*o+_*u,t[7]=b*r+y*a+_*h,t[8]=b*s+y*l+_*c,t},c.mul=c.multiply,c.translate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],c=e[8],f=n[0],d=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=o,t[4]=a,t[5]=l,t[6]=f*i+d*o+u,t[7]=f*r+d*a+h,t[8]=f*s+d*l+c,t},c.rotate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],c=e[8],f=Math.sin(n),d=Math.cos(n);return t[0]=d*i+f*o,t[1]=d*r+f*a,t[2]=d*s+f*l,t[3]=d*o-f*i,t[4]=d*a-f*r,t[5]=d*l-f*s,t[6]=u,t[7]=h,t[8]=c,t},c.scale=function(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},c.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},c.fromQuat=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n+n,a=i+i,l=r+r,u=n*o,h=i*o,c=i*a,f=r*o,d=r*a,p=r*l,m=s*o,g=s*a,v=s*l;return t[0]=1-c-p,t[3]=h-v,t[6]=f+g,t[1]=h+v,t[4]=1-u-p,t[7]=d-m,t[2]=f-g,t[5]=d+m,t[8]=1-u-c,t},c.normalFromMat4=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],c=e[9],f=e[10],d=e[11],p=e[12],m=e[13],g=e[14],v=e[15],b=n*a-i*o,y=n*l-r*o,_=n*u-s*o,w=i*l-r*a,x=i*u-s*a,A=r*u-s*l,k=h*m-c*p,S=h*g-f*p,T=h*v-d*p,C=c*g-f*m,M=c*v-d*m,I=f*v-d*g,O=b*I-y*M+_*C+w*T-x*S+A*k;return O?(O=1/O,t[0]=(a*I-l*M+u*C)*O,t[1]=(l*T-o*I-u*S)*O,t[2]=(o*M-a*T+u*k)*O,t[3]=(r*M-i*I-s*C)*O,t[4]=(n*I-r*T+s*S)*O,t[5]=(i*T-n*M-s*k)*O,t[6]=(m*A-g*x+v*w)*O,t[7]=(g*_-p*A-v*y)*O,t[8]=(p*x-m*_+v*b)*O,t):null},c.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},c.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},"undefined"!=typeof t&&(t.mat3=c);var f={};f.create=function(){var t=new n(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.clone=function(t){var e=new n(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},f.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},f.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=s,t[11]=e[14],t[12]=r,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},f.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],c=e[9],f=e[10],d=e[11],p=e[12],m=e[13],g=e[14],v=e[15],b=n*a-i*o,y=n*l-r*o,_=n*u-s*o,w=i*l-r*a,x=i*u-s*a,A=r*u-s*l,k=h*m-c*p,S=h*g-f*p,T=h*v-d*p,C=c*g-f*m,M=c*v-d*m,I=f*v-d*g,O=b*I-y*M+_*C+w*T-x*S+A*k;return O?(O=1/O,t[0]=(a*I-l*M+u*C)*O,t[1]=(r*M-i*I-s*C)*O,t[2]=(m*A-g*x+v*w)*O,t[3]=(f*x-c*A-d*w)*O,t[4]=(l*T-o*I-u*S)*O,t[5]=(n*I-r*T+s*S)*O,t[6]=(g*_-p*A-v*y)*O,t[7]=(h*A-f*_+d*y)*O,t[8]=(o*M-a*T+u*k)*O,t[9]=(i*T-n*M-s*k)*O,t[10]=(p*x-m*_+v*b)*O,t[11]=(c*_-h*x-d*b)*O,t[12]=(a*S-o*C-l*k)*O,t[13]=(n*C-i*S+r*k)*O,t[14]=(m*y-p*w-g*b)*O,t[15]=(h*w-c*y+f*b)*O,t):null},f.adjoint=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],c=e[9],f=e[10],d=e[11],p=e[12],m=e[13],g=e[14],v=e[15];return t[0]=a*(f*v-d*g)-c*(l*v-u*g)+m*(l*d-u*f),t[1]=-(i*(f*v-d*g)-c*(r*v-s*g)+m*(r*d-s*f)),t[2]=i*(l*v-u*g)-a*(r*v-s*g)+m*(r*u-s*l),t[3]=-(i*(l*d-u*f)-a*(r*d-s*f)+c*(r*u-s*l)),t[4]=-(o*(f*v-d*g)-h*(l*v-u*g)+p*(l*d-u*f)),t[5]=n*(f*v-d*g)-h*(r*v-s*g)+p*(r*d-s*f),t[6]=-(n*(l*v-u*g)-o*(r*v-s*g)+p*(r*u-s*l)),t[7]=n*(l*d-u*f)-o*(r*d-s*f)+h*(r*u-s*l),t[8]=o*(c*v-d*m)-h*(a*v-u*m)+p*(a*d-u*c),t[9]=-(n*(c*v-d*m)-h*(i*v-s*m)+p*(i*d-s*c)),t[10]=n*(a*v-u*m)-o*(i*v-s*m)+p*(i*u-s*a),t[11]=-(n*(a*d-u*c)-o*(i*d-s*c)+h*(i*u-s*a)),t[12]=-(o*(c*g-f*m)-h*(a*g-l*m)+p*(a*f-l*c)),t[13]=n*(c*g-f*m)-h*(i*g-r*m)+p*(i*f-r*c),t[14]=-(n*(a*g-l*m)-o*(i*g-r*m)+p*(i*l-r*a)),t[15]=n*(a*f-l*c)-o*(i*f-r*c)+h*(i*l-r*a),t},f.determinant=function(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],u=t[8],h=t[9],c=t[10],f=t[11],d=t[12],p=t[13],m=t[14],g=t[15],v=e*o-n*s,b=e*a-i*s,y=e*l-r*s,_=n*a-i*o,w=n*l-r*o,x=i*l-r*a,A=u*p-h*d,k=u*m-c*d,S=u*g-f*d,T=h*m-c*p,C=h*g-f*p,M=c*g-f*m;return v*M-b*C+y*T+_*S-w*k+x*A},f.multiply=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],c=e[8],f=e[9],d=e[10],p=e[11],m=e[12],g=e[13],v=e[14],b=e[15],y=n[0],_=n[1],w=n[2],x=n[3];return t[0]=y*i+_*a+w*c+x*m,t[1]=y*r+_*l+w*f+x*g,t[2]=y*s+_*u+w*d+x*v,t[3]=y*o+_*h+w*p+x*b,y=n[4],_=n[5],w=n[6],x=n[7],t[4]=y*i+_*a+w*c+x*m,t[5]=y*r+_*l+w*f+x*g,t[6]=y*s+_*u+w*d+x*v,t[7]=y*o+_*h+w*p+x*b,y=n[8],_=n[9],w=n[10],x=n[11],t[8]=y*i+_*a+w*c+x*m,t[9]=y*r+_*l+w*f+x*g,t[10]=y*s+_*u+w*d+x*v,t[11]=y*o+_*h+w*p+x*b,y=n[12],_=n[13],w=n[14],x=n[15],t[12]=y*i+_*a+w*c+x*m,t[13]=y*r+_*l+w*f+x*g,t[14]=y*s+_*u+w*d+x*v,t[15]=y*o+_*h+w*p+x*b,t},f.mul=f.multiply,f.translate=function(t,e,n){var i,r,s,o,a,l,u,h,c,f,d,p,m=n[0],g=n[1],v=n[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*v+e[12],t[13]=e[1]*m+e[5]*g+e[9]*v+e[13],t[14]=e[2]*m+e[6]*g+e[10]*v+e[14],t[15]=e[3]*m+e[7]*g+e[11]*v+e[15]):(i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],c=e[8],f=e[9],d=e[10],p=e[11],t[0]=i,t[1]=r,t[2]=s,t[3]=o,t[4]=a,t[5]=l,t[6]=u,t[7]=h,t[8]=c,t[9]=f,t[10]=d,t[11]=p,t[12]=i*m+a*g+c*v+e[12],t[13]=r*m+l*g+f*v+e[13],t[14]=s*m+u*g+d*v+e[14],t[15]=o*m+h*g+p*v+e[15]),t},f.scale=function(t,e,n){var i=n[0],r=n[1],s=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},f.rotate=function(t,n,i,r){var s,o,a,l,u,h,c,f,d,p,m,g,v,b,y,_,w,x,A,k,S,T,C,M,I=r[0],O=r[1],E=r[2],R=Math.sqrt(I*I+O*O+E*E);return Math.abs(R)<e?null:(R=1/R,I*=R,O*=R,E*=R,s=Math.sin(i),o=Math.cos(i),a=1-o,l=n[0],u=n[1],h=n[2],c=n[3],f=n[4],d=n[5],p=n[6],m=n[7],g=n[8],v=n[9],b=n[10],y=n[11],_=I*I*a+o,w=O*I*a+E*s,x=E*I*a-O*s,A=I*O*a-E*s,k=O*O*a+o,S=E*O*a+I*s,T=I*E*a+O*s,C=O*E*a-I*s,M=E*E*a+o,t[0]=l*_+f*w+g*x,t[1]=u*_+d*w+v*x,t[2]=h*_+p*w+b*x,t[3]=c*_+m*w+y*x,t[4]=l*A+f*k+g*S,t[5]=u*A+d*k+v*S,t[6]=h*A+p*k+b*S,t[7]=c*A+m*k+y*S,t[8]=l*T+f*C+g*M,t[9]=u*T+d*C+v*M,t[10]=h*T+p*C+b*M,t[11]=c*T+m*C+y*M,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)},f.rotateX=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],u=e[8],h=e[9],c=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*r+u*i,t[5]=o*r+h*i,t[6]=a*r+c*i,t[7]=l*r+f*i,t[8]=u*r-s*i,t[9]=h*r-o*i,t[10]=c*r-a*i,t[11]=f*r-l*i,t},f.rotateY=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],u=e[8],h=e[9],c=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r-u*i,t[1]=o*r-h*i,t[2]=a*r-c*i,t[3]=l*r-f*i,t[8]=s*i+u*r,t[9]=o*i+h*r,t[10]=a*i+c*r,t[11]=l*i+f*r,t},f.rotateZ=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],u=e[4],h=e[5],c=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r+u*i,t[1]=o*r+h*i,t[2]=a*r+c*i,t[3]=l*r+f*i,t[4]=u*r-s*i,t[5]=h*r-o*i,t[6]=c*r-a*i,t[7]=f*r-l*i,t},f.fromRotationTranslation=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=i+i,l=r+r,u=s+s,h=i*a,c=i*l,f=i*u,d=r*l,p=r*u,m=s*u,g=o*a,v=o*l,b=o*u;return t[0]=1-(d+m),t[1]=c+b,t[2]=f-v,t[3]=0,t[4]=c-b,t[5]=1-(h+m),t[6]=p+g,t[7]=0,t[8]=f+v,t[9]=p-g,t[10]=1-(h+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},f.fromQuat=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n+n,a=i+i,l=r+r,u=n*o,h=i*o,c=i*a,f=r*o,d=r*a,p=r*l,m=s*o,g=s*a,v=s*l;return t[0]=1-c-p,t[1]=h+v,t[2]=f-g,t[3]=0,t[4]=h-v,t[5]=1-u-p,t[6]=d+m,t[7]=0,t[8]=f+g,t[9]=d-m,t[10]=1-u-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.frustum=function(t,e,n,i,r,s,o){var a=1/(n-e),l=1/(r-i),u=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*l,t[10]=(o+s)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*u,t[15]=0,t},f.perspective=function(t,e,n,i,r){var s=1/Math.tan(e/2),o=1/(i-r);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+i)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*i*o,t[15]=0,t},f.ortho=function(t,e,n,i,r,s,o){var a=1/(e-n),l=1/(i-r),u=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*l,t[14]=(o+s)*u,t[15]=1,t},f.lookAt=function(t,n,i,r){var s,o,a,l,u,h,c,d,p,m,g=n[0],v=n[1],b=n[2],y=r[0],_=r[1],w=r[2],x=i[0],A=i[1],k=i[2];return Math.abs(g-x)<e&&Math.abs(v-A)<e&&Math.abs(b-k)<e?f.identity(t):(c=g-x,d=v-A,p=b-k,m=1/Math.sqrt(c*c+d*d+p*p),c*=m,d*=m,p*=m,s=_*p-w*d,o=w*c-y*p,a=y*d-_*c,m=Math.sqrt(s*s+o*o+a*a),m?(m=1/m,s*=m,o*=m,a*=m):(s=0,o=0,a=0),l=d*a-p*o,u=p*s-c*a,h=c*o-d*s,m=Math.sqrt(l*l+u*u+h*h),m?(m=1/m,l*=m,u*=m,h*=m):(l=0,u=0,h=0),t[0]=s,t[1]=l,t[2]=c,t[3]=0,t[4]=o,t[5]=u,t[6]=d,t[7]=0,t[8]=a,t[9]=h,t[10]=p,t[11]=0,t[12]=-(s*g+o*v+a*b),t[13]=-(l*g+u*v+h*b),t[14]=-(c*g+d*v+p*b),t[15]=1,t)},f.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},f.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},"undefined"!=typeof t&&(t.mat4=f);var d={};d.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},d.rotationTo=function(){var t=a.create(),e=a.fromValues(1,0,0),n=a.fromValues(0,1,0);return function(i,r,s){var o=a.dot(r,s);return-.999999>o?(a.cross(t,e,r),a.length(t)<1e-6&&a.cross(t,n,r),a.normalize(t,t),d.setAxisAngle(i,t,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(a.cross(t,r,s),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+o,d.normalize(i,i))}}(),d.setAxes=function(){var t=c.create();return function(e,n,i,r){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],d.normalize(e,d.fromMat3(e,t))}}(),d.clone=l.clone,d.fromValues=l.fromValues,d.copy=l.copy,d.set=l.set,d.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},d.setAxisAngle=function(t,e,n){n=.5*n;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t},d.add=l.add,d.multiply=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=n[0],l=n[1],u=n[2],h=n[3];return t[0]=i*h+o*a+r*u-s*l,t[1]=r*h+o*l+s*a-i*u,t[2]=s*h+o*u+i*l-r*a,t[3]=o*h-i*a-r*l-s*u,t},d.mul=d.multiply,d.scale=l.scale,d.rotateX=function(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+o*a,t[1]=r*l+s*a,t[2]=s*l-r*a,t[3]=o*l-i*a,t},d.rotateY=function(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l-s*a,t[1]=r*l+o*a,t[2]=s*l+i*a,t[3]=o*l-r*a,t},d.rotateZ=function(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+r*a,t[1]=r*l-i*a,t[2]=s*l+o*a,t[3]=o*l-s*a,t},d.calculateW=function(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t},d.dot=l.dot,d.lerp=l.lerp,d.slerp=function(t,e,n,i){var r,s,o,a,l,u=e[0],h=e[1],c=e[2],f=e[3],d=n[0],p=n[1],m=n[2],g=n[3];return s=u*d+h*p+c*m+f*g,0>s&&(s=-s,d=-d,p=-p,m=-m,g=-g),1-s>1e-6?(r=Math.acos(s),o=Math.sin(r),a=Math.sin((1-i)*r)/o,l=Math.sin(i*r)/o):(a=1-i,l=i),t[0]=a*u+l*d,t[1]=a*h+l*p,t[2]=a*c+l*m,t[3]=a*f+l*g,t},d.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s,a=o?1/o:0;return t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=s*a,t},d.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},d.length=l.length,
d.len=d.length,d.squaredLength=l.squaredLength,d.sqrLen=d.squaredLength,d.normalize=l.normalize,d.fromMat3=function(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*s+o]-e[3*o+s])*n,t[s]=(e[3*s+r]+e[3*r+s])*n,t[o]=(e[3*o+r]+e[3*r+o])*n}return t},d.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.quat=d)}(n.exports)}(this)},{}],61:[function(t,e,n){var i=t("./vendor/augment"),r=t("./camera"),s=t("./math/rectangle"),o=(t("./minimap"),t("./camera-constrain")),a=t("./mixins"),l=i(PIXI.Container,function(t){this.constructor=function(e){t.constructor.apply(this,arguments),e.width,e.height,e.screenWidth,e.screenHeight,e.centerX,e.centerY,this.worldRectangle=new s(e.centerX,e.centerY,e.width,e.height),this.camera=new r(e.screenWidth,e.screenHeight),this.camera.zoomPivotX=this.camera.viewCenterX=e.screenWidth/2,this.camera.zoomPivotY=this.camera.viewCenterY=e.screenHeight/2,this.cameraConstrain=new o({worldBounds:this.worldRectangle})},this.setSize=function(t,e){this.worldRectangle.width=t,this.worldRectangle.height=e},this.setScreenSize=function(t,e){this.camera.setScreenSize(t,e)},this.setCenter=function(t,e){},this.update=function(){if(this.camera.update(),this.cameraConstrain.update(this.camera),l.__updateMixed)for(var t=0,e=this.children.length;e>t;++t)this.children[t]&&this.children[t].update()},this.updateTransform=function(){var t,e,n,i,r=this.camera.transform,s=this.worldTransform;t=this.scale.x,e=this.scale.y,n=this.position.x-this.pivot.x*t,i=this.position.y-this.pivot.y*e,s.a=t*r.a,s.b=t*r.b,s.c=e*r.c,s.d=e*r.d,s.tx=n*r.a+i*r.c+r.tx,s.ty=n*r.b+i*r.d+r.ty;for(var o=0,a=this.children.length;a>o;++o)this.children[o].updateTransform()}});l.mixinUpdates=function(){l.__updateMixed=!0,a.addContainerUpdates()},e.exports=l},{"./camera":52,"./camera-constrain":50,"./math/rectangle":54,"./minimap":56,"./mixins":57,"./vendor/augment":59}]},{},[1])(1)});var dat=dat||{};dat.gui=dat.gui||{},dat.utils=dat.utils||{},dat.controllers=dat.controllers||{},dat.dom=dat.dom||{},dat.color=dat.color||{},dat.utils.css=function(){return{load:function(t,e){e=e||document;var n=e.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=t,e.getElementsByTagName("head")[0].appendChild(n)},inject:function(t,e){e=e||document;var n=document.createElement("style");n.type="text/css",n.innerHTML=t,e.getElementsByTagName("head")[0].appendChild(n)}}}(),dat.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(e[n])||(t[n]=e[n])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(t[n])&&(t[n]=e[n])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var n=e.call(arguments),i=t.length-1;i>=0;i--)n=[t[i].apply(this,n)];return n[0]}},each:function(e,n,i){if(e)if(t&&e.forEach&&e.forEach===t)e.forEach(n,i);else if(e.length===e.length+0)for(var r=0,s=e.length;s>r&&!(r in e&&n.call(i,e[r],r)===this.BREAK);r++);else for(r in e)if(n.call(i,e[r],r)===this.BREAK)break},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return!1===t||!0===t},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),dat.controllers.Controller=function(t){var e=function(t,e){this.initialValue=t[e],this.domElement=document.createElement("div"),this.object=t,this.property=e,this.__onFinishChange=this.__onChange=void 0};return t.extend(e.prototype,{onChange:function(t){return this.__onChange=t,this},onFinishChange:function(t){return this.__onFinishChange=t,this},setValue:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),e}(dat.utils.common),dat.dom.dom=function(t){function e(e){return"0"===e||t.isUndefined(e)?0:(e=e.match(i),t.isNull(e)?0:parseFloat(e[1]))}var n={};t.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(e,i){t.each(e,function(t){n[t]=i})});var i=/(\d+(\.\d+)?)px/,r={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(e,n,i){t.isUndefined(n)&&(n=!0),t.isUndefined(i)&&(i=!0),e.style.position="absolute",n&&(e.style.left=0,e.style.right=0),i&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,i,r,s){r=r||{};var o=n[i];if(!o)throw Error("Event type "+i+" not supported.");var a=document.createEvent(o);switch(o){case"MouseEvents":a.initMouseEvent(i,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,r.x||r.clientX||0,r.y||r.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":o=a.initKeyboardEvent||a.initKeyEvent,t.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),o(i,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:a.initEvent(i,r.bubbles||!1,r.cancelable||!0)}t.defaults(a,s),e.dispatchEvent(a)},bind:function(t,e,n,i){return t.addEventListener?t.addEventListener(e,n,i||!1):t.attachEvent&&t.attachEvent("on"+e,n),r},unbind:function(t,e,n,i){return t.removeEventListener?t.removeEventListener(e,n,i||!1):t.detachEvent&&t.detachEvent("on"+e,n),r},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);-1==n.indexOf(e)&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return r},removeClass:function(t,e){if(e){if(void 0!==t.className)if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),i=n.indexOf(e);-1!=i&&(n.splice(i,1),t.className=n.join(" "))}}else t.className=void 0;return r},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){return t=getComputedStyle(t),e(t["border-left-width"])+e(t["border-right-width"])+e(t["padding-left"])+e(t["padding-right"])+e(t.width)},getHeight:function(t){return t=getComputedStyle(t),e(t["border-top-width"])+e(t["border-bottom-width"])+e(t["padding-top"])+e(t["padding-bottom"])+e(t.height)},getOffset:function(t){var e={left:0,top:0};if(t.offsetParent)do e.left+=t.offsetLeft,e.top+=t.offsetTop;while(t=t.offsetParent);return e},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}};return r}(dat.utils.common),dat.controllers.OptionController=function(t,e,n){var i=function(t,r,s){i.superclass.call(this,t,r);var o=this;if(this.__select=document.createElement("select"),n.isArray(s)){var a={};n.each(s,function(t){a[t]=t}),s=a}n.each(s,function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),o.__select.appendChild(n)}),this.updateDisplay(),e.bind(this.__select,"change",function(){o.setValue(this.options[this.selectedIndex].value)}),this.domElement.appendChild(this.__select)};return i.superclass=t,n.extend(i.prototype,t.prototype,{setValue:function(t){return t=i.superclass.prototype.setValue.call(this,t),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),t},updateDisplay:function(){return this.__select.value=this.getValue(),i.superclass.prototype.updateDisplay.call(this)}}),i}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.NumberController=function(t,e){function n(t){return t=t.toString(),-1<t.indexOf(".")?t.length-t.indexOf(".")-1:0}var i=function(t,r,s){i.superclass.call(this,t,r),s=s||{},this.__min=s.min,this.__max=s.max,this.__step=s.step,e.isUndefined(this.__step)?this.__impliedStep=0==this.initialValue?1:Math.pow(10,Math.floor(Math.log(Math.abs(this.initialValue))/Math.LN10))/10:this.__impliedStep=this.__step,this.__precision=n(this.__impliedStep)};return i.superclass=t,e.extend(i.prototype,t.prototype,{setValue:function(t){return void 0!==this.__min&&t<this.__min?t=this.__min:void 0!==this.__max&&t>this.__max&&(t=this.__max),void 0!==this.__step&&0!=t%this.__step&&(t=Math.round(t/this.__step)*this.__step),i.superclass.prototype.setValue.call(this,t)},min:function(t){return this.__min=t,this},max:function(t){return this.__max=t,this},step:function(t){return this.__impliedStep=this.__step=t,this.__precision=n(t),this}}),i}(dat.controllers.Controller,dat.utils.common),dat.controllers.NumberControllerBox=function(t,e,n){var i=function(t,r,s){function o(){var t=parseFloat(h.__input.value);n.isNaN(t)||h.setValue(t)}function a(t){var e=u-t.clientY;h.setValue(h.getValue()+e*h.__impliedStep),u=t.clientY}function l(){e.unbind(window,"mousemove",a),e.unbind(window,"mouseup",l)}this.__truncationSuspended=!1,i.superclass.call(this,t,r,s);var u,h=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"change",o),e.bind(this.__input,"blur",function(){o(),h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}),e.bind(this.__input,"mousedown",function(t){e.bind(window,"mousemove",a),e.bind(window,"mouseup",l),u=t.clientY}),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&(h.__truncationSuspended=!0,this.blur(),h.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return i.superclass=t,n.extend(i.prototype,t.prototype,{updateDisplay:function(){var t,e=this.__input;if(this.__truncationSuspended)t=this.getValue();else{t=this.getValue();var n=Math.pow(10,this.__precision);t=Math.round(t*n)/n}return e.value=t,i.superclass.prototype.updateDisplay.call(this)}}),i}(dat.controllers.NumberController,dat.dom.dom,dat.utils.common),dat.controllers.NumberControllerSlider=function(t,e,n,i,r){function s(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)}var o=function(t,n,i,r,a){function l(t){t.preventDefault();var n=e.getOffset(h.__background),i=e.getWidth(h.__background);return h.setValue(s(t.clientX,n.left,n.left+i,h.__min,h.__max)),!1}function u(){e.unbind(window,"mousemove",l),e.unbind(window,"mouseup",u),h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}o.superclass.call(this,t,n,{min:i,max:r,step:a});var h=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),e.bind(this.__background,"mousedown",function(t){e.bind(window,"mousemove",l),e.bind(window,"mouseup",u),l(t)}),e.addClass(this.__background,"slider"),e.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return o.superclass=t,o.useDefaultStyles=function(){n.inject(r)},i.extend(o.prototype,t.prototype,{updateDisplay:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",o.superclass.prototype.updateDisplay.call(this)}}),o}(dat.controllers.NumberController,dat.dom.dom,dat.utils.css,dat.utils.common,"/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n.slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"),dat.controllers.FunctionController=function(t,e,n){var i=function(t,n,r){i.superclass.call(this,t,n);var s=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===r?"Fire":r,e.bind(this.__button,"click",function(t){return t.preventDefault(),s.fire(),!1}),e.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return i.superclass=t,n.extend(i.prototype,t.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}),i}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.BooleanController=function(t,e,n){var i=function(t,n){i.superclass.call(this,t,n);var r=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),e.bind(this.__checkbox,"change",function(){r.setValue(!r.__prev)},!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return i.superclass=t,n.extend(i.prototype,t.prototype,{setValue:function(t){return t=i.superclass.prototype.setValue.call(this,t),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),t},updateDisplay:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,i.superclass.prototype.updateDisplay.call(this)}}),i}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.color.toString=function(t){return function(e){if(1==e.a||t.isUndefined(e.a)){for(e=e.hex.toString(16);6>e.length;)e="0"+e;return"#"+e}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}(dat.utils.common),dat.color.interpret=function(t,e){var n,i,r=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){return t=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i),null===t?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){return t=t.match(/^#([A-F0-9]{6})$/i),null===t?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString())}},write:t},CSS_RGB:{read:function(t){return t=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/),null===t?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:t},CSS_RGBA:{read:function(t){return t=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/),null===t?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a)?{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)?{space:"RGB",r:t.r,g:t.g,b:t.b}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a)?{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)?{space:"HSV",h:t.h,s:t.s,v:t.v}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return function(){i=!1;var t=1<arguments.length?e.toArray(arguments):arguments[0];return e.each(r,function(r){return r.litmus(t)?(e.each(r.conversions,function(r,s){return n=r.read(t),!1===i&&!1!==n?(i=n,n.conversionName=s,n.conversion=r,e.BREAK):void 0}),e.BREAK):void 0}),i}}(dat.color.toString,dat.utils.common),dat.GUI=dat.gui.GUI=function(t,e,n,i,r,s,o,a,l,u,h,c,f,d,p){function m(t,e,n,s){if(void 0===e[n])throw Error("Object "+e+' has no property "'+n+'"');s.color?e=new h(e,n):(e=[e,n].concat(s.factoryArgs),e=i.apply(t,e)),s.before instanceof r&&(s.before=s.before.__li),b(t,e),d.addClass(e.domElement,"c"),n=document.createElement("span"),d.addClass(n,"property-name"),n.innerHTML=e.property;var o=document.createElement("div");return o.appendChild(n),o.appendChild(e.domElement),s=g(t,o,s.before),d.addClass(s,D.CLASS_CONTROLLER_ROW),d.addClass(s,typeof e.getValue()),v(t,s,e),t.__controllers.push(e),e}function g(t,e,n){var i=document.createElement("li");return e&&i.appendChild(e),n?t.__ul.insertBefore(i,params.before):t.__ul.appendChild(i),t.onResize(),i}function v(t,e,n){if(n.__li=e,n.__gui=t,p.extend(n,{options:function(e){return 1<arguments.length?(n.remove(),m(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[p.toArray(arguments)]})):p.isArray(e)||p.isObject(e)?(n.remove(),m(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[e]})):void 0},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof l){var i=new a(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});p.each(["updateDisplay","onChange","onFinishChange"],function(t){var e=n[t],r=i[t];n[t]=i[t]=function(){var t=Array.prototype.slice.call(arguments);return e.apply(n,t),r.apply(i,t)}}),d.addClass(e,"has-slider"),n.domElement.insertBefore(i.domElement,n.domElement.firstElementChild)}else if(n instanceof a){var r=function(e){return p.isNumber(n.__min)&&p.isNumber(n.__max)?(n.remove(),m(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]})):e};n.min=p.compose(r,n.min),n.max=p.compose(r,n.max)}else n instanceof s?(d.bind(e,"click",function(){d.fakeEvent(n.__checkbox,"click")}),d.bind(n.__checkbox,"click",function(t){t.stopPropagation()})):n instanceof o?(d.bind(e,"click",function(){d.fakeEvent(n.__button,"click")}),d.bind(e,"mouseover",function(){d.addClass(n.__button,"hover")}),d.bind(e,"mouseout",function(){d.removeClass(n.__button,"hover")})):n instanceof h&&(d.addClass(e,"color"),n.updateDisplay=p.compose(function(t){return e.style.borderLeftColor=n.__color.toString(),t},n.updateDisplay),n.updateDisplay());n.setValue=p.compose(function(e){return t.getRoot().__preset_select&&n.isModified()&&k(t.getRoot(),!0),e},n.setValue)}function b(t,e){var n=t.getRoot(),i=n.__rememberedObjects.indexOf(e.object);if(-1!=i){var r=n.__rememberedObjectIndecesToControllers[i];if(void 0===r&&(r={},n.__rememberedObjectIndecesToControllers[i]=r),r[e.property]=e,n.load&&n.load.remembered){if(n=n.load.remembered,n[t.preset])n=n[t.preset];else{if(!n.Default)return;n=n.Default}n[i]&&void 0!==n[i][e.property]&&(i=n[i][e.property],e.initialValue=i,e.setValue(i))}}}function y(t){var e=t.__save_row=document.createElement("li");d.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),d.addClass(e,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",d.addClass(n,"button gears");var i=document.createElement("span");i.innerHTML="Save",d.addClass(i,"button"),d.addClass(i,"save");var r=document.createElement("span");r.innerHTML="New",d.addClass(r,"button"),d.addClass(r,"save-as");var s=document.createElement("span");s.innerHTML="Revert",d.addClass(s,"button"),d.addClass(s,"revert");var o=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?p.each(t.load.remembered,function(e,n){A(t,n,n==t.preset)}):A(t,"Default",!1),d.bind(o,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),e.appendChild(o),e.appendChild(n),e.appendChild(i),e.appendChild(r),e.appendChild(s),T){var a=function(){l.style.display=t.useLocalStorage?"block":"none"},e=document.getElementById("dg-save-locally"),l=document.getElementById("dg-local-explain");e.style.display="block",e=document.getElementById("dg-local-storage"),"true"===localStorage.getItem(document.location.href+".isLocal")&&e.setAttribute("checked","checked"),a(),d.bind(e,"change",function(){t.useLocalStorage=!t.useLocalStorage,a()})}var u=document.getElementById("dg-new-constructor");d.bind(u,"keydown",function(t){!t.metaKey||67!==t.which&&67!=t.keyCode||M.hide()}),d.bind(n,"click",function(){u.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),M.show(),u.focus(),u.select()}),d.bind(i,"click",function(){t.save()}),d.bind(r,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),d.bind(s,"click",function(){t.revert()})}function _(t){function e(e){return e.preventDefault(),r=e.clientX,d.addClass(t.__closeButton,D.CLASS_DRAG),d.bind(window,"mousemove",n),d.bind(window,"mouseup",i),!1}function n(e){return e.preventDefault(),t.width+=r-e.clientX,t.onResize(),r=e.clientX,!1}function i(){d.removeClass(t.__closeButton,D.CLASS_DRAG),d.unbind(window,"mousemove",n),d.unbind(window,"mouseup",i)}t.__resize_handle=document.createElement("div"),p.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var r;d.bind(t.__resize_handle,"mousedown",e),d.bind(t.__closeButton,"mousedown",e),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function w(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function x(t,e){var n={};return p.each(t.__rememberedObjects,function(i,r){var s={};p.each(t.__rememberedObjectIndecesToControllers[r],function(t,n){s[n]=e?t.initialValue:t.getValue()}),n[r]=s}),n}function A(t,e,n){var i=document.createElement("option");i.innerHTML=e,i.value=e,t.__preset_select.appendChild(i),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function k(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];n.innerHTML=e?n.value+"*":n.value}function S(t){0!=t.length&&c(function(){S(t)}),p.each(t,function(t){t.updateDisplay()})}t.inject(n);var T;try{T="localStorage"in window&&null!==window.localStorage}catch(C){T=!1}var M,I,O=!0,E=!1,R=[],D=function(t){function e(){var t=n.getRoot();t.width+=1,p.defer(function(){--t.width})}var n=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),d.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],t=t||{},t=p.defaults(t,{autoPlace:!0,width:D.DEFAULT_WIDTH}),t=p.defaults(t,{resizable:t.autoPlace,hideable:t.autoPlace}),p.isUndefined(t.load)?t.load={preset:"Default"}:t.preset&&(t.load.preset=t.preset),p.isUndefined(t.parent)&&t.hideable&&R.push(this),t.resizable=p.isUndefined(t.parent)&&t.resizable,t.autoPlace&&p.isUndefined(t.scrollable)&&(t.scrollable=!0);var i,r=T&&"true"===localStorage.getItem(document.location.href+".isLocal");if(Object.defineProperties(this,{parent:{get:function(){return t.parent}},scrollable:{get:function(){return t.scrollable}},autoPlace:{get:function(){return t.autoPlace}},preset:{get:function(){return n.parent?n.getRoot().preset:t.load.preset},set:function(e){for(n.parent?n.getRoot().preset=e:t.load.preset=e,e=0;e<this.__preset_select.length;e++)this.__preset_select[e].value==this.preset&&(this.__preset_select.selectedIndex=e);n.revert()}},width:{get:function(){return t.width},set:function(e){t.width=e,w(n,e)}},name:{get:function(){return t.name},set:function(e){t.name=e,o&&(o.innerHTML=t.name)}},closed:{get:function(){return t.closed},set:function(e){t.closed=e,t.closed?d.addClass(n.__ul,D.CLASS_CLOSED):d.removeClass(n.__ul,D.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?D.TEXT_OPEN:D.TEXT_CLOSED)}},load:{get:function(){return t.load}},useLocalStorage:{get:function(){return r},set:function(t){T&&((r=t)?d.bind(window,"unload",i):d.unbind(window,"unload",i),localStorage.setItem(document.location.href+".isLocal",t))}}}),p.isUndefined(t.parent)){if(t.closed=!1,d.addClass(this.domElement,D.CLASS_MAIN),d.makeSelectable(this.domElement,!1),T&&r){n.useLocalStorage=!0;var s=localStorage.getItem(document.location.href+".gui");s&&(t.load=JSON.parse(s))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=D.TEXT_CLOSED,d.addClass(this.__closeButton,D.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),d.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===t.closed&&(t.closed=!0);var o=document.createTextNode(t.name);d.addClass(o,"controller-name"),s=g(n,o),d.addClass(this.__ul,D.CLASS_CLOSED),d.addClass(s,"title"),d.bind(s,"click",function(t){return t.preventDefault(),n.closed=!n.closed,!1}),t.closed||(this.closed=!1)}t.autoPlace&&(p.isUndefined(t.parent)&&(O&&(I=document.createElement("div"),d.addClass(I,"dg"),d.addClass(I,D.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(I),O=!1),I.appendChild(this.domElement),d.addClass(this.domElement,D.CLASS_AUTO_PLACE)),this.parent||w(n,t.width)),d.bind(window,"resize",function(){n.onResize()}),d.bind(this.__ul,"webkitTransitionEnd",function(){n.onResize()}),d.bind(this.__ul,"transitionend",function(){n.onResize()}),d.bind(this.__ul,"oTransitionEnd",function(){n.onResize()}),this.onResize(),t.resizable&&_(this),this.saveToLocalStorageIfPossible=i=function(){T&&"true"===localStorage.getItem(document.location.href+".isLocal")&&localStorage.setItem(document.location.href+".gui",JSON.stringify(n.getSaveObject()))},n.getRoot(),t.parent||e()};return D.toggleHide=function(){E=!E,p.each(R,function(t){t.domElement.style.zIndex=E?-999:999,t.domElement.style.opacity=E?0:1})},D.CLASS_AUTO_PLACE="a",D.CLASS_AUTO_PLACE_CONTAINER="ac",D.CLASS_MAIN="main",D.CLASS_CONTROLLER_ROW="cr",D.CLASS_TOO_TALL="taller-than-window",D.CLASS_CLOSED="closed",D.CLASS_CLOSE_BUTTON="close-button",D.CLASS_DRAG="drag",D.DEFAULT_WIDTH=245,D.TEXT_CLOSED="Close Controls",D.TEXT_OPEN="Open Controls",d.bind(window,"keydown",function(t){"text"===document.activeElement.type||72!==t.which&&72!=t.keyCode||D.toggleHide()},!1),p.extend(D.prototype,{add:function(t,e){return m(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return m(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var e=this;p.defer(function(){e.onResize()})},destroy:function(){this.autoPlace&&I.removeChild(this.domElement)},addFolder:function(t){if(void 0!==this.__folders[t])throw Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};return e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]),e=new D(e),this.__folders[t]=e,t=g(this,e.domElement),d.addClass(t,"folder"),e},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=d.getOffset(t.__ul).top,n=0;p.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(n+=d.getHeight(e))}),window.innerHeight-e-20<n?(d.addClass(t.domElement,D.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-20+"px"):(d.removeClass(t.domElement,D.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&p.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},remember:function(){if(p.isUndefined(M)&&(M=new f,M.domElement.innerHTML=e),this.parent)throw Error("You can only call remember on a top level GUI.");var t=this;p.each(Array.prototype.slice.call(arguments),function(e){0==t.__rememberedObjects.length&&y(t),-1==t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&w(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,0<this.__rememberedObjects.length&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=x(this)),t.folders={},p.each(this.__folders,function(e,n){t.folders[n]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=x(this),k(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=x(this,!0)),this.load.remembered[t]=x(this),this.preset=t,A(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){p.each(this.__controllers,function(e){this.getRoot().load.remembered?b(t||this.getRoot(),e):e.setValue(e.initialValue)},this),p.each(this.__folders,function(t){t.revert(t)}),t||k(this.getRoot(),!1)},listen:function(t){var e=0==this.__listening.length;this.__listening.push(t),e&&S(this.__listening)}}),D}(dat.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg {\n  /** Clear list styles */\n  /* Auto-place container */\n  /* Auto-placed GUI's */\n  /* Line items that don't contain folders. */\n  /** Folder names */\n  /** Hides closed items */\n  /** Controller row */\n  /** Name-half (left) */\n  /** Controller-half (right) */\n  /** Controller placement */\n  /** Shorter number boxes when slider is present. */\n  /** Ensure the entire boolean and function row shows a hand */ }\n  .dg ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    clear: both; }\n  .dg.ac {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 0;\n    z-index: 0; }\n  .dg:not(.ac) .main {\n    /** Exclude mains in ac so that we don't hide close button */\n    overflow: hidden; }\n  .dg.main {\n    -webkit-transition: opacity 0.1s linear;\n    -o-transition: opacity 0.1s linear;\n    -moz-transition: opacity 0.1s linear;\n    transition: opacity 0.1s linear; }\n    .dg.main.taller-than-window {\n      overflow-y: auto; }\n      .dg.main.taller-than-window .close-button {\n        opacity: 1;\n        /* TODO, these are style notes */\n        margin-top: -1px;\n        border-top: 1px solid #2c2c2c; }\n    .dg.main ul.closed .close-button {\n      opacity: 1 !important; }\n    .dg.main:hover .close-button,\n    .dg.main .close-button.drag {\n      opacity: 1; }\n    .dg.main .close-button {\n      /*opacity: 0;*/\n      -webkit-transition: opacity 0.1s linear;\n      -o-transition: opacity 0.1s linear;\n      -moz-transition: opacity 0.1s linear;\n      transition: opacity 0.1s linear;\n      border: 0;\n      position: absolute;\n      line-height: 19px;\n      height: 20px;\n      /* TODO, these are style notes */\n      cursor: pointer;\n      text-align: center;\n      background-color: #000; }\n      .dg.main .close-button:hover {\n        background-color: #111; }\n  .dg.a {\n    float: right;\n    margin-right: 15px;\n    overflow-x: hidden; }\n    .dg.a.has-save > ul {\n      margin-top: 27px; }\n      .dg.a.has-save > ul.closed {\n        margin-top: 0; }\n    .dg.a .save-row {\n      position: fixed;\n      top: 0;\n      z-index: 1002; }\n  .dg li {\n    -webkit-transition: height 0.1s ease-out;\n    -o-transition: height 0.1s ease-out;\n    -moz-transition: height 0.1s ease-out;\n    transition: height 0.1s ease-out; }\n  .dg li:not(.folder) {\n    cursor: auto;\n    height: 27px;\n    line-height: 27px;\n    overflow: hidden;\n    padding: 0 4px 0 5px; }\n  .dg li.folder {\n    padding: 0;\n    border-left: 4px solid rgba(0, 0, 0, 0); }\n  .dg li.title {\n    cursor: pointer;\n    margin-left: -4px; }\n  .dg .closed li:not(.title),\n  .dg .closed ul li,\n  .dg .closed ul li > * {\n    height: 0;\n    overflow: hidden;\n    border: 0; }\n  .dg .cr {\n    clear: both;\n    padding-left: 3px;\n    height: 27px; }\n  .dg .property-name {\n    cursor: default;\n    float: left;\n    clear: left;\n    width: 40%;\n    overflow: hidden;\n    text-overflow: ellipsis; }\n  .dg .c {\n    float: left;\n    width: 60%; }\n  .dg .c input[type=text] {\n    border: 0;\n    margin-top: 4px;\n    padding: 3px;\n    width: 100%;\n    float: right; }\n  .dg .has-slider input[type=text] {\n    width: 30%;\n    /*display: none;*/\n    margin-left: 0; }\n  .dg .slider {\n    float: left;\n    width: 66%;\n    margin-left: -5px;\n    margin-right: 0;\n    height: 19px;\n    margin-top: 4px; }\n  .dg .slider-fg {\n    height: 100%; }\n  .dg .c input[type=checkbox] {\n    margin-top: 9px; }\n  .dg .c select {\n    margin-top: 5px; }\n  .dg .cr.function,\n  .dg .cr.function .property-name,\n  .dg .cr.function *,\n  .dg .cr.boolean,\n  .dg .cr.boolean * {\n    cursor: pointer; }\n  .dg .selector {\n    display: none;\n    position: absolute;\n    margin-left: -9px;\n    margin-top: 23px;\n    z-index: 10; }\n  .dg .c:hover .selector,\n  .dg .selector.drag {\n    display: block; }\n  .dg li.save-row {\n    padding: 0; }\n    .dg li.save-row .button {\n      display: inline-block;\n      padding: 0px 6px; }\n  .dg.dialogue {\n    background-color: #222;\n    width: 460px;\n    padding: 15px;\n    font-size: 13px;\n    line-height: 15px; }\n\n/* TODO Separate style and structure */\n#dg-new-constructor {\n  padding: 10px;\n  color: #222;\n  font-family: Monaco, monospace;\n  font-size: 10px;\n  border: 0;\n  resize: none;\n  box-shadow: inset 1px 1px 1px #888;\n  word-wrap: break-word;\n  margin: 12px 0;\n  display: block;\n  width: 440px;\n  overflow-y: scroll;\n  height: 100px;\n  position: relative; }\n\n#dg-local-explain {\n  display: none;\n  font-size: 11px;\n  line-height: 17px;\n  border-radius: 3px;\n  background-color: #333;\n  padding: 8px;\n  margin-top: 10px; }\n  #dg-local-explain code {\n    font-size: 10px; }\n\n#dat-gui-save-locally {\n  display: none; }\n\n/** Main type */\n.dg {\n  color: #eee;\n  font: 11px 'Lucida Grande', sans-serif;\n  text-shadow: 0 -1px 0 #111;\n  /** Auto place */\n  /* Controller row, <li> */\n  /** Controllers */ }\n  .dg.main {\n    /** Scrollbar */ }\n    .dg.main::-webkit-scrollbar {\n      width: 5px;\n      background: #1a1a1a; }\n    .dg.main::-webkit-scrollbar-corner {\n      height: 0;\n      display: none; }\n    .dg.main::-webkit-scrollbar-thumb {\n      border-radius: 5px;\n      background: #676767; }\n  .dg li:not(.folder) {\n    background: #1a1a1a;\n    border-bottom: 1px solid #2c2c2c; }\n  .dg li.save-row {\n    line-height: 25px;\n    background: #dad5cb;\n    border: 0; }\n    .dg li.save-row select {\n      margin-left: 5px;\n      width: 108px; }\n    .dg li.save-row .button {\n      margin-left: 5px;\n      margin-top: 1px;\n      border-radius: 2px;\n      font-size: 9px;\n      line-height: 7px;\n      padding: 4px 4px 5px 4px;\n      background: #c5bdad;\n      color: #fff;\n      text-shadow: 0 1px 0 #b0a58f;\n      box-shadow: 0 -1px 0 #b0a58f;\n      cursor: pointer; }\n      .dg li.save-row .button.gears {\n        background: #c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;\n        height: 7px;\n        width: 8px; }\n      .dg li.save-row .button:hover {\n        background-color: #bab19e;\n        box-shadow: 0 -1px 0 #b0a58f; }\n  .dg li.folder {\n    border-bottom: 0; }\n  .dg li.title {\n    padding-left: 16px;\n    background: black url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;\n    cursor: pointer;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2); }\n  .dg .closed li.title {\n    background-image: url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==); }\n  .dg .cr.boolean {\n    border-left: 3px solid #806787; }\n  .dg .cr.function {\n    border-left: 3px solid #e61d5f; }\n  .dg .cr.number {\n    border-left: 3px solid #2fa1d6; }\n    .dg .cr.number input[type=text] {\n      color: #2fa1d6; }\n  .dg .cr.string {\n    border-left: 3px solid #1ed36f; }\n    .dg .cr.string input[type=text] {\n      color: #1ed36f; }\n  .dg .cr.function:hover, .dg .cr.boolean:hover {\n    background: #111; }\n  .dg .c input[type=text] {\n    background: #303030;\n    outline: none; }\n    .dg .c input[type=text]:hover {\n      background: #3c3c3c; }\n    .dg .c input[type=text]:focus {\n      background: #494949;\n      color: #fff; }\n  .dg .c .slider {\n    background: #303030;\n    cursor: ew-resize; }\n  .dg .c .slider-fg {\n    background: #2fa1d6; }\n  .dg .c .slider:hover {\n    background: #3c3c3c; }\n    .dg .c .slider:hover .slider-fg {\n      background: #44abda; }\n",dat.controllers.factory=function(t,e,n,i,r,s,o){
return function(a,l,u,h){var c=a[l];return o.isArray(u)||o.isObject(u)?new t(a,l,u):o.isNumber(c)?o.isNumber(u)&&o.isNumber(h)?new n(a,l,u,h):new e(a,l,{min:u,max:h}):o.isString(c)?new i(a,l):o.isFunction(c)?new r(a,l,""):o.isBoolean(c)?new s(a,l):void 0}}(dat.controllers.OptionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.StringController=function(t,e,n){var i=function(t,n){function r(){s.setValue(s.__input.value)}i.superclass.call(this,t,n);var s=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"keyup",r),e.bind(this.__input,"change",r),e.bind(this.__input,"blur",function(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return i.superclass=t,n.extend(i.prototype,t.prototype,{updateDisplay:function(){return e.isActive(this.__input)||(this.__input.value=this.getValue()),i.superclass.prototype.updateDisplay.call(this)}}),i}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.FunctionController,dat.controllers.BooleanController,dat.utils.common),dat.controllers.Controller,dat.controllers.BooleanController,dat.controllers.FunctionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.OptionController,dat.controllers.ColorController=function(t,e,n,i,r){function s(t,e,n,i){t.style.background="",r.each(l,function(r){t.style.cssText+="background: "+r+"linear-gradient("+e+", "+n+" 0%, "+i+" 100%); "})}function o(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var a=function(t,l){function u(t){d(t),e.bind(window,"mousemove",d),e.bind(window,"mouseup",h)}function h(){e.unbind(window,"mousemove",d),e.unbind(window,"mouseup",h)}function c(){var t=i(this.value);!1!==t?(m.__color.__state=t,m.setValue(m.__color.toOriginal())):this.value=m.__color.toString()}function f(){e.unbind(window,"mousemove",p),e.unbind(window,"mouseup",f)}function d(t){t.preventDefault();var n=e.getWidth(m.__saturation_field),i=e.getOffset(m.__saturation_field),r=(t.clientX-i.left+document.body.scrollLeft)/n;return t=1-(t.clientY-i.top+document.body.scrollTop)/n,t>1?t=1:0>t&&(t=0),r>1?r=1:0>r&&(r=0),m.__color.v=t,m.__color.s=r,m.setValue(m.__color.toOriginal()),!1}function p(t){t.preventDefault();var n=e.getHeight(m.__hue_field),i=e.getOffset(m.__hue_field);return t=1-(t.clientY-i.top+document.body.scrollTop)/n,t>1?t=1:0>t&&(t=0),m.__color.h=360*t,m.setValue(m.__color.toOriginal()),!1}a.superclass.call(this,t,l),this.__color=new n(this.getValue()),this.__temp=new n(0);var m=this;this.domElement=document.createElement("div"),e.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",e.bind(this.__input,"keydown",function(t){13===t.keyCode&&c.call(this)}),e.bind(this.__input,"blur",c),e.bind(this.__selector,"mousedown",function(t){e.addClass(this,"drag").bind(window,"mouseup",function(t){e.removeClass(m.__selector,"drag")})});var g=document.createElement("div");r.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),r.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(.5>this.__color.v?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),r.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),r.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),r.extend(g.style,{width:"100%",height:"100%",background:"none"}),s(g,"top","rgba(0,0,0,0)","#000"),r.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),o(this.__hue_field),r.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),e.bind(this.__saturation_field,"mousedown",u),e.bind(this.__field_knob,"mousedown",u),e.bind(this.__hue_field,"mousedown",function(t){p(t),e.bind(window,"mousemove",p),e.bind(window,"mouseup",f)}),this.__saturation_field.appendChild(g),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};a.superclass=t,r.extend(a.prototype,t.prototype,{updateDisplay:function(){var t=i(this.getValue());if(!1!==t){var e=!1;r.each(n.COMPONENTS,function(n){return r.isUndefined(t[n])||r.isUndefined(this.__color.__state[n])||t[n]===this.__color.__state[n]?void 0:(e=!0,{})},this),e&&r.extend(this.__color.__state,t)}r.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var o=.5>this.__color.v||.5<this.__color.s?255:0,a=255-o;r.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+o+","+o+","+o+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,s(this.__saturation_field,"left","#fff",this.__temp.toString()),r.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+o+","+o+","+o+")",textShadow:this.__input_textShadow+"rgba("+a+","+a+","+a+",.7)"})}});var l=["-moz-","-o-","-webkit-","-ms-",""];return a}(dat.controllers.Controller,dat.dom.dom,dat.color.Color=function(t,e,n,i){function r(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(o(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(o(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function s(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(a(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(a(this),this.__state.space="HSV"),this.__state[e]=t}})}function o(t,n,r){if("HEX"===t.__state.space)t.__state[n]=e.component_from_hex(t.__state.hex,r);else{if("HSV"!==t.__state.space)throw"Corrupted color state";i.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}}function a(t){var n=e.rgb_to_hsv(t.r,t.g,t.b);i.extend(t.__state,{s:n.s,v:n.v}),i.isNaN(n.h)?i.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=n.h}var l=function(){if(this.__state=t.apply(this,arguments),!1===this.__state)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return l.COMPONENTS="r g b h s v hex a".split(" "),i.extend(l.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),r(l.prototype,"r",2),r(l.prototype,"g",1),r(l.prototype,"b",0),s(l.prototype,"h"),s(l.prototype,"s"),s(l.prototype,"v"),Object.defineProperty(l.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(l.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),l}(dat.color.interpret,dat.color.math=function(){var t;return{hsv_to_rgb:function(t,e,n){var i=t/60-Math.floor(t/60),r=n*(1-e),s=n*(1-i*e);return e=n*(1-(1-i)*e),t=[[n,e,r],[s,n,r],[r,n,e],[r,s,n],[e,r,n],[n,r,s]][Math.floor(t/60)%6],{r:255*t[0],g:255*t[1],b:255*t[2]}},rgb_to_hsv:function(t,e,n){var i=Math.min(t,e,n),r=Math.max(t,e,n),i=r-i;return 0==r?{h:NaN,s:0,v:0}:(t=(t==r?(e-n)/i:e==r?2+(n-t)/i:4+(t-e)/i)/6,0>t&&(t+=1),{h:360*t,s:i/r,v:r/255})},rgb_to_hex:function(t,e,n){return t=this.hex_with_component(0,2,t),t=this.hex_with_component(t,1,e),t=this.hex_with_component(t,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(e,n,i){return i<<(t=8*n)|e&~(255<<t)}}}(),dat.color.toString,dat.utils.common),dat.color.interpret,dat.utils.common),dat.utils.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)}}(),dat.dom.CenteredDiv=function(t,e){var n=function(){this.backgroundElement=document.createElement("div"),e.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),t.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),e.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;t.bind(this.backgroundElement,"click",function(){n.hide()})};return n.prototype.show=function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),e.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})},n.prototype.hide=function(){var e=this,n=function(){e.domElement.style.display="none",e.backgroundElement.style.display="none",t.unbind(e.domElement,"webkitTransitionEnd",n),t.unbind(e.domElement,"transitionend",n),t.unbind(e.domElement,"oTransitionEnd",n)};t.bind(this.domElement,"webkitTransitionEnd",n),t.bind(this.domElement,"transitionend",n),t.bind(this.domElement,"oTransitionEnd",n),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},n.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-t.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-t.getHeight(this.domElement)/2+"px"},n}(dat.dom.dom,dat.utils.common),dat.dom.dom,dat.utils.common),function(){function t(){for(var t in this.sections)this.sections[t].condition()&&this.sections[t].callback.call(this)}var e=function(){this.audioAdapter=e._getAdapter(this),this.events={},this.sections=[],this.bind("update",t)};e.version="0.3.2",e.adapters={},e.prototype={load:function(t){return t instanceof HTMLElement?(this.source=t,"flash"===e.isSupported()&&(this.source={src:e._getMP3SrcFromAudio(t)})):(this.source=window.Audio?new Audio:{},this.source.src=e._makeSupportedPath(t.src,t.codecs)),this.audio=this.audioAdapter.load(this.source),this},play:function(){return this.audioAdapter.play(),this},pause:function(){return this.audioAdapter.pause(),this},setVolume:function(t){return this.audioAdapter.setVolume(t),this},createKick:function(t){return new e.Kick(this,t)},bind:function(t,e){return this.events[t]||(this.events[t]=[]),this.events[t].push(e),this},unbind:function(t){return this.events[t]&&delete this.events[t],this},trigger:function(t){var e=this;return this.events[t]&&this.events[t].forEach(function(t){t.call(e)}),this},getVolume:function(){return this.audioAdapter.getVolume()},getProgress:function(){return this.audioAdapter.getProgress()},getTime:function(){return this.audioAdapter.getTime()},getFrequency:function(t,e){var n=0;if(void 0!==e){for(var i=t;e>=i;i++)n+=this.getSpectrum()[i];return n/(e-t+1)}return this.getSpectrum()[t]},getWaveform:function(){return this.audioAdapter.getWaveform()},getSpectrum:function(){return this.audioAdapter.getSpectrum()},isLoaded:function(){return this.audioAdapter.isLoaded},isPlaying:function(){return this.audioAdapter.isPlaying},after:function(t,e){var n=this;return this.sections.push({condition:function(){return n.getTime()>t},callback:e}),this},before:function(t,e){var n=this;return this.sections.push({condition:function(){return n.getTime()<t},callback:e}),this},between:function(t,e,n){var i=this;return this.sections.push({condition:function(){return i.getTime()>t&&i.getTime()<e},callback:n}),this},onceAt:function(t,e){var n=this,i=null;return this.sections.push({condition:function(){return n.getTime()>t&&!this.called},callback:function(){e.call(this),i.called=!0},called:!1}),i=this.sections[this.sections.length-1],this}},window.Dancer=e}(),function(t){function e(){var t=!!(navigator.vendor||"").match(/Apple/),e=navigator.userAgent.match(/Version\/([^ ]*)/);return e=e?parseFloat(e[1]):0,t&&6>=e}var n={mp3:"audio/mpeg;",ogg:'audio/ogg; codecs="vorbis"',wav:'audio/wav; codecs="1"',aac:'audio/mp4; codecs="mp4a.40.2"'},i=document.createElement("audio");t.options={},t.setOptions=function(e){for(var n in e)e.hasOwnProperty(n)&&(t.options[n]=e[n])},t.isSupported=function(){return window.Float32Array&&window.Uint32Array?e()||!window.AudioContext&&!window.webkitAudioContext?i&&i.mozSetup?"audiodata":FlashDetect.versionAtLeast(9)?"flash":"":"webaudio":null},t.canPlay=function(e){i.canPlayType;return!!("flash"===t.isSupported()?"mp3"===e.toLowerCase():i.canPlayType&&i.canPlayType(n[e.toLowerCase()]).replace(/no/,""))},t.addPlugin=function(e,n){void 0===t.prototype[e]&&(t.prototype[e]=n)},t._makeSupportedPath=function(e,n){if(!n)return e;for(var i=0;i<n.length;i++)if(t.canPlay(n[i]))return e+"."+n[i];return e},t._getAdapter=function(e){switch(t.isSupported()){case"webaudio":return new t.adapters.webaudio(e);case"audiodata":return new t.adapters.moz(e);case"flash":return new t.adapters.flash(e);default:return null}},t._getMP3SrcFromAudio=function(t){var e=t.children;if(t.src)return t.src;for(var n=e.length;n--;)if((e[n].type||"").match(/audio\/mpeg/))return e[n].src;return null}}(window.Dancer),function(t){var e=function(e,n){n=n||{},this.dancer=e,this.frequency=n.frequency!==t?n.frequency:[0,10],this.threshold=n.threshold!==t?n.threshold:.3,this.decay=n.decay!==t?n.decay:.02,this.onKick=n.onKick,this.offKick=n.offKick,this.isOn=!1,this.currentThreshold=this.threshold;var i=this;this.dancer.bind("update",function(){i.onUpdate()})};e.prototype={on:function(){return this.isOn=!0,this},off:function(){return this.isOn=!1,this},set:function(e){e=e||{},this.frequency=e.frequency!==t?e.frequency:this.frequency,this.threshold=e.threshold!==t?e.threshold:this.threshold,this.decay=e.decay!==t?e.decay:this.decay,this.onKick=e.onKick||this.onKick,this.offKick=e.offKick||this.offKick},onUpdate:function(){if(this.isOn){var t=this.maxAmplitude(this.frequency);t>=this.currentThreshold&&t>=this.threshold?(this.currentThreshold=t,this.onKick&&this.onKick.call(this.dancer,t)):(this.offKick&&this.offKick.call(this.dancer,t),this.currentThreshold-=this.decay)}},maxAmplitude:function(t){var e=0,n=this.dancer.getSpectrum();if(!t.length)return t<n.length?n[~~t]:null;for(var i=t[0],r=t[1];r>=i;i++)n[i]>e&&(e=n[i]);return e}},window.Dancer.Kick=e}(),function(){function t(){this.source=this.context.createMediaElementSource(this.audio),this.source.connect(this.proc),this.source.connect(this.gain),this.gain.connect(this.context.destination),this.proc.connect(this.context.destination),this.isLoaded=!0,this.progress=1,this.dancer.trigger("loaded")}var e=2048,n=44100,i=function(t){this.dancer=t,this.audio=new Audio,this.context=window.AudioContext?new window.AudioContext:new window.webkitAudioContext};i.prototype={load:function(i){var r=this;return this.audio=i,this.isLoaded=!1,this.progress=0,this.context.createScriptProcessor||(this.context.createScriptProcessor=this.context.createJavascriptNode),this.proc=this.context.createScriptProcessor(e/2,1,1),this.proc.onaudioprocess=function(t){r.update.call(r,t)},this.context.createGain||(this.context.createGain=this.context.createGainNode),this.gain=this.context.createGain(),this.fft=new FFT(e/2,n),this.signal=new Float32Array(e/2),this.audio.readyState<3?this.audio.addEventListener("canplay",function(){t.call(r)}):t.call(r),this.audio.addEventListener("progress",function(t){t.currentTarget.duration&&(r.progress=t.currentTarget.seekable.end(0)/t.currentTarget.duration)}),this.audio},play:function(){this.audio.play(),this.isPlaying=!0},pause:function(){this.audio.pause(),this.isPlaying=!1},setVolume:function(t){this.gain.gain.value=t},getVolume:function(){return this.gain.gain.value},getProgress:function(){return this.progress},getWaveform:function(){return this.signal},getSpectrum:function(){return this.fft.spectrum},getTime:function(){return this.audio.currentTime},update:function(t){if(this.isPlaying&&this.isLoaded){var n,i=[],r=t.inputBuffer.numberOfChannels,s=e/r,o=function(t,e){return t[n]+e[n]};for(n=r;n--;)i.push(t.inputBuffer.getChannelData(n));for(n=0;s>n;n++)this.signal[n]=r>1?i.reduce(o)/r:i[0][n];this.fft.forward(this.signal),this.dancer.trigger("update")}}},Dancer.adapters.webaudio=i}(),function(){function t(){this.fbLength=this.audio.mozFrameBufferLength,this.channels=this.audio.mozChannels,this.rate=this.audio.mozSampleRate,this.fft=new FFT(this.fbLength/this.channels,this.rate),this.signal=new Float32Array(this.fbLength/this.channels),this.isLoaded=!0,this.progress=1,this.dancer.trigger("loaded")}var e=function(t){this.dancer=t,this.audio=new Audio};e.prototype={load:function(e){var n=this;return this.audio=e,this.isLoaded=!1,this.progress=0,this.audio.readyState<3?this.audio.addEventListener("loadedmetadata",function(){t.call(n)},!1):t.call(n),this.audio.addEventListener("MozAudioAvailable",function(t){n.update(t)},!1),this.audio.addEventListener("progress",function(t){t.currentTarget.duration&&(n.progress=t.currentTarget.seekable.end(0)/t.currentTarget.duration)},!1),this.audio},play:function(){this.audio.play(),this.isPlaying=!0},pause:function(){this.audio.pause(),this.isPlaying=!1},setVolume:function(t){this.audio.volume=t},getVolume:function(){return this.audio.volume},getProgress:function(){return this.progress},getWaveform:function(){return this.signal},getSpectrum:function(){return this.fft.spectrum},getTime:function(){return this.audio.currentTime},update:function(t){if(this.isPlaying&&this.isLoaded){for(var e=0,n=this.fbLength/2;n>e;e++)this.signal[e]=(t.frameBuffer[2*e]+t.frameBuffer[2*e+1])/2;this.fft.forward(this.signal),this.dancer.trigger("update")}}},Dancer.adapters.moz=e}(),function(){function t(){var t=this;s=!0,e(Dancer.options.flashJS,function(){soundManager=new SoundManager,soundManager.flashVersion=9,soundManager.flash9Options.useWaveformData=!0,soundManager.useWaveformData=!0,soundManager.useHighPerformance=!0,soundManager.useFastPolling=!0,soundManager.multiShot=!1,soundManager.debugMode=!1,soundManager.debugFlash=!1,soundManager.url=Dancer.options.flashSWF,soundManager.onready(function(){r=!0,t.load()}),soundManager.ontimeout(function(){console.error("Error loading SoundManager2.swf")}),soundManager.beginDelayedInit()})}function e(t,e){var n=document.createElement("script"),i=document.getElementsByTagName("script")[0];n.type="text/javascript",n.src=t,n.onload=e,i.parentNode.insertBefore(n,i)}var n=1024,i=44100,r=!1,s=!1,o=.93,a=function(t){this.dancer=t,this.wave_L=[],this.wave_R=[],this.spectrum=[],window.SM2_DEFER=!0};a.prototype={load:function(e){var r=this;return this.path=e?e.src:this.path,this.isLoaded=!1,this.progress=0,!window.soundManager&&!s&&t.call(this),window.soundManager&&(this.audio=soundManager.createSound({id:"dancer"+Math.random(),url:this.path,stream:!0,autoPlay:!1,autoLoad:!0,whileplaying:function(){r.update()},whileloading:function(){r.progress=this.bytesLoaded/this.bytesTotal},onload:function(){r.fft=new FFT(n,i),r.signal=new Float32Array(n),r.waveform=new Float32Array(n),r.isLoaded=!0,r.progress=1,r.dancer.trigger("loaded")}}),this.dancer.audio=this.audio),this.audio},play:function(){this.audio.play(),this.isPlaying=!0},pause:function(){this.audio.pause(),this.isPlaying=!1},setVolume:function(t){this.audio.setVolume(100*t)},getVolume:function(){return this.audio.volume/100},getProgress:function(){return this.progress},getWaveform:function(){return this.waveform},getSpectrum:function(){return this.fft.spectrum},getTime:function(){return this.audio.position/1e3},update:function(){if(this.isPlaying||this.isLoaded){this.wave_L=this.audio.waveformData.left,this.wave_R=this.audio.waveformData.right;for(var t,e=0,n=this.wave_L.length;n>e;e++)t=parseFloat(this.wave_L[e])+parseFloat(this.wave_R[e]),this.waveform[2*e]=t/2,this.waveform[2*e+1]=t/2,this.signal[2*e]=t*o,this.signal[2*e+1]=t*o;this.fft.forward(this.signal),this.dancer.trigger("update")}}},Dancer.adapters.flash=a}(),FFT.prototype.forward=function(t){var e=this.bufferSize,n=this.cosTable,i=this.sinTable,r=this.reverseTable,s=this.real,o=this.imag,a=(this.spectrum,Math.floor(Math.log(e)/Math.LN2));if(Math.pow(2,a)!==e)throw"Invalid buffer size, must be a power of 2.";if(e!==t.length)throw"Supplied buffer is not the same size as defined FFT. FFT Size: "+e+" Buffer Size: "+t.length;var l,u,h,c,f,d,p,m,g,v=1;for(g=0;e>g;g++)s[g]=t[r[g]],o[g]=0;for(;e>v;){l=n[v],u=i[v],h=1,c=0;for(var b=0;v>b;b++){for(g=b;e>g;)f=g+v,d=h*s[f]-c*o[f],p=h*o[f]+c*s[f],s[f]=s[g]-d,o[f]=o[g]-p,s[g]+=d,o[g]+=p,g+=v<<1;m=h,h=m*l-c*u,c=m*u+c*l}v<<=1}return this.calculateSpectrum()};var FlashDetect=new function(){var t=this;t.installed=!1,t.raw="",t.major=-1,t.minor=-1,t.revision=-1,t.revisionStr="";var e=[{name:"ShockwaveFlash.ShockwaveFlash.7",version:function(t){return n(t)}},{name:"ShockwaveFlash.ShockwaveFlash.6",version:function(t){var e="6,0,21";try{t.AllowScriptAccess="always",e=n(t)}catch(i){}return e}},{name:"ShockwaveFlash.ShockwaveFlash",version:function(t){return n(t)}}],n=function(t){var e=-1;try{e=t.GetVariable("$version")}catch(n){}return e},r=function(t){var e=-1;try{e=new ActiveXObject(t)}catch(n){e={activeXError:!0}}return e},s=function(t){var e=t.split(",");return{raw:t,major:parseInt(e[0].split(" ")[1],10),minor:parseInt(e[1],10),revision:parseInt(e[2],10),revisionStr:e[2]}},o=function(t){var e=t.split(/ +/),n=e[2].split(/\./),i=e[3];return{raw:t,major:parseInt(n[0],10),minor:parseInt(n[1],10),revisionStr:i,revision:a(i)}},a=function(e){return parseInt(e.replace(/[a-zA-Z]/g,""),10)||t.revision};t.majorAtLeast=function(e){return t.major>=e},t.minorAtLeast=function(e){return t.minor>=e},t.revisionAtLeast=function(e){return t.revision>=e},t.versionAtLeast=function(e){var n=[t.major,t.minor,t.revision],r=Math.min(n.length,arguments.length);for(i=0;i<r;i++){if(n[i]>=arguments[i]){if(i+1<r&&n[i]==arguments[i])continue;return!0}return!1}},t.FlashDetect=function(){if(navigator.plugins&&navigator.plugins.length>0){var n="application/x-shockwave-flash",i=navigator.mimeTypes;if(i&&i[n]&&i[n].enabledPlugin&&i[n].enabledPlugin.description){var a=i[n].enabledPlugin.description,l=o(a);t.raw=l.raw,t.major=l.major,t.minor=l.minor,t.revisionStr=l.revisionStr,t.revision=l.revision,t.installed=!0}}else if(-1==navigator.appVersion.indexOf("Mac")&&window.execScript)for(var a=-1,u=0;u<e.length&&-1==a;u++){var h=r(e[u].name);if(!h.activeXError&&(t.installed=!0,a=e[u].version(h),-1!=a)){var l=s(a);t.raw=l.raw,t.major=l.major,t.minor=l.minor,t.revision=l.revision,t.revisionStr=l.revisionStr}}}()};FlashDetect.JS_RELEASE="1.0.4",!function(t){"use strict";var e=function(){return v.apply(null,arguments)},n=Array.prototype.slice,i=0,r=1,s=2,o=3,a=[8e3,11025,12e3,16e3,22050,24e3,32e3,44100,48e3],l=[32,64,128,256],u="14.10.12",h=null,c={},f={},d="undefined"!=typeof window?"browser":"undefined"!=typeof module&&module.exports?"node":"unknown",p="browser"===d&&/(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent),m=!1,g=120,v=function(){var e,i,r=n.call(arguments),s=r[0];switch(typeof s){case"string":c[s]?e=new c[s](r.slice(1)):f[s]?e=f[s](r.slice(1)):(i=/^(.+?)(?:\.(ar|kr))?$/.exec(s),i&&(s=i[1],c[s]?e=new c[s](r.slice(1)):f[s]&&(e=f[s](r.slice(1))),e&&i[2]&&e[i[2]]()));break;case"number":e=new I(r);break;case"boolean":e=new O(r);break;case"function":e=new E(r);break;case"object":if(null!==s){if(s instanceof T)return s;if(s.context instanceof T)return s.context;w(s)?e=new D(r):_(s)&&(e=new R(r))}}e===t&&(e=new M(r.slice(1)),console.warn('T("'+s+'") is not defined.'));var o=e._;return o.originkey=s,o.meta=b(e),o.emit("init"),e},b=function(t){for(var e,n,i=t._.meta,r=t;null!==r&&r.constructor!==Object;){e=Object.getOwnPropertyNames(r);for(var s=0,o=e.length;o>s;++s)i[e[s]]||(/^(constructor$|process$|_)/.test(e[s])?i[e[s]]="ignore":(n=Object.getOwnPropertyDescriptor(r,e[s]),"function"==typeof n.value?i[e[s]]="function":(n.get||n.set)&&(i[e[s]]="property")));r=Object.getPrototypeOf(r)}return i};Object.defineProperties(e,{version:{value:u},envtype:{value:d},envmobile:{value:p},env:{get:function(){return h.impl.env}},samplerate:{get:function(){return h.samplerate}},channels:{get:function(){return h.channels}},cellsize:{get:function(){return h.cellsize}},currentTime:{get:function(){return h.currentTime}},isPlaying:{get:function(){return h.status===r}},isRecording:{get:function(){return h.status===o}},amp:{set:function(t){"number"==typeof t&&(h.amp=t)},get:function(){return h.amp}},bpm:{set:function(t){"number"==typeof t&&t>=5&&300>=t&&(g=t)},get:function(){return g}}}),e.bind=function(t,n){return h.bind(t,n),e},e.setup=function(t){return h.setup(t),e},e.play=function(){return h.play(),e},e.pause=function(){return h.pause(),e},e.reset=function(){return h.reset(),h.events.emit("reset"),e},e.on=e.addListener=function(t,n){return h.on(t,n),e},e.once=function(t,n){return h.once(t,n),e},e.off=e.removeListener=function(t,n){return h.off(t,n),e},e.removeAllListeners=function(t){return h.removeAllListeners(t),e},e.listeners=function(t){return h.listeners(t)},e.rec=function(){return h.rec.apply(h,arguments)},e.timevalue=function(){var t=function(t){var e,n=g;return(e=/^bpm(\d+(?:\.\d+)?)/i.exec(t))&&(n=Math.max(5,Math.min(300,+(e[1]||0)))),n};return function(n){var i,r,s;if(i=/^(\d+(?:\.\d+)?)Hz$/i.exec(n))return 0===+i[1]?0:1e3/+i[1];if(i=/L(\d+)?(\.*)$/i.exec(n))return r=60/t(n)*(4/(i[1]||4))*1e3,r*=[1,1.5,1.75,1.875][(i[2]||"").length]||1;if(i=/^(\d+(?:\.\d+)?|\.(?:\d+))(min|sec|m)s?$/i.exec(n))switch(i[2]){case"min":return 60*+(i[1]||0)*1e3;case"sec":return 1e3*+(i[1]||0);case"m":return+(i[1]||0)}return(i=/^(?:([0-5]?[0-9]):)?(?:([0-5]?[0-9]):)(?:([0-5]?[0-9]))(?:\.([0-9]{1,3}))?$/.exec(n))?(s=3600*(i[1]||0)+60*(i[2]||0)+(i[3]||0),s=1e3*s+(0|((i[4]||"")+"00").substr(0,3))):(i=/(\d+)\.(\d+)\.(\d+)$/i.exec(n))?(s=480*(4*i[1]+ +i[2])+ +i[3],60/t(n)*(s/480)*1e3):(i=/(\d+)ticks$/i.exec(n))?60/t(n)*(i[1]/480)*1e3:(i=/^(\d+)samples(?:\/(\d+)Hz)?$/i.exec(n))?1e3*i[1]/(i[2]||e.samplerate):0}}();var y=e.fn={SignalArray:Float32Array,currentTimeIncr:0,emptycell:null,FINISHED_STATE:i,PLAYING_STATE:r,UNSCHEDULED_STATE:s,SCHEDULED_STATE:o},_=y.isArray=Array.isArray,w=y.isDictionary=function(t){return"object"==typeof t&&t.constructor===Object};y.nop=function(){return this},y.isSignalArray=function(t){return t instanceof y.SignalArray?!0:Array.isArray(t)&&t.__klass&&2===t.__klass.type?!0:!1},y.extend=function(t,e){function n(){this.constructor=t}e=e||T;for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},y.constructorof=function(t,e){for(var n=t&&t.prototype;n;){if(n===e.prototype)return!0;n=Object.getPrototypeOf(n)}return!1},y.register=function(t,e){y.constructorof(e,T)?c[t]=e:f[t]=e},y.alias=function(t,e){c[e]?c[t]=c[e]:f[e]&&(f[t]=f[e])},y.getClass=function(t){return c[t]},y.pointer=function(t,e,n){return e=t.byteOffset+e*t.constructor.BYTES_PER_ELEMENT,"number"==typeof n?new t.constructor(t.buffer,e,n):new t.constructor(t.buffer,e)},y.nextTick=function(t){return h.nextTick(t),e},y.fixAR=function(t){t._.ar=!0,t._.aronly=!0},y.fixKR=function(t){t._.ar=!1,t._.kronly=!0},y.changeWithValue=function(){var t=this._,e=t.value*t.mul+t.add;isNaN(e)&&(e=0);for(var n=this.cells[0],i=0,r=n.length;r>i;++i)n[i]=e},y.changeWithValue.unremovable=!0,y.clone=function(t){var e=new t.constructor([]);return e._.ar=t._.ar,e._.mul=t._.mul,e._.add=t._.add,e._.bypassed=t._.bypassed,e},y.timer=function(){var t=function(t){return function(){-1===h.timers.indexOf(t)&&(h.timers.push(t),h.events.emit("addObject"),t._.emit("start"),y.buddies_start(t))}},e=function(t){return function(){var e=h.timers.indexOf(t);-1!==e&&(h.timers.splice(e,1),t._.emit("stop"),h.events.emit("removeObject"),y.buddies_stop(t))}};return function(n){var i=t(n),r=e(n);return n.nodeType=T.TIMER,n.start=function(){return h.nextTick(i),n},n.stop=function(){return h.nextTick(r),n},n}}(),y.listener=function(){var t=function(t){return function(){-1===h.listeners.indexOf(t)&&(h.listeners.push(t),h.events.emit("addObject"),t._.emit("listen"),y.buddies_start(t))}},e=function(t){return function(){var e=h.listeners.indexOf(t);-1!==e&&(h.listeners.splice(e,1),t._.emit("unlisten"),h.events.emit("removeObject"),y.buddies_stop(t))}};return function(n){var i=t(n),r=e(n);return n.nodeType=T.LISTENER,n.listen=function(){return arguments.length&&n.append.apply(n,arguments),n.nodes.length&&h.nextTick(i),n},n.unlisten=function(){return arguments.length&&n.remove.apply(n,arguments),n.nodes.length||h.nextTick(r),n},n}}(),y.make_onended=function(t,e){return function(){if(t.playbackState=i,"number"==typeof e)for(var n=t.cells[0],r=t.cells[1],s=t.cells[2],o=0,a=r.length;a>o;++o)n[0]=r[o]=s[o]=e;t._.emit("ended")}},y.inputSignalAR=function(t){var e,n,i,s,o,a,l=t.cells[0],u=t.cells[1],h=t.cells[2],c=t.nodes,f=c.length,d=l.length,p=t.tickID;if(2===t.numChannels){if(i=!0,0!==f){for(e=0;f>e;++e)if(c[e].playbackState===r){c[e].process(p),u.set(c[e].cells[1]),h.set(c[e].cells[2]),i=!1,++e;break}for(;f>e;++e)if(c[e].playbackState===r)for(c[e].process(p),o=c[e].cells[1],a=c[e].cells[2],n=d;n;)n-=8,u[n]+=o[n],h[n]+=a[n],u[n+1]+=o[n+1],h[n+1]+=a[n+1],u[n+2]+=o[n+2],h[n+2]+=a[n+2],u[n+3]+=o[n+3],h[n+3]+=a[n+3],u[n+4]+=o[n+4],h[n+4]+=a[n+4],u[n+5]+=o[n+5],h[n+5]+=a[n+5],u[n+6]+=o[n+6],h[n+6]+=a[n+6],u[n+7]+=o[n+7],h[n+7]+=a[n+7]}i&&(u.set(y.emptycell),h.set(y.emptycell))}else{if(i=!0,0!==f){for(e=0;f>e;++e)if(c[e].playbackState===r){c[e].process(p),l.set(c[e].cells[0]),i=!1,++e;break}for(;f>e;++e)if(c[e].playbackState===r)for(s=c[e].process(p).cells[0],n=d;n;)n-=8,l[n]+=s[n],l[n+1]+=s[n+1],l[n+2]+=s[n+2],l[n+3]+=s[n+3],l[n+4]+=s[n+4],l[n+5]+=s[n+5],l[n+6]+=s[n+6],l[n+7]+=s[n+7]}i&&l.set(y.emptycell)}},y.inputSignalKR=function(t){var e,n=t.nodes,i=n.length,s=t.tickID,o=0;for(e=0;i>e;++e)n[e].playbackState===r&&(o+=n[e].process(s).cells[0][0]);
return o},y.outputSignalAR=function(t){var e,n=t.cells[0],i=t.cells[1],r=t.cells[2],s=t._.mul,o=t._.add;if(2===t.numChannels)for(e=n.length;e;)e-=8,i[e]=i[e]*s+o,r[e]=r[e]*s+o,i[e+1]=i[e+1]*s+o,r[e+1]=r[e+1]*s+o,i[e+2]=i[e+2]*s+o,r[e+2]=r[e+2]*s+o,i[e+3]=i[e+3]*s+o,r[e+3]=r[e+3]*s+o,i[e+4]=i[e+4]*s+o,r[e+4]=r[e+4]*s+o,i[e+5]=i[e+5]*s+o,r[e+5]=r[e+5]*s+o,i[e+6]=i[e+6]*s+o,r[e+6]=r[e+6]*s+o,i[e+7]=i[e+7]*s+o,r[e+7]=r[e+7]*s+o,n[e]=.5*(i[e]+r[e]),n[e+1]=.5*(i[e+1]+r[e+1]),n[e+2]=.5*(i[e+2]+r[e+2]),n[e+3]=.5*(i[e+3]+r[e+3]),n[e+4]=.5*(i[e+4]+r[e+4]),n[e+5]=.5*(i[e+5]+r[e+5]),n[e+6]=.5*(i[e+6]+r[e+6]),n[e+7]=.5*(i[e+7]+r[e+7]);else if(1!==s||0!==o)for(e=n.length;e;)e-=8,n[e]=n[e]*s+o,n[e+1]=n[e+1]*s+o,n[e+2]=n[e+2]*s+o,n[e+3]=n[e+3]*s+o,n[e+4]=n[e+4]*s+o,n[e+5]=n[e+5]*s+o,n[e+6]=n[e+6]*s+o,n[e+7]=n[e+7]*s+o},y.outputSignalKR=function(t){var e,n=t.cells[0],i=t.cells[1],r=t.cells[2],s=t._.mul,o=t._.add,a=n[0]*s+o;if(2===t.numChannels)for(e=n.length;e;)e-=8,n[e]=n[e+1]=n[e+2]=n[e+3]=n[e+4]=n[e+5]=n[e+6]=n[e+7]=i[e]=i[e+1]=i[e+2]=i[e+3]=i[e+4]=i[e+5]=i[e+6]=i[e+7]=r[e]=r[e+1]=r[e+2]=r[e+3]=r[e+4]=r[e+5]=r[e+6]=r[e+7]=a;else for(e=n.length;e;)e-=8,n[e]=n[e+1]=n[e+2]=n[e+3]=n[e+4]=n[e+5]=n[e+6]=n[e+7]=a},y.buddies_start=function(t){var e,n,i,r=t._.buddies;for(n=0,i=r.length;i>n;++n)switch(e=r[n],e.nodeType){case T.DSP:e.play();break;case T.TIMER:e.start();break;case T.LISTENER:e.listen()}},y.buddies_stop=function(t){var e,n,i,r=t._.buddies;for(n=0,i=r.length;i>n;++n)switch(e=r[n],e.nodeType){case T.DSP:e.pause();break;case T.TIMER:e.stop();break;case T.LISTENER:e.unlisten()}},y.fix_iOS6_1_problem=function(t){h.fix_iOS6_1_problem(t)};var x,A=e.modules={},k=A.EventEmitter=function(){function t(t){this.context=t,this.events={}}var e=t.prototype;return e.emit=function(t){var e=this.events[t];if(!e)return!1;var i;if("function"==typeof e){switch(arguments.length){case 1:e.call(this.context);break;case 2:e.call(this.context,arguments[1]);break;case 3:e.call(this.context,arguments[1],arguments[2]);break;default:i=n.call(arguments,1),e.apply(this.context,i)}return!0}if(_(e)){i=n.call(arguments,1);for(var r=e.slice(),s=0,o=r.length;o>s;++s)r[s]instanceof T?r[s].bang.apply(r[s],i):r[s].apply(this.context,i);return!0}return e instanceof T?(i=n.call(arguments,1),void e.bang.apply(e,i)):!1},e.on=function(t,e){if("function"!=typeof e&&!(e instanceof T))throw new Error("addListener takes instances of Function or timbre.Object");var n=this.events;return n[t]?_(n[t])?n[t].push(e):n[t]=[n[t],e]:n[t]=e,this},e.once=function(t,e){var n,i=this;if("function"==typeof e)n=function(){i.off(t,n),e.apply(i.context,arguments)};else{if(!(e instanceof T))throw new Error("once takes instances of Function or timbre.Object");n=function(){i.off(t,n),e.bang.apply(e,arguments)}}return n.listener=e,i.on(t,n),this},e.off=function(t,e){if("function"!=typeof e&&!(e instanceof T))throw new Error("removeListener takes instances of Function or timbre.Object");var n=this.events;if(!n[t])return this;var i=n[t];if(_(i)){for(var r=-1,s=0,o=i.length;o>s;++s)if(i[s]===e||i[s].listener&&i[s].listener===e){r=s;break}if(0>r)return this;i.splice(r,1),0===i.length&&(n[t]=null)}else(i===e||i.listener&&i.listener===e)&&(n[t]=null);return this},e.removeAllListeners=function(t){var e=this.events,n=!1,i=e[t];if(_(i))for(var r=i.length;r--;){var s=i[r];s.unremovable?n=!0:this.off(t,s)}else i&&(i.unremovable?n=!0:this.off(t,i));return n||(e[t]=null),this},e.listeners=function(t){var e,n=this.events;if(!n[t])return[];if(n=n[t],!_(n))return n.unremovable?[]:[n];n=n.slice(),e=[];for(var i=0,r=n.length;r>i;++i)n[i].unremovable||e.push(n[i]);return e},t}(),S=A.Deferred=function(){function t(t){this.context=t||this,this._state="pending",this._doneList=[],this._failList=[],this._promise=new e(this)}function e(t){this.context=t.context,this.then=t.then,this.done=function(){return t.done.apply(t,arguments),this},this.fail=function(){return t.fail.apply(t,arguments),this},this.pipe=function(){return t.pipe.apply(t,arguments)},this.always=function(){return t.always.apply(t,arguments),this},this.promise=function(){return this},this.isResolved=function(){return t.isResolved()},this.isRejected=function(){return t.isRejected()}}var i=t.prototype,r=function(t,e,n,i){if("pending"===this._state){this._state=t;for(var r=0,s=e.length;s>r;++r)e[r].apply(n,i);this._doneList=this._failList=null}},s=function(t){return t&&"function"==typeof t.promise};return i.resolve=function(){var t=n.call(arguments,0);return r.call(this,"resolved",this._doneList,this.context||this,t),this},i.resolveWith=function(t){var e=n.call(arguments,1);return r.call(this,"resolved",this._doneList,t,e),this},i.reject=function(){var t=n.call(arguments,0);return r.call(this,"rejected",this._failList,this.context||this,t),this},i.rejectWith=function(t){var e=n.call(arguments,1);return r.call(this,"rejected",this._failList,t,e),this},i.promise=function(){return this._promise},i.done=function(){for(var t=n.call(arguments),e="resolved"===this._state,i="pending"===this._state,r=this._doneList,s=0,o=t.length;o>s;++s)"function"==typeof t[s]&&(e?t[s]():i&&r.push(t[s]));return this},i.fail=function(){for(var t=n.call(arguments),e="rejected"===this._state,i="pending"===this._state,r=this._failList,s=0,o=t.length;o>s;++s)"function"==typeof t[s]&&(e?t[s]():i&&r.push(t[s]));return this},i.always=function(){return this.done.apply(this,arguments),this.fail.apply(this,arguments),this},i.then=function(t,e){return this.done(t).fail(e)},i.pipe=function(e,i){var r=this,o=new t(this.context);return this.done(function(){var t=e.apply(r.context,arguments);s(t)?t.then(function(){var e=n.call(arguments);o.resolveWith.apply(o,[t].concat(e))}):o.resolveWith(r,t)}),this.fail(function(){if("function"==typeof i){var t=i.apply(r.context,arguments);s(t)&&t.fail(function(){var e=n.call(arguments);o.rejectWith.apply(o,[t].concat(e))})}else o.reject.apply(o,arguments)}),o.promise()},i.isResolved=function(){return"resolved"===this._state},i.isRejected=function(){return"rejected"===this._state},i.state=function(){return this._state},t.when=function(e){var i=0,r=n.call(arguments),o=r.length,a=o;1!==o||s(e)||(a=0);var l=1===a?e:new t,u=function(t,e){return function(i){e[t]=arguments.length>1?n.call(arguments):i,--a||l.resolve.apply(l,e)}};if(o>1)for(var h=new Array(o),c=function(){l.reject()};o>i;++i)r[i]&&s(r[i])?r[i].promise().done(u(i,h)).fail(c):(h[i]=r[i],--a);return a||l.resolve.apply(l,r),l.promise()},t}(),T=e.Object=function(){function i(t,n){this._={};var s=this._.events=new k(this);if(this._.emit=function(){return s.emit.apply(s,arguments)},w(n[0])){var o=n.shift(),a=o["in"];this.once("init",function(){this.set(o),a&&(_(a)?this.append.apply(this,a):a instanceof i&&this.append(a))})}switch(this.tickID=-1,this.nodes=n.map(e),this.cells=[],this.numChannels=t,t){case 0:this.L=this.R=new C(null),this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 1:this.L=this.R=new C(this),this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 2:this.L=new C(this),this.R=new C(this),this.cells[0]=new y.SignalArray(h.cellsize),this.cells[1]=this.L.cell,this.cells[2]=this.R.cell}this.playbackState=r,this.nodeType=i.DSP,this._.ar=!0,this._.mul=1,this._.add=0,this._.dac=null,this._.bypassed=!1,this._.meta={},this._.samplerate=h.samplerate,this._.cellsize=h.cellsize,this._.buddies=[]}i.DSP=1,i.TIMER=2,i.LISTENER=3;var s=i.prototype;return Object.defineProperties(s,{isAr:{get:function(){return this._.ar}},isKr:{get:function(){return!this._.ar}},isBypassed:{get:function(){return this._.bypassed}},isEnded:{get:function(){return!(1&this.playbackState)}},mul:{set:function(t){"number"==typeof t&&(this._.mul=t,this._.emit("setMul",t))},get:function(){return this._.mul}},add:{set:function(t){"number"==typeof t&&(this._.add=t,this._.emit("setAdd",t))},get:function(){return this._.add}},buddies:{set:function(t){_(t)||(t=[t]),this._.buddies=t.filter(function(t){return t instanceof i})},get:function(){return this._.buddies}}}),s.toString=function(){return this.constructor.name},s.valueOf=function(){return h.tickID!==this.tickID&&this.process(h.tickID),this.cells[0][0]},s.append=function(){if(arguments.length>0){var t=n.call(arguments).map(e);this.nodes=this.nodes.concat(t),this._.emit("append",t)}return this},s.appendTo=function(t){return t.append(this),this},s.remove=function(){if(arguments.length>0){for(var t,e=this.nodes,n=[],i=0,r=arguments.length;r>i;++i)-1!==(t=e.indexOf(arguments[i]))&&(n.push(e[t]),e.splice(t,1));n.length>0&&this._.emit("remove",n)}return this},s.removeFrom=function(t){return t.remove(this),this},s.removeAll=function(){var t=this.nodes.slice();return this.nodes=[],t.length>0&&this._.emit("remove",t),this},s.removeAtIndex=function(t){var e=this.nodes[t];return e&&(this.nodes.splice(t,1),this._.emit("remove",[e])),this},s.postMessage=function(t){return this._.emit("message",t),this},s.to=function(t){if(t instanceof i)t.append(this);else{var e=n.call(arguments);w(e[1])?e.splice(2,0,this):e.splice(1,0,this),t=v.apply(null,e)}return t},s.splice=function(t,e,n){var r;return e?e instanceof i&&(r=e.nodes.indexOf(n),-1!==r&&e.nodes.splice(r,1),t instanceof i?(t.nodes.push(this),e.nodes.push(t)):e.nodes.push(this)):this._.dac&&(t instanceof i?n instanceof i?n._.dac&&(n._.dac._.node=t,t._.dac=n._.dac,n._.dac=null,t.nodes.push(this)):this._.dac&&(this._.dac._.node=t,t._.dac=this._.dac,this._.dac=null,t.nodes.push(this)):n instanceof i&&n._.dac&&(n._.dac._.node=this,this._.dac=n._.dac,n._.dac=null)),this},s.on=s.addListener=function(t,e){return this._.events.on(t,e),this},s.once=function(t,e){return this._.events.once(t,e),this},s.off=s.removeListener=function(t,e){return this._.events.off(t,e),this},s.removeAllListeners=function(t){return this._.events.removeAllListeners(t),this},s.listeners=function(t){return this._.events.listeners(t)},s.set=function(t,e){var n,i,r=this._.meta;switch(typeof t){case"string":switch(r[t]){case"property":this[t]=e;break;case"function":this[t](e);break;default:for(n=this;null!==n;)i=Object.getOwnPropertyDescriptor(n,t),i&&("function"==typeof i.value?(r[t]="function",this[t](e)):(i.get||i.set)&&(r[t]="property",this[t]=e)),n=Object.getPrototypeOf(n)}break;case"object":for(n in t)this.set(n,t[n])}return this},s.get=function(t){return"property"===this._.meta[t]?this[t]:void 0},s.bang=function(){return this._.emit.apply(this,["bang"].concat(n.call(arguments))),this},s.process=y.nop,s.bypass=function(){return this._.bypassed=0===arguments.length?!0:!!arguments[0],this},s.play=function(){var t=this._.dac;return null===t&&(t=this._.dac=new L(this)),t.play()&&this._.emit.apply(this,["play"].concat(n.call(arguments))),y.buddies_start(this),this},s.pause=function(){var t=this._.dac;return t&&t.playbackState===r&&(t.pause(),this._.dac=null,this._.emit("pause")),y.buddies_stop(this),this},s.start=s.stop=s.listen=s.unlisten=function(){return this},s.ar=function(){return(0===arguments.length?0:!arguments[0])?this.kr(!0):this._.kronly||(this._.ar=!0,this._.emit("ar",!0)),this},s.kr=function(){return(0===arguments.length?0:!arguments[0])?this.ar(!0):this._.aronly||(this._.ar=!1,this._.emit("ar",!1)),this},s.plot="browser"===d?function(e){var n=this._,i=e.target;if(!i)return this;var r,s=e.width||i.width||320,o=e.height||i.height||240,a=(e.x||0)+.5,l=e.y||0,u=i.getContext("2d");r=e.foreground!==t?e.foreground:n.plotForeground||"rgb(  0, 128, 255)";var h;h=e.background!==t?e.background:n.plotBackground||"rgb(255, 255, 255)";var c,f,d,p,m,g=e.lineWidth||n.plotLineWidth||1,v=!!n.plotCyclic,b=n.plotData||this.cells[0],y=e.range||n.plotRange||[-1.2,1.2],_=y[0],w=o/(y[1]-_),x=s/b.length,A=b.length;if(u.save(),u.rect(a,l,s,o),null!==h&&(u.fillStyle=h,u.fillRect(a,l,s,o)),n.plotBefore&&n.plotBefore.call(this,u,a,l,s,o),n.plotBarStyle)for(u.fillStyle=r,c=0,m=0;A>m;++m)d=(b[m]-_)*w,f=o-d,u.fillRect(c+a,f+l,x,d),c+=x;else{for(u.strokeStyle=r,u.lineWidth=g,u.beginPath(),c=0,p=o-(b[0]-_)*w,u.moveTo(c+a,p+l),m=1;A>m;++m)c+=x,f=o-(b[m]-_)*w,u.lineTo(c+a,f+l);v?u.lineTo(c+x+a,p+l):u.lineTo(c+x+a,f+l),u.stroke()}n.plotAfter&&n.plotAfter.call(this,u,a,l,s,o);var k=e.border||n.plotBorder;return k&&(u.strokeStyle="string"==typeof k?k:"#000",u.lineWidth=1,u.strokeRect(a,l,s,o)),u.restore(),this}:y.nop,i}(),C=e.ChannelObject=function(){function t(t){e.Object.call(this,-1,[]),y.fixAR(this),this._.parent=t,this.cell=new y.SignalArray(h.cellsize),this.L=this.R=this,this.cells[0]=this.cells[1]=this.cells[2]=this.cell,this.numChannels=1}return y.extend(t),t.prototype.process=function(t){return this.tickID!==t&&(this.tickID=t,this._.parent&&this._.parent.process(t)),this},t}(),M=function(){function t(t){T.call(this,2,t)}return y.extend(t),t.prototype.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,e.ar?(y.inputSignalAR(this),y.outputSignalAR(this)):(this.cells[0][0]=y.inputSignalKR(this),y.outputSignalKR(this))),this},y.register("+",t),t}(),I=function(){function t(t){if(T.call(this,1,[]),y.fixKR(this),this.value=t[0],w(t[1])){var e=t[1];this.once("init",function(){this.set(e)})}this.on("setAdd",y.changeWithValue),this.on("setMul",y.changeWithValue)}y.extend(t);var e=t.prototype;return Object.defineProperties(e,{value:{set:function(t){"number"==typeof t&&(this._.value=isNaN(t)?0:t,y.changeWithValue.call(this))},get:function(){return this._.value}}}),t}(),O=function(){function t(t){if(T.call(this,1,[]),y.fixKR(this),this.value=t[0],w(t[1])){var e=t[1];this.once("init",function(){this.set(e)})}this.on("setAdd",y.changeWithValue),this.on("setMul",y.changeWithValue)}y.extend(t);var e=t.prototype;return Object.defineProperties(e,{value:{set:function(t){this._.value=t?1:0,y.changeWithValue.call(this)},get:function(){return!!this._.value}}}),t}(),E=function(){function t(t){if(T.call(this,1,[]),y.fixKR(this),this.func=t[0],this._.value=0,w(t[1])){var e=t[1];this.once("init",function(){this.set(e)})}this.on("setAdd",y.changeWithValue),this.on("setMul",y.changeWithValue)}y.extend(t);var e=t.prototype;return Object.defineProperties(e,{func:{set:function(t){"function"==typeof t&&(this._.func=t)},get:function(){return this._.func}},args:{set:function(t){this._.args=_(t)?t:[t]},get:function(){return this._.args}}}),e.bang=function(){var t=this._,e=n.call(arguments).concat(t.args),i=t.func.apply(this,e);return"number"==typeof i&&(t.value=i,y.changeWithValue.call(this)),this._.emit("bang"),this},t}(),R=function(){function t(t){T.call(this,1,[]);var e,n;for(e=0,n=t[0].length;n>e;++e)this.append(t[0][e]);if(w(t[1])){var i=t[1];this.once("init",function(){this.set(i)})}}y.extend(t);var e=t.prototype;return Object.defineProperties(e,{}),e.bang=function(){var t,e,i=["bang"].concat(n.call(arguments)),r=this.nodes;for(t=0,e=r.length;e>t;++t)r[t].bang.apply(r[t],i);return this},e.postMessage=function(t){var e,n,i=this.nodes;for(e=0,n=i.length;n>e;++e)i[e].postMessage(t);return this},e.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,e.ar?(y.inputSignalAR(this),y.outputSignalAR(this)):(this.cells[0][0]=y.inputSignalKR(this),y.outputSignalKR(this))),this},t}(),D=function(){function t(t){if(T.call(this,1,[]),y.fixKR(this),w(t[1])){var e=t[1];this.once("init",function(){this.set(e)})}}y.extend(t);var e=t.prototype;return Object.defineProperties(e,{}),t}(),L=function(){function t(t){T.call(this,2,[]),this.playbackState=i;var r=this._;r.node=t,r.onplay=e(this),r.onpause=n(this)}y.extend(t);var e=function(t){return function(){-1===h.inlets.indexOf(t)&&(h.inlets.push(t),h.events.emit("addObject"),t.playbackState=r,t._.emit("play"))}},n=function(t){return function(){var e=h.inlets.indexOf(t);-1!==e&&(h.inlets.splice(e,1),t.playbackState=i,t._.emit("pause"),h.events.emit("removeObject"))}},s=t.prototype;return s.play=function(){return h.nextTick(this._.onplay),-1===h.inlets.indexOf(this)},s.pause=function(){h.nextTick(this._.onpause)},s.process=function(t){var e=this._.node;1&e.playbackState?(e.process(t),this.cells[1].set(e.cells[1]),this.cells[2].set(e.cells[2])):(this.cells[1].set(y.emptycell),this.cells[2].set(y.emptycell))},t}(),P=function(){function t(){this.context=this,this.tickID=0,this.impl=null,this.amp=.8,this.status=i,this.samplerate=44100,this.channels=2,this.cellsize=64,this.streammsec=20,this.streamsize=0,this.currentTime=0,this.nextTicks=[],this.inlets=[],this.timers=[],this.listeners=[],this.deferred=null,this.recStart=0,this.recBuffers=null,this.delayProcess=e(this),this.events=null,y.currentTimeIncr=1e3*this.cellsize/this.samplerate,y.emptycell=new y.SignalArray(this.cellsize),this.reset(!0)}var e=function(t){return function(){t.recStart=Date.now(),t.process()}},s=t.prototype;s.bind=function(t,e){if("function"==typeof t){var n=new t(this,e);this.impl=n,this.impl.defaultSamplerate&&(this.samplerate=this.impl.defaultSamplerate)}return this},s.setup=function(t){return"object"==typeof t&&(-1!==a.indexOf(t.samplerate)&&(this.samplerate=t.samplerate<=this.impl.maxSamplerate?t.samplerate:this.impl.maxSamplerate),-1!==l.indexOf(t.cellsize)&&(this.cellsize=t.cellsize),"undefined"!=typeof Float64Array&&"undefined"!=typeof t.f64&&(m=!!t.f64,y.SignalArray=m?Float64Array:Float32Array)),y.currentTimeIncr=1e3*this.cellsize/this.samplerate,y.emptycell=new y.SignalArray(this.cellsize),this},s.getAdjustSamples=function(t){var e,n;return t=t||this.samplerate,e=this.streammsec/1e3*t,n=Math.ceil(Math.log(e)*Math.LOG2E),n=8>n?8:n>14?14:n,1<<n},s.play=function(){return this.status===i&&(this.status=r,this.streamsize=this.getAdjustSamples(),this.strmL=new y.SignalArray(this.streamsize),this.strmR=new y.SignalArray(this.streamsize),this.impl.play(),this.events.emit("play")),this},s.pause=function(){return this.status===r&&(this.status=i,this.impl.pause(),this.events.emit("pause")),this},s.reset=function(t){return t&&(this.events=new k(this).on("addObject",function(){this.status===i&&this.play()}).on("removeObject",function(){this.status===r&&this.inlets.length+this.timers.length+this.listeners.length===0&&this.pause()})),this.currentTime=0,this.nextTicks=[],this.inlets=[],this.timers=[],this.listeners=[],this},s.process=function(){var t,e,n,i,r,s,a,l,u=this.tickID,h=this.strmL,c=this.strmR,f=this.amp,d=this.streamsize,p=0,m=this.cellsize,g=this.streamsize/this.cellsize,v=this.timers,b=this.inlets,_=this.listeners,w=y.currentTimeIncr;for(i=0;d>i;++i)h[i]=c[i]=0;for(;g--;){for(++u,r=0,s=v.length;s>r;++r)1&v[r].playbackState&&v[r].process(u);for(r=0,s=b.length;s>r;++r)if(t=b[r],t.process(u),1&t.playbackState)for(e=t.cells[1],n=t.cells[2],a=0,i=p;m>a;++a,++i)h[i]+=e[a],c[i]+=n[a];for(p+=m,r=0,s=_.length;s>r;++r)1&_[r].playbackState&&_[r].process(u);for(this.currentTime+=w,l=this.nextTicks.splice(0),r=0,s=l.length;s>r;++r)l[r]()}for(i=0;d>i;++i)t=h[i]*f,-1>t?t=-1:t>1&&(t=1),h[i]=t,t=c[i]*f,-1>t?t=-1:t>1&&(t=1),c[i]=t;this.tickID=u;var x=this.currentTime;if(this.status===o){if(2===this.recCh)this.recBuffers.push(new y.SignalArray(h)),this.recBuffers.push(new y.SignalArray(c));else{var A=new y.SignalArray(h.length);for(i=0,d=A.length;d>i;++i)A[i]=.5*(h[i]+c[i]);this.recBuffers.push(A)}if(x>=this.maxDuration)this.deferred.sub.reject();else if(x>=this.recDuration)this.deferred.sub.resolve();else{var k=Date.now();k-this.recStart>20?setTimeout(this.delayProcess,10):this.process()}}},s.nextTick=function(t){this.status===i?t():this.nextTicks.push(t)},s.rec=function(){y.fix_iOS6_1_problem(!0);var t=new S(this);if(this.deferred)return console.warn("rec deferred is exists??"),t.reject().promise();if(this.status!==i)return console.log("status is not none",this.status),t.reject().promise();var e=0,r=arguments,s=w(r[e])?r[e++]:{},a=r[e];if("function"!=typeof a)return console.warn("no function"),t.reject().promise();this.deferred=t,this.status=o,this.reset();var l=new v("+"),h=new S(this),c={done:function(){h.resolve.apply(h,n.call(arguments))},send:function(){l.append.apply(l,arguments)}},f=this;return h.then(u,function(){y.fix_iOS6_1_problem(!1),u.call(f,!0)}),this.deferred.sub=h,this.savedSamplerate=this.samplerate,this.samplerate=s.samplerate||this.samplerate,this.recDuration=s.recDuration||1/0,this.maxDuration=s.maxDuration||6e5,this.recCh=s.ch||1,2!==this.recCh&&(this.recCh=1),this.recBuffers=[],this.streamsize=this.getAdjustSamples(),this.strmL=new y.SignalArray(this.streamsize),this.strmR=new y.SignalArray(this.streamsize),this.inlets.push(l),a(c),setTimeout(this.delayProcess,10),t.promise()};var u=function(){this.status=i,this.reset();var t,e=this.recBuffers,n=this.samplerate,r=this.streamsize;this.samplerate=this.savedSamplerate,t=1/0!==this.recDuration?this.recDuration*n*.001|0:(e.length>>this.recCh-1)*r;var s,o,a=t/r|0,l=0,u=0,h=t;if(2===this.recCh){var c=new y.SignalArray(t),f=new y.SignalArray(t),d=new y.SignalArray(t);for(o=0;a>o;++o)if(c.set(e[l++],u),f.set(e[l++],u),u+=r,h-=r,h>0&&r>h){c.set(e[l++].subarray(0,h),u),f.set(e[l++].subarray(0,h),u);break}for(o=0,a=t;a>o;++o)d[o]=.5*(c[o]+f[o]);s={samplerate:n,channels:2,buffer:[d,c,f]}}else{var p=new y.SignalArray(t);for(o=0;a>o;++o)if(p.set(e[l++],u),u+=r,h-=r,h>0&&r>h){p.set(e[l++].subarray(0,h),u);break}s={samplerate:n,channels:1,buffer:[p]}}var m=[].concat.apply([s],arguments);this.deferred.resolve.apply(this.deferred,m),this.deferred=null};return s.on=function(t,e){this.events.on(t,e)},s.once=function(t,e){this.events.once(t,e)},s.off=function(t,e){this.events.off(t,e)},s.removeAllListeners=function(t){this.events.removeListeners(t)},s.listeners=function(t){return this.events.listeners(t)},s.fix_iOS6_1_problem=function(t){this.impl.fix_iOS6_1_problem&&this.impl.fix_iOS6_1_problem(t)},t}(),j=null;"undefined"!=typeof window&&(x=window.AudioContext||window.webkitAudioContext),j="undefined"!=typeof x?function(t){var e,n,i=new x;y._audioContext=i,this.maxSamplerate=i.sampleRate,this.defaultSamplerate=i.sampleRate,this.env="webkit";var r=navigator.userAgent;if(r.match(/linux/i)?t.streammsec*=8:r.match(/win(dows)?\s*(nt 5\.1|xp)/i)&&(t.streammsec*=4),this.play=function(){var r,s,o,a=t.getAdjustSamples(i.sampleRate),l=t.streamsize;t.samplerate===i.sampleRate?r=function(e){var n=e.outputBuffer;t.process(),n.getChannelData(0).set(t.strmL),n.getChannelData(1).set(t.strmR)}:2*t.samplerate===i.sampleRate?r=function(e){var n,i,r=t.strmL,s=t.strmR,o=e.outputBuffer,a=o.getChannelData(0),l=o.getChannelData(1),u=o.length;for(t.process(),n=i=0;u>n;n+=2,++i)a[n]=a[n+1]=r[i],l[n]=l[n+1]=s[i]}:(s=l,o=t.samplerate/i.sampleRate,r=function(e){var n,i=t.strmL,r=t.strmR,a=e.outputBuffer,u=a.getChannelData(0),h=a.getChannelData(1),c=a.length;for(n=0;c>n;++n)s>=l&&(t.process(),s-=l),u[n]=i[0|s],h[n]=r[0|s],s+=o}),e=i.createBufferSource(),n=i.createScriptProcessor(a,2,t.channels),n.onaudioprocess=r,e.noteOn&&e.noteOn(0),e.connect(n),n.connect(i.destination)},this.pause=function(){e.disconnect(),n.disconnect()},p){var s=0,o=i.createBufferSource();this.fix_iOS6_1_problem=function(t){s+=t?1:-1,1===s?(o.noteOn(0),o.connect(i.destination)):0===s&&o.disconnect()}}}:function(){this.maxSamplerate=48e3,this.defaultSamplerate=44100,this.env="nop",this.play=function(){},this.pause=function(){}},h=(new P).bind(j);var N=e;"node"===d||"undefined"!=typeof module&&module.exports?module.exports=global.timbre=N:"browser"===d&&(N.noConflict=function(){var t=window.timbre,e=window.T;return function(n){return window.T===N&&(window.T=e),n&&window.timbre===N&&(window.timbre=t),N}}(),window.timbre=window.T=N),function(){function t(t){try{return e.plugins&&e.mimeTypes&&e.mimeTypes.length?e.plugins["Shockwave Flash"].description.match(/([0-9]+)/)[t]:new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").match(/([0-9]+)/)[t]}catch(n){return-1}}if("nop"===h.impl.env&&"browser"===d&&!p){var e=navigator;if(!(t(0)<10)){var n,i="TimbreFlashPlayerDiv",r=function(){var t=document.getElementsByTagName("script");if(t&&t.length)for(var e,n=0,i=t.length;i>n;++n)if(e=/^(.*\/)timbre(?:\.dev)?\.js$/i.exec(t[n].src))return e[1]+"timbre.swf"}();window.timbrejs_flashfallback_init=function(){function t(t){var e=0;this.maxSamplerate=44100,this.defaultSamplerate=44100,this.env="flash",this.play=function(){var i,s=new Array(t.streamsize*t.channels),o=t.streammsec,a=0,l=t.streamsize/t.samplerate*1e3,u=Date.now();i=function(){if(!(a>Date.now()-u)){var e=t.strmL,i=t.strmR,r=s.length,o=e.length;for(t.process();o--;)s[--r]=32768*i[o]|0,s[--r]=32768*e[o]|0;n.writeAudio(s.join(" ")),a+=l}},n.setup?(n.setup(t.channels,t.samplerate),e=setInterval(i,o)):console.warn("Cannot find "+r)},this.pause=function(){0!==e&&(n.cancel(),clearInterval(e),e=0)}}h.bind(t),delete window.timbrejs_flashfallback_init};var s,o,a=r,l=a+"?"+ +new Date,u="TimbreFlashPlayer",c=document.createElement("div");c.id=i,c.style.display="inline",c.width=c.height=1,e.plugins&&e.mimeTypes&&e.mimeTypes.length?(s=document.createElement("object"),s.id=u,s.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",s.width=s.height=1,s.setAttribute("data",l),s.setAttribute("type","application/x-shockwave-flash"),o=document.createElement("param"),o.setAttribute("name","allowScriptAccess"),o.setAttribute("value","always"),s.appendChild(o),c.appendChild(s)):c.innerHTML='<object id="'+u+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1"><param name="movie" value="'+l+'" /><param name="bgcolor" value="#FFFFFF" /><param name="quality" value="high" /><param name="allowScriptAccess" value="always" /></object>',window.addEventListener("load",function(){document.body.appendChild(c),n=document[u]})}}}()}(),function(t){"use strict";function e(t){this.samplerate=t,this.frequency=340,this.Q=1,this.gain=0,this.x1L=this.x2L=this.y1L=this.y2L=0,this.x1R=this.x2R=this.y1R=this.y2R=0,this.b0=this.b1=this.b2=this.a1=this.a2=0,this.setType("lpf")}var n=e.prototype;n.process=function(t,e){var n,i,r,s,o,a,l=this.x1L,u=this.x2L,h=this.y1L,c=this.y2L,f=this.x1R,d=this.x2R,p=this.y1R,m=this.y2R,g=this.b0,v=this.b1,b=this.b2,y=this.a1,_=this.a2;for(o=0,a=t.length;a>o;++o)n=t[o],r=g*n+v*l+b*u-y*h-_*c,u=l,l=n,c=h,h=r,i=e[o],s=g*i+v*f+b*d-y*p-_*m,d=f,f=i,m=p,p=s,t[o]=r,e[o]=s;this.x1L=l,this.x2L=u,this.y1L=h,this.y2L=c,this.x1R=f,this.x2R=d,this.y1R=p,this.y2R=m},n.setType=function(t){var e;(e=i[t])&&(this.type=t,e.call(this,this.frequency,this.Q,this.gain))},n.setParams=function(t,e,n){this.frequency=t,this.Q=e,this.gain=n;var r=i[this.type];return r&&r.call(this,t,e,n),this};var i={lowpass:function(t,e){if(t/=.5*this.samplerate,t>=1)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=t)this.b0=this.b1=this.b2=this.a1=this.a2=0;else{e=0>e?0:e;var n=Math.pow(10,.05*e),i=Math.sqrt(.5*(4-Math.sqrt(16-16/(n*n)))),r=Math.PI*t,s=.5*i*Math.sin(r),o=.5*(1-s)/(1+s),a=(.5+o)*Math.cos(r),l=.25*(.5+o-a);this.b0=2*l,this.b1=4*l,this.b2=this.b0,this.a1=2*-a,this.a2=2*o}},highpass:function(t,e){if(t/=.5*this.samplerate,t>=1)this.b0=this.b1=this.b2=this.a1=this.a2=0;else if(0>=t)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{e=0>e?0:e;var n=Math.pow(10,.05*e),i=Math.sqrt((4-Math.sqrt(16-16/(n*n)))/2),r=Math.PI*t,s=.5*i*Math.sin(r),o=.5*(1-s)/(1+s),a=(.5+o)*Math.cos(r),l=.25*(.5+o+a);this.b0=2*l,this.b1=-4*l,this.b2=this.b0,this.a1=2*-a,this.a2=2*o}},bandpass:function(t,e){if(t/=.5*this.samplerate,t>0&&1>t)if(e>0){var n=Math.PI*t,i=Math.sin(n)/(2*e),r=Math.cos(n),s=1/(1+i);this.b0=i*s,this.b1=0,this.b2=-i*s,this.a1=-2*r*s,this.a2=(1-i)*s}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=this.b1=this.b2=this.a1=this.a2=0},lowshelf:function(t,e,n){t/=.5*this.samplerate;var i=Math.pow(10,n/40);if(t>=1)this.b0=i*i,this.b1=this.b2=this.a1=this.a2=0;else if(0>=t)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var r=Math.PI*t,s=1,o=.5*Math.sin(r)*Math.sqrt((i+1/i)*(1/s-1)+2),a=Math.cos(r),l=2*Math.sqrt(i)*o,u=i+1,h=i-1,c=1/(u+h*a+l);this.b0=i*(u-h*a+l)*c,this.b1=2*i*(h-u*a)*c,this.b2=i*(u-h*a-l)*c,this.a1=-2*(h+u*a)*c,this.a2=(u+h*a-l)*c}},highshelf:function(t,e,n){t/=.5*this.samplerate;var i=Math.pow(10,n/40);if(t>=1)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=t)this.b0=i*i,this.b1=this.b2=this.a1=this.a2=0;else{var r=Math.PI*t,s=1,o=.5*Math.sin(r)*Math.sqrt((i+1/i)*(1/s-1)+2),a=Math.cos(r),l=2*Math.sqrt(i)*o,u=i+1,h=i-1,c=1/(u-h*a+l);this.b0=i*(u+h*a+l)*c,this.b1=-2*i*(h+u*a)*c,this.b2=i*(u+h*a-l)*c,this.a1=2*(h-u*a)*c,this.a2=(u-h*a-l)*c}},peaking:function(t,e,n){if(t/=.5*this.samplerate,t>0&&1>t){var i=Math.pow(10,n/40);if(e>0){var r=Math.PI*t,s=Math.sin(r)/(2*e),o=Math.cos(r),a=1/(1+s/i);this.b0=(1+s*i)*a,this.b1=-2*o*a,this.b2=(1-s*i)*a,this.a1=this.b1,this.a2=(1-s/i)*a}else this.b0=i*i,this.b1=this.b2=this.a1=this.a2=0}else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},notch:function(t,e){if(t/=.5*this.samplerate,t>0&&1>t)if(e>0){var n=Math.PI*t,i=Math.sin(n)/(2*e),r=Math.cos(n),s=1/(1+i);this.b0=s,this.b1=-2*r*s,this.b2=s,this.a1=this.b1,this.a2=(1-i)*s}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},allpass:function(t,e){if(t/=.5*this.samplerate,t>0&&1>t)if(e>0){var n=Math.PI*t,i=Math.sin(n)/(2*e),r=Math.cos(n),s=1/(1+i);this.b0=(1-i)*s,this.b1=-2*r*s,this.b2=(1+i)*s,this.a1=this.b1,this.a2=this.b0}else this.b0=-1,this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0}};i.lpf=i.lowpass,i.hpf=i.highpass,i.bpf=i.bandpass,i.bef=i.notch,i.brf=i.notch,i.apf=i.allpass,t.modules.Biquad=e}(timbre),function(t){"use strict";function e(e){this.samplerate=e;var n=Math.round(Math.log(.1*e)*Math.LOG2E);this.buffersize=1<<n,this.bufferL=new t.fn.SignalArray(this.buffersize+1),this.bufferR=new t.fn.SignalArray(this.buffersize+1),this.wave=null,this._wave=null,this.writeIndex=this.buffersize>>1,this.readIndex=0,this.delayTime=20,this.rate=4,this.depth=20,this.feedback=.2,this.wet=.5,this.phase=0,this.phaseIncr=0,this.phaseStep=4,this.setWaveType("sin"),this.setDelayTime(this.delayTime),this.setRate(this.rate)}var n=e.prototype,i=[];i[0]=function(){for(var t=new Float32Array(512),e=0;512>e;++e)t[e]=Math.sin(2*Math.PI*(e/512));return t}(),i[1]=function(){for(var t,e=new Float32Array(512),n=0;512>n;++n)t=n/512-.25,e[n]=1-4*Math.abs(Math.round(t)-t);return e}(),n.setWaveType=function(t){"sin"===t?(this.wave=t,this._wave=i[0]):"tri"===t&&(this.wave=t,this._wave=i[1])},n.setDelayTime=function(t){this.delayTime=t;for(var e=this.writeIndex-(t*this.samplerate*.001|0);0>e;)e+=this.buffersize;this.readIndex=e},n.setRate=function(t){this.rate=t,this.phaseIncr=512*this.rate/this.samplerate*this.phaseStep},n.process=function(t,e){var n,i,r,s,o,a=this.bufferL,l=this.bufferR,u=this.buffersize,h=u-1,c=this._wave,f=this.phase,d=this.phaseIncr,p=this.writeIndex,m=this.readIndex,g=this.depth,v=this.feedback,b=this.wet,y=1-b,_=t.length,w=this.phaseStep;for(s=0;_>s;){for(r=c[0|f]*g,f+=d;f>512;)f-=512;for(o=0;w>o;++o,++s)i=m+u+r&h,n=.5*(a[i]+a[i+1]),a[p]=t[s]-n*v,t[s]=t[s]*y+n*b,n=.5*(l[i]+l[i+1]),l[p]=e[s]-n*v,e[s]=e[s]*y+n*b,p=p+1&h,m=m+1&h}this.phase=f,this.writeIndex=p,this.readIndex=m},t.modules.Chorus=e}(timbre),function(t){"use strict";function e(e,i){this.samplerate=e,this.channels=i,this.lastPreDelayFrames=0,this.preDelayReadIndex=0,this.preDelayWriteIndex=r,this.ratio=-1,this.slope=-1,this.linearThreshold=-1,this.dbThreshold=-1,this.dbKnee=-1,this.kneeThreshold=-1,this.kneeThresholdDb=-1,this.ykneeThresholdDb=-1,this.K=-1,this.attackTime=.003,this.releaseTime=.25,this.preDelayTime=.006,this.dbPostGain=0,this.effectBlend=1,this.releaseZone1=.09,this.releaseZone2=.16,this.releaseZone3=.42,this.releaseZone4=.98,this.detectorAverage=0,this.compressorGain=1,this.meteringGain=1,this.delayBufferL=new t.fn.SignalArray(n),this.delayBufferR=2===i?new t.fn.SignalArray(n):this.delayBufferL,this.preDelayTime=6,this.preDelayReadIndex=0,this.preDelayWriteIndex=r,this.maxAttackCompressionDiffDb=-1,this.meteringReleaseK=1-Math.exp(-1/(.325*this.samplerate)),this.setAttackTime(this.attackTime),this.setReleaseTime(this.releaseTime),this.setPreDelayTime(this.preDelayTime),this.setParams(-24,30,12)}var n=1024,i=n-1,r=256,s=5,o=e.prototype;o.clone=function(){var t=new e(this.samplerate,this.channels);
return t.setAttackTime(this.attackTime),t.setReleaseTime(this.releaseTime),t.setPreDelayTime(this.preDelayTime),t.setParams(this.dbThreshold,this.dbKnee,this.ratio),t},o.setAttackTime=function(t){this.attackTime=Math.max(.001,t),this._attackFrames=this.attackTime*this.samplerate},o.setReleaseTime=function(t){this.releaseTime=Math.max(.001,t);var e=this.releaseTime*this.samplerate,n=.0025;this._satReleaseFrames=n*this.samplerate;var i=e*this.releaseZone1,r=e*this.releaseZone2,s=e*this.releaseZone3,o=e*this.releaseZone4;this._kA=.9999999999999998*i+1.8432219684323923e-16*r-1.9373394351676423e-16*s+8.824516011816245e-18*o,this._kB=-1.5788320352845888*i+2.3305837032074286*r-.9141194204840429*s+.1623677525612032*o,this._kC=.5334142869106424*i-1.272736789213631*r+.9258856042207512*s-.18656310191776226*o,this._kD=.08783463138207234*i-.1694162967925622*r+.08588057951595272*s-.00429891410546283*o,this._kE=-.042416883008123074*i+.1115693827987602*r-.09764676325265872*s+.028494263462021576*o},o.setPreDelayTime=function(t){this.preDelayTime=t;var e=t*this.samplerate;if(e>n-1&&(e=n-1),this.lastPreDelayFrames!==e){this.lastPreDelayFrames=e;for(var i=0,r=this.delayBufferL.length;r>i;++i)this.delayBufferL[i]=this.delayBufferR[i]=0;this.preDelayReadIndex=0,this.preDelayWriteIndex=e}},o.setParams=function(t,e,n){this._k=this.updateStaticCurveParameters(t,e,n);var i=this.saturate(1,this._k),r=1/i;r=Math.pow(r,.6),this._masterLinearGain=Math.pow(10,.05*this.dbPostGain)*r},o.kneeCurve=function(t,e){return t<this.linearThreshold?t:this.linearThreshold+(1-Math.exp(-e*(t-this.linearThreshold)))/e},o.saturate=function(t,e){var n;if(t<this.kneeThreshold)n=this.kneeCurve(t,e);else{var i=t?20*Math.log(t)*Math.LOG10E:-1e3,r=this.ykneeThresholdDb+this.slope*(i-this.kneeThresholdDb);n=Math.pow(10,.05*r)}return n},o.slopeAt=function(t,e){if(t<this.linearThreshold)return 1;var n=1.001*t,i=t?20*Math.log(t)*Math.LOG10E:-1e3,r=n?20*Math.log(n)*Math.LOG10E:-1e3,s=this.kneeCurve(t,e),o=this.kneeCurve(n,e),a=s?20*Math.log(s)*Math.LOG10E:-1e3,l=o?20*Math.log(o)*Math.LOG10E:-1e3;return(l-a)/(r-i)},o.kAtSlope=function(t){for(var e=this.dbThreshold+this.dbKnee,n=Math.pow(10,.05*e),i=.1,r=1e4,s=5,o=0;15>o;++o){var a=this.slopeAt(n,s);t>a?r=s:i=s,s=Math.sqrt(i*r)}return s},o.updateStaticCurveParameters=function(t,e,n){this.dbThreshold=t,this.linearThreshold=Math.pow(10,.05*t),this.dbKnee=e,this.ratio=n,this.slope=1/this.ratio,this.kneeThresholdDb=t+e,this.kneeThreshold=Math.pow(10,.05*this.kneeThresholdDb);var i=this.kAtSlope(1/this.ratio),r=this.kneeCurve(this.kneeThreshold,i);return this.ykneeThresholdDb=r?20*Math.log(r)*Math.LOG10E:-1e3,this._k=i,this._k},o.process=function(t,e){for(var n=1-this.effectBlend,r=this.effectBlend,o=this._k,a=this._masterLinearGain,l=this._satReleaseFrames,u=this._kA,h=this._kB,c=this._kC,f=this._kD,d=this._kE,p=64,m=t.length/p,g=0,v=this.detectorAverage,b=this.compressorGain,y=this.maxAttackCompressionDiffDb,_=1/this._attackFrames,w=this.preDelayReadIndex,x=this.preDelayWriteIndex,A=this.detectorAverage,k=this.delayBufferL,S=this.delayBufferR,T=this.meteringGain,C=this.meteringReleaseK,M=0;m>M;++M){var I,O=Math.asin(v)/(.5*Math.PI),E=O>b,R=b/O,D=R?20*Math.log(R)*Math.LOG10E:-1e3;if((1/0===D||isNaN(D))&&(D=-1),E){y=-1,R=D,R=-12>R?0:R>0?3:.25*(R+12);var L=R*R,P=L*R,j=L*L,N=u+h*R+c*L+f*P+d*j,F=s/N;I=Math.pow(10,.05*F)}else{(-1===y||D>y)&&(y=D);var B=Math.max(.5,y);R=.25/B,I=1-Math.pow(R,_)}for(var $=p;$--;){var z=0,q=.5*(t[g]+e[g]);k[x]=t[g],S[x]=e[g],0>q&&(q*=-1),q>z&&(z=q);var W=z;0>W&&(W*=-1);var V=this.saturate(W,o),G=1e-4>=W?1:V/W,U=G?-20*Math.log(G)*Math.LOG10E:1e3;2>U&&(U=2);var H=U/l,K=Math.pow(10,.05*H)-1,Y=G>A,X=Y?K:1;A+=(G-A)*X,A>1&&(A=1),1>I?b+=(O-b)*I:(b*=I,b>1&&(b=1));var Q=Math.sin(.5*Math.PI*b),Z=n+r*a*Q,J=20*Math.log(Q)*Math.LOG10E;T>J?T=J:T+=(J-T)*C,t[g]=k[w]*Z,e[g]=S[w]*Z,g++,w=w+1&i,x=x+1&i}1e-6>A&&(A=1e-6),1e-6>b&&(b=1e-6)}this.preDelayReadIndex=w,this.preDelayWriteIndex=x,this.detectorAverage=A,this.compressorGain=b,this.maxAttackCompressionDiffDb=y,this.meteringGain=T},o.reset=function(){this.detectorAverage=0,this.compressorGain=1,this.meteringGain=1;for(var t=0,e=this.delayBufferL.length;e>t;++t)this.delayBufferL[t]=this.delayBufferR[t]=0;this.preDelayReadIndex=0,this.preDelayWriteIndex=r,this.maxAttackCompressionDiffDb=-1},t.modules.Compressor=e}(timbre),function(t){"use strict";function e(){}e.prototype.decode=function(t,n,i){if("string"==typeof t){if(/\.wav$/.test(t))return e.wav_decode(t,n,i);if(e.ogg_decode&&/\.ogg$/.test(t))return e.ogg_decode(t,n,i);if(e.mp3_decode&&/\.mp3$/.test(t))return e.mp3_decode(t,n,i)}else if("object"==typeof t){if("wav"===t.type)return e.wav_decode(t.data,n,i);if(e.ogg_decode&&"ogg"===t.type)return e.ogg_decode(t.data,n,i);if(e.mp3_decode&&"mp3"===t.type)return e.mp3_decode(t.data,n,i)}return e.webkit_decode?"object"==typeof t?e.webkit_decode(t.data||t,n,i):e.webkit_decode(t,n,i):e.moz_decode?e.moz_decode(t,n,i):void n(!1)},t.modules.Decoder=e,e.getBinaryWithPath="browser"===t.envtype?function(e,n){t.fn.fix_iOS6_1_problem(!0);var i=new XMLHttpRequest;i.open("GET",e),i.responseType="arraybuffer",i.onreadystatechange=function(){4===i.readyState&&(i.response?n(new Uint8Array(i.response)):void 0!==i.responseBody&&n(new Uint8Array(VBArray(i.responseBody).toArray())),t.fn.fix_iOS6_1_problem(!1))},i.send()}:function(t,e){e("no support")};var n=function(t){for(var e,n,i,r,s,o=new Int32Array(t.length/3),a=0,l=t.length,u=0;l>a;)e=t[a++],n=t[a++],i=t[a++],r=e+(n<<8)+(i<<16),s=8388608&r?r-16777216:r,o[u++]=s;return o};e.wav_decode=function(){var t=function(t,e,i){if("RIFF"!==String.fromCharCode(t[0],t[1],t[2],t[3]))return e(!1);var r=t[4]+(t[5]<<8)+(t[6]<<16)+(t[7]<<24);if(r+8!==t.length)return e(!1);if("WAVE"!==String.fromCharCode(t[8],t[9],t[10],t[11]))return e(!1);if("fmt "!==String.fromCharCode(t[12],t[13],t[14],t[15]))return e(!1);for(var s=t[22]+(t[23]<<8),o=t[24]+(t[25]<<8)+(t[26]<<16)+(t[27]<<24),a=t[34]+(t[35]<<8),l=36;l<t.length&&"data"!==String.fromCharCode(t[l],t[l+1],t[l+2],t[l+3]);)l+=1;if(l>=t.length)return e(!1);l+=4;var u=t[l]+(t[l+1]<<8)+(t[l+2]<<16)+(t[l+3]<<24),h=(u/s>>1)/o;if(l+=4,u>t.length-l)return e(!1);var c,f,d;c=new Float32Array(h*o|0),2===s&&(f=new Float32Array(c.length),d=new Float32Array(c.length)),e({samplerate:o,channels:s,buffer:[c,f,d],duration:h}),8===a?t=new Int8Array(t.buffer,l):16===a?t=new Int16Array(t.buffer,l):32===a?t=new Int32Array(t.buffer,l):24===a&&(t=n(new Uint8Array(t.buffer,l)));var p,m,g,v=1/((1<<a-1)-1);if(2===s)for(l=m=0,p=c.length;p>l;++l)g=f[l]=t[m++]*v,g+=d[l]=t[m++]*v,c[l]=.5*g;else for(l=0,p=c.length;p>l;++l)c[l]=t[l]*v;i()};return function(n,i,r){"string"==typeof n?e.getBinaryWithPath(n,function(e){t(e,i,r)}):t(n,i,r)}}(),e.webkit_decode=function(){if("undefined"!=typeof t.fn._audioContext){var n=t.fn._audioContext,i=function(t,e,i){var r,s,o,a,l;if("string"==typeof t)return i(!1);var u;try{u=n.createBuffer(t.buffer,!1)}catch(h){return e(!1)}r=n.sampleRate,s=u.numberOfChannels,2===s?(o=u.getChannelData(0),a=u.getChannelData(1)):o=a=u.getChannelData(0),l=o.length/r;for(var c=new Float32Array(o),f=0,d=c.length;d>f;++f)c[f]=.5*(c[f]+a[f]);e({samplerate:r,channels:s,buffer:[c,o,a],duration:l}),i()};return function(t,n,r){if(t instanceof File){var s=new FileReader;s.onload=function(t){i(new Uint8Array(t.target.result),n,r)},s.readAsArrayBuffer(t)}else"string"==typeof t?e.getBinaryWithPath(t,function(t){i(t,n,r)}):i(t,n,r)}}}(),e.moz_decode=function(){return"function"==typeof Audio&&"function"==typeof(new Audio).mozSetup?function(t,e,n){var i,r,s,o,a,l,u=0,h=new Audio(t);h.volume=0,h.addEventListener("loadedmetadata",function(){i=h.mozSampleRate,r=h.mozChannels,l=h.duration,s=new Float32Array(h.duration*i|0),2===r&&(o=new Float32Array(h.duration*i|0),a=new Float32Array(h.duration*i|0)),2===r?h.addEventListener("MozAudioAvailable",function(t){for(var e,n=t.frameBuffer,i=0,r=n.length;r>i;i+=2)e=o[u]=n[i],e+=a[u]=n[i+1],s[u]=.5*e,u+=1},!1):h.addEventListener("MozAudioAvailable",function(t){for(var e=t.frameBuffer,n=0,i=e.length;i>n;++n)s[n]=e[n],u+=1},!1),h.play(),setTimeout(function(){e({samplerate:i,channels:r,buffer:[s,o,a],duration:l})},1e3)},!1),h.addEventListener("ended",function(){n()},!1),h.load()}:void 0}()}(timbre),function(t){"use strict";function e(t){this.samplerate=t||44100,this.value=i,this.status=f,this.curve="linear",this.step=1,this.releaseNode=null,this.loopNode=null,this.emit=null,this._envValue=new n(t),this._table=[],this._initValue=i,this._curveValue=0,this._defaultCurveType=s,this._index=0,this._counter=0}function n(t){this.samplerate=t,this.value=i,this.step=1,this._curveType=s,this._curveValue=0,this._grow=0,this._a2=0,this._b1=0,this._y1=0,this._y2=0}var i=e.ZERO=1e-6,r=e.CurveTypeSet=0,s=e.CurveTypeLin=1,o=e.CurveTypeExp=2,a=e.CurveTypeSin=3,l=e.CurveTypeWel=4,u=e.CurveTypeCurve=5,h=e.CurveTypeSqr=6,c=e.CurveTypeCub=7,f=e.StatusWait=0,d=e.StatusGate=1,p=e.StatusSustain=2,m=e.StatusRelease=3,g=e.StatusEnd=4,v={set:r,lin:s,linear:s,exp:o,exponential:o,sin:a,sine:a,wel:l,welch:l,sqr:h,squared:h,cub:c,cubed:c};e.CurveTypeDict=v;var b=e.prototype;b.clone=function(){var t=new e(this.samplerate);return t._table=this._table,t._initValue=this._initValue,t.setCurve(this.curve),null!==this.releaseNode&&t.setReleaseNode(this.releaseNode+1),null!==this.loopNode&&t.setLoopNode(this.loopNode+1),t.setStep(this.step),t.reset(),t},b.setTable=function(t){this._initValue=t[0],this._table=t.slice(1),this.value=this._envValue.value=this._initValue,this._index=0,this._counter=0,this.status=f},b.setCurve=function(t){"number"==typeof t?(this._defaultCurveType=u,this._curveValue=t,this.curve=t):(this._defaultCurveType=v[t]||null,this.curve=t)},b.setReleaseNode=function(t){"number"==typeof t&&t>0&&(this.releaseNode=t-1)},b.setLoopNode=function(t){"number"==typeof t&&t>0&&(this.loopNode=t-1)},b.setStep=function(t){this.step=this._envValue.step=t},b.reset=function(){this.value=this._envValue.value=this._initValue,this._index=0,this._counter=0,this.status=f},b.release=function(){null!==this.releaseNode&&this._index<=this.releaseNode&&(this._counter=0,this._index=this.releaseNode,this.status=m)},b.getInfo=function(t){var e,n,i=this._table,r=0,s=1/0,o=1/0,a=!1;for(e=0,n=i.length;n>e;++e){this.loopNode===e&&(s=r),this.releaseNode===e&&(t>r?r+=t:r=t,o=r);var l=i[e];Array.isArray(l)&&(r+=l[1])}return 1/0!==s&&1/0===o&&(r+=t,a=!0),{totalDuration:r,loopBeginTime:s,releaseBeginTime:o,isEndlessLoop:a}},b.calcStatus=function(){var t,e,n,i,o=this.status,a=this._table,l=this._index,h=this._counter,c=this._curveValue,v=this._defaultCurveType,b=this.loopNode,y=this.releaseNode,_=this._envValue,w=null;switch(o){case f:case g:break;case d:case m:for(;0>=h;)if(l>=a.length){if(o===d&&null!==b){l=b;continue}o=g,h=1/0,i=r,w="ended"}else if(o!==d||l!==y)t=a[l++],e=t[0],i=null===t[2]?v:t[2],i===u&&(c=t[3],Math.abs(c)<.001&&(i=s)),n=t[1],h=_.setNext(e,n,i,c);else{if(null!==b&&y>b){l=b;continue}o=p,h=1/0,i=r,w="sustained"}}return this.status=o,this.emit=w,this._index=l,this._counter=h,o},b.next=function(){return 1&this.calcStatus()&&(this.value=this._envValue.next()||i),this._counter-=1,this.value},b.process=function(t){var e,n=this._envValue,r=t.length;if(1&this.calcStatus())for(e=0;r>e;++e)t[e]=n.next()||i;else{var s=this.value||i;for(e=0;r>e;++e)t[e]=s}this.value=t[r-1],this._counter-=t.length},n.prototype.setNext=function(t,e,n,i){var f,d,p,m,g,v,b,_=this.step,w=this.value,x=.001*e*this.samplerate/_|0;switch(1>x&&(x=1,n=r),n){case r:this.value=t;break;case s:f=(t-w)/x;break;case o:f=0!==w?Math.pow(t/w,1/x):0;break;case a:d=Math.PI/x,m=.5*(t+w),g=2*Math.cos(d),v=.5*(t-w),b=v*Math.sin(.5*Math.PI-d),w=m-v;break;case l:d=.5*Math.PI/x,g=2*Math.cos(d),t>=w?(m=w,v=0,b=-Math.sin(d)*(t-w)):(m=t,v=w-t,b=Math.cos(d)*(w-t)),w=m+v;break;case u:p=(t-w)/(1-Math.exp(i)),m=w+p,g=p,f=Math.exp(i/x);break;case h:v=Math.sqrt(w),b=Math.sqrt(t),f=(b-v)/x;break;case c:v=Math.pow(w,.33333333),b=Math.pow(t,.33333333),f=(b-v)/x}return this.next=y[n],this._grow=f,this._a2=m,this._b1=g,this._y1=v,this._y2=b,x};var y=[];y[r]=function(){return this.value},y[s]=function(){return this.value+=this._grow,this.value},y[o]=function(){return this.value*=this._grow,this.value},y[a]=function(){var t=this._b1*this._y1-this._y2;return this.value=this._a2-t,this._y2=this._y1,this._y1=t,this.value},y[l]=function(){var t=this._b1*this._y1-this._y2;return this.value=this._a2+t,this._y2=this._y1,this._y1=t,this.value},y[u]=function(){return this._b1*=this._grow,this.value=this._a2-this._b1,this.value},y[h]=function(){return this._y1+=this._grow,this.value=this._y1*this._y1,this.value},y[c]=function(){return this._y1+=this._grow,this.value=this._y1*this._y1*this._y1,this.value},n.prototype.next=y[r],t.modules.Envelope=e,t.modules.EnvelopeValue=n}(timbre),function(t){"use strict";function e(e){e="number"==typeof e?e:512,e=1<<Math.ceil(Math.log(e)*Math.LOG2E),this.length=e,this.buffer=new t.fn.SignalArray(e),this.real=new t.fn.SignalArray(e),this.imag=new t.fn.SignalArray(e),this._real=new t.fn.SignalArray(e),this._imag=new t.fn.SignalArray(e),this.mag=new t.fn.SignalArray(e>>1),this.minDecibels=-30,this.maxDecibels=-100;var n=i.get(e);this._bitrev=n.bitrev,this._sintable=n.sintable,this._costable=n.costable}var n=e.prototype;n.setWindow=function(e){if("string"==typeof e){var n=/([A-Za-z]+)(?:\(([01]\.?\d*)\))?/.exec(e);if(null!==n){var i=n[1].toLowerCase(),s=void 0!==n[2]?+n[2]:.25,o=r[i];if(o){this._window||(this._window=new t.fn.SignalArray(this.length));var a=this._window,l=0,u=this.length;for(s=0>s?0:s>1?1:s;u>l;++l)a[l]=o(l,u,s);this.windowName=e}}}},n.forward=function(t){var e,n,i,r,s,o,a,l,u,h,c,f=this.buffer,d=this.real,p=this.imag,m=this._window,g=this._bitrev,v=this._sintable,b=this._costable,y=f.length;if(m)for(e=0;y>e;++e)f[e]=t[e]*m[e];else f.set(t);for(e=0;y>e;++e)d[e]=f[g[e]],p[e]=0;for(i=1;y>i;i=r)for(s=0,r=i+i,o=y/r,n=0;i>n;n++){for(a=b[s],l=v[s],e=n;y>e;e+=r)u=e+i,h=l*p[u]+a*d[u],c=a*p[u]-l*d[u],d[u]=d[e]-h,d[e]+=h,p[u]=p[e]-c,p[e]+=c;s+=o}var _,w,x=this.mag;for(e=0;y>e;++e)_=d[e],w=p[e],x[e]=Math.sqrt(_*_+w*w);return{real:d,imag:p}},n.inverse=function(t,e){var n,i,r,s,o,a,l,u,h,c,f,d=this.buffer,p=this._real,m=this._imag,g=this._bitrev,v=this._sintable,b=this._costable,y=d.length;for(n=0;y>n;++n)i=g[n],p[n]=+t[i],m[n]=-e[i];for(r=1;y>r;r=s)for(o=0,s=r+r,a=y/s,i=0;r>i;i++){for(l=b[o],u=v[o],n=i;y>n;n+=s)h=n+r,c=u*m[h]+l*p[h],f=l*m[h]-u*p[h],p[h]=p[n]-c,p[n]+=c,m[h]=m[n]-f,m[n]+=f;o+=a}for(n=0;y>n;++n)d[n]=p[n]/y;return d},n.getFrequencyData=function(t){var e,n=this.minDecibels,i=Math.min(this.mag.length,t.length);if(i){var r,s=this.mag,o=0;for(e=0;i>e;++e)r=s[e],t[e]=r?20*Math.log(r)*Math.LOG10E:n,o<t[e]&&(o=t[e])}return t};var i={get:function(e){return i[e]||function(){var n,r,s=function(){var t,n,i,r,s;for(t=new Int16Array(e),s=e>>1,n=i=0;t[n]=i,!(++n>=e);){for(r=s;i>=r;)i-=r,r>>=1;i+=r}return t}(),o=Math.floor(Math.log(e)/Math.LN2),a=new t.fn.SignalArray((1<<o)-1),l=new t.fn.SignalArray((1<<o)-1),u=2*Math.PI;for(n=0,r=a.length;r>n;++n)a[n]=Math.sin(u*(n/e)),l[n]=Math.cos(u*(n/e));return i[e]={bitrev:s,sintable:a,costable:l},i[e]}()}},r=function(){var t=Math.PI,e=2*Math.PI,n=Math.abs,i=Math.pow,r=Math.cos,s=Math.sin,o=function(e){return s(t*e)/(t*e)},a=Math.E;return{rectangular:function(){return 1},hann:function(t,n){return.5*(1-r(e*t/(n-1)))},hamming:function(t,n){return.54-.46*r(e*t/(n-1))},tukery:function(e,n,i){return i*(n-1)/2>e?.5*(1+r(t*(2*e/(i*(n-1))-1))):e>(n-1)*(1-i/2)?.5*(1+r(t*(2*e/(i*(n-1))-2/i+1))):1},cosine:function(e,n){return s(t*e/(n-1))},lanczos:function(t,e){return o(2*t/(e-1)-1)},triangular:function(t,e){return 2/(e+1)*((e+1)/2-n(t-(e-1)/2))},bartlett:function(t,e){return 2/(e-1)*((e-1)/2-n(t-(e-1)/2))},gaussian:function(t,e,n){return i(a,-.5*i((t-(e-1)/2)/(n*(e-1)/2),2))},bartlettHann:function(t,i){return.62-.48*n(t/(i-1)-.5)-.38*r(e*t/(i-1))},blackman:function(n,i,s){var o=(1-s)/2,a=.5,l=s/2;return o-a*r(e*n/(i-1))+l*r(4*t*n/(i-1))}}}();t.modules.FFT=e}(timbre),function(t){"use strict";function e(t){this.samplerate=t||44100,this.wave=null,this.step=1,this.frequency=0,this.value=0,this.phase=0,this.feedback=!1,this._x=0,this._lastouts=0,this._coeff=s/this.samplerate,this._radtoinc=s/(2*Math.PI)}function n(t,e,n,i){var r,s,o,a,l,u=h[e];if(void 0!==u){switch("function"==typeof u&&(u=u()),n){case"@1":for(s=512;1024>s;++s)u[s]=0;break;case"@2":for(s=512;1024>s;++s)u[s]=Math.abs(u[s]);break;case"@3":for(s=256;512>s;++s)u[s]=0;for(s=512;768>s;++s)u[s]=Math.abs(u[s]);for(s=768;1024>s;++s)u[s]=0;break;case"@4":for(r=new Float32Array(1024),s=0;512>s;++s)r[s]=u[s<<1];u=r;break;case"@5":for(r=new Float32Array(1024),s=0;512>s;++s)r[s]=Math.abs(u[s<<1]);u=r}if(void 0!==i&&50!==i){for(i*=.01,i=0>i?0:i>1?1:i,r=new Float32Array(1024),o=1024*i|0,s=0;o>s;++s)r[s]=u[s/o*512|0];for(l=1024-o,a=0;1024>s;++s,++a)r[s]=u[a/l*512+512|0];u=r}if("+"===t)for(s=0;1024>s;++s)u[s]=.5*u[s]+.5;else if("-"===t)for(s=0;1024>s;++s)u[s]*=-1;return u}}function i(t){var e=new Float32Array(1024),n=t.length>>1;if(-1!==[2,4,8,16,32,64,128,256,512,1024].indexOf(n))for(var i=0,r=0;n>i;++i){var s=parseInt(t.substr(2*i,2),16);s=128&s?(s-256)/128:s/127;for(var o=0,a=1024/n;a>o;++o)e[r++]=s}return e}function r(t){var e=new Float32Array(1024);if(8===t.length){var n,i,r=parseInt(t,16),s=new Float32Array(8);for(s[0]=1,n=0;7>n;++n)s[n+1]=.0625*(15&r),r>>=4;for(n=0;8>n;++n){var o=0,a=(n+1)/1024;for(i=0;1024>i;++i)e[i]+=Math.sin(2*Math.PI*o)*s[n],o+=a}var l,u=0;for(n=0;1024>n;++n)u<(l=Math.abs(e[n]))&&(u=l);if(u>0)for(n=0;1024>n;++n)e[n]/=u}return e}var s=1024,o=s-1,a=e.prototype;a.setWave=function(e){var n,i,r=this.wave;if(this.wave||(this.wave=new Float32Array(s+1)),"function"==typeof e)for(n=0;s>n;++n)r[n]=e(n/s);else if(t.fn.isSignalArray(e))if(e.length===r.length)r.set(e);else for(i=e.length/s,n=0;s>n;++n)r[n]=e[n*i|0];else"string"==typeof e&&void 0!==(i=l(e))&&this.wave.set(i);this.wave[s]=this.wave[0]},a.clone=function(){var t=new e(this.samplerate);return t.wave=this.wave,t.step=this.step,t.frequency=this.frequency,t.value=this.value,t.phase=this.phase,t.feedback=this.feedback,t},a.reset=function(){this._x=0},a.next=function(){var t=this._x,e=t+this.phase*this._radtoinc|0;return this.value=this.wave[e&o],t+=this.frequency*this._coeff*this.step,t>s&&(t-=s),this._x=t,this.value},a.process=function(t){var e,n,i,r,a,l,u=this.wave,h=this._radtoinc,c=this._x,f=this.frequency*this._coeff,d=this.step;if(this.feedback){var p=this._lastouts;for(h*=this.phase,l=0;d>l;++l)e=c+p*h,n=0|e,i=e-n,n&=o,r=u[n],a=u[n+1],t[l]=p=r+i*(a-r),c+=f;this._lastouts=p}else{var m=this.phase*h;for(l=0;d>l;++l)e=c+m,n=0|e,i=e-n,n&=o,r=u[n],a=u[n+1],t[l]=r+i*(a-r),c+=f}c>s&&(c-=s),this._x=c,this.value=t[t.length-1]},a.processWithFreqArray=function(t,e){var n,i,r,a,l,u,h=this.wave,c=this._radtoinc,f=this._x,d=this._coeff,p=this.step;if(this.feedback){var m=this._lastouts;for(c*=this.phase,u=0;p>u;++u)n=f+m*c,i=0|n,r=n-i,i&=o,a=h[i],l=h[i+1],t[u]=m=a+r*(l-a),f+=e[u]*d;this._lastouts=m}else{var g=this.phase*this._radtoinc;for(u=0;p>u;++u)n=f+g,i=0|n,r=n-i,i&=o,a=h[i],l=h[i+1],t[u]=a+r*(l-a),f+=e[u]*d}f>s&&(f-=s),this._x=f,this.value=t[t.length-1]},a.processWithPhaseArray=function(t,e){var n,i,r,a,l,u,h=this.wave,c=this._radtoinc,f=this._x,d=this.frequency*this._coeff,p=this.step;if(this.feedback){var m=this._lastouts;for(c*=this.phase,u=0;p>u;++u)n=f+m*c,i=0|n,r=n-i,i&=o,a=h[i],l=h[i+1],t[u]=m=a+r*(l-a),f+=d;this._lastouts=m}else for(u=0;p>u;++u)n=f+e[u]*c,i=0|n,r=n-i,i&=o,a=h[i],l=h[i+1],t[u]=a+r*(l-a),f+=d;f>s&&(f-=s),this._x=f,this.value=t[t.length-1]},a.processWithFreqAndPhaseArray=function(t,e,n){var i,r,a,l,u,h,c=this.wave,f=this._radtoinc,d=this._x,p=this._coeff,m=this.step;if(this.feedback){var g=this._lastouts;for(f*=this.phase,h=0;m>h;++h)i=d+g*f,r=0|i,a=i-r,r&=o,l=c[r],u=c[r+1],t[h]=g=l+a*(u-l),d+=e[h]*p;this._lastouts=g}else for(h=0;m>h;++h)i=d+n[h]*s,r=0|i,a=i-r,r&=o,l=c[r],u=c[r+1],t[h]=l+a*(u-l),d+=e[h]*p;d>s&&(d-=s),this._x=d,this.value=t[t.length-1]};var l=function(t){var e=h[t];if(void 0!==e)return"function"==typeof e&&(e=e()),e;var s;if(s=/^([\-+]?)(\w+)(?:\((@[0-7])?:?(\d+)?\))?$/.exec(t),null!==s){var o=s[1],a=s[2],l=s[3],u=s[4];if(e=n(o,a,l,u),void 0!==e)return h[t]=e,e}return s=/^wavb\(((?:[0-9a-fA-F][0-9a-fA-F])+)\)$/.exec(t),null!==s?i(s[1]):(s=/^wavc\(([0-9a-fA-F]{8})\)$/.exec(t),null!==s?r(s[1]):void 0)};e.getWavetable=l;var u=function(e,n){var i,r,s=new Float32Array(1024);if("function"==typeof n)for(r=0;1024>r;++r)s[r]=n(r/1024);else if(t.fn.isSignalArray(n))if(n.length===s.length)s.set(n);else for(i=n.length/1024,r=0;1024>r;++r)s[r]=n[r*i|0];h[e]=s};e.setWavetable=u;var h={sin:function(){for(var t=new Float32Array(1024),e=0;1024>e;++e)t[e]=Math.sin(2*Math.PI*(e/1024));return t},cos:function(){for(var t=new Float32Array(1024),e=0;1024>e;++e)t[e]=Math.cos(2*Math.PI*(e/1024));return t},pulse:function(){for(var t=new Float32Array(1024),e=0;1024>e;++e)t[e]=512>e?1:-1;return t},tri:function(){for(var t,e=new Float32Array(1024),n=0;1024>n;++n)t=n/1024-.25,e[n]=1-4*Math.abs(Math.round(t)-t);return e},saw:function(){for(var t,e=new Float32Array(1024),n=0;1024>n;++n)t=n/1024,e[n]=2*(t-Math.round(t));return e},fami:function(){for(var t=[0,.125,.25,.375,.5,.625,.75,.875,.875,.75,.625,.5,.375,.25,.125,0,-.125,-.25,-.375,-.5,-.625,-.75,-.875,-1,-1,-.875,-.75,-.625,-.5,-.375,-.25,-.125],e=new Float32Array(1024),n=0;1024>n;++n)e[n]=t[n/1024*t.length|0];return e},konami:function(){for(var t=[-.625,-.875,-.125,.75,.5,.125,.5,.75,.25,-.125,.5,.875,.625,0,.25,.375,-.125,-.75,0,.625,.125,-.5,-.375,-.125,-.75,-1,-.625,0,-.375,-.875,-.625,-.25],e=new Float32Array(1024),n=0;1024>n;++n)e[n]=t[n/1024*t.length|0];return e}};t.modules.Oscillator=e}(timbre),function(t){"use strict";function e(e,o){this.samplerate=e;var a,l,u=e/44100;for(l=2*r.length,this.comb=new Array(l),this.combout=new Array(l),a=0;l>a;++a)this.comb[a]=new n(r[a%r.length]*u),this.combout[a]=new t.fn.SignalArray(o);for(l=2*s.length,this.allpass=new Array(l),a=0;l>a;++a)this.allpass[a]=new i(s[a%s.length]*u);this.outputs=[new t.fn.SignalArray(o),new t.fn.SignalArray(o)],this.damp=0,this.wet=.33,this.setRoomSize(.5),this.setDamp(.5)}function n(e){this.buffer=new t.fn.SignalArray(0|e),this.buffersize=this.buffer.length,this.bufidx=0,this.feedback=0,this.filterstore=0,this.damp=0}function i(e){this.buffer=new t.fn.SignalArray(0|e),this.buffersize=this.buffer.length,this.bufidx=0}var r=[1116,1188,1277,1356,1422,1491,1557,1617],s=[225,556,441,341],o=e.prototype;o.setRoomSize=function(t){var e=this.comb,n=.28*t+.7;this.roomsize=t,e[0].feedback=e[1].feedback=e[2].feedback=e[3].feedback=e[4].feedback=e[5].feedback=e[6].feedback=e[7].feedback=e[8].feedback=e[9].feedback=e[10].feedback=e[11].feedback=e[12].feedback=e[13].feedback=e[14].feedback=e[15].feedback=n},o.setDamp=function(t){var e=this.comb,n=.4*t;this.damp=t,e[0].damp=e[1].damp=e[2].damp=e[3].damp=e[4].damp=e[5].damp=e[6].damp=e[7].damp=e[8].damp=e[9].damp=e[10].damp=e[11].damp=e[12].damp=e[13].damp=e[14].damp=e[15].damp=n},o.process=function(t,e){var n,i=this.comb,r=this.combout,s=this.allpass,o=this.outputs[0],a=this.outputs[1],l=this.wet,u=1-l,h=t.length;for(i[0].process(t,r[0]),i[1].process(t,r[1]),i[2].process(t,r[2]),i[3].process(t,r[3]),i[4].process(t,r[4]),i[5].process(t,r[5]),i[6].process(t,r[6]),i[7].process(t,r[7]),i[8].process(e,r[8]),i[9].process(e,r[9]),i[10].process(e,r[10]),i[11].process(e,r[11]),i[12].process(e,r[12]),i[13].process(e,r[13]),i[14].process(e,r[14]),i[15].process(e,r[15]),n=0;h>n;++n)o[n]=r[0][n]+r[1][n]+r[2][n]+r[3][n]+r[4][n]+r[5][n]+r[6][n]+r[7][n],a[n]=r[8][n]+r[9][n]+r[10][n]+r[11][n]+r[12][n]+r[13][n]+r[14][n]+r[15][n];for(s[0].process(o,o),s[1].process(o,o),s[2].process(o,o),s[3].process(o,o),s[4].process(a,a),s[5].process(a,a),s[6].process(a,a),s[7].process(a,a),n=0;h>n;++n)t[n]=o[n]*l+t[n]*u,e[n]=a[n]*l+e[n]*u},n.prototype.process=function(t,e){var n,i,r,s=this.buffer,o=this.buffersize,a=this.bufidx,l=this.filterstore,u=this.feedback,h=this.damp,c=1-h,f=t.length;for(r=0;f>r;++r)n=.015*t[r],i=s[a],l=i*c+l*h,s[a]=n+l*u,++a>=o&&(a=0),e[r]=i;this.bufidx=a,this.filterstore=l},i.prototype.process=function(t,e){var n,i,r,s,o=this.buffer,a=this.buffersize,l=this.bufidx,u=t.length;for(s=0;u>s;++s)n=t[s],r=o[l],i=-n+r,o[l]=n+.5*r,++l>=a&&(l=0),e[s]=i;this.bufidx=l},t.modules.Reverb=e}(timbre),function(t){"use strict";function e(t){return new n(t)}function n(t){if(this.fragments=[],t){var e=t.samplerate||44100,n=t.buffer[0].length/e;this.fragments.push(new i(t,0,n))}}function i(t,e,n,i,r,s,a){t||(t=o),this.buffer=t.buffer[0],this.samplerate=t.samplerate||44100,this.start=e,this._duration=n,this.reverse=i||!1,this.pitch=r||100,this.stretch=s||!1,this.pan=a||50}function r(t,e){this.tape=t,this.fragments=t.fragments,this.samplerate=e||44100,this.isEnded=!1,this.buffer=null,this.bufferIndex=0,this.bufferIndexIncr=0,this.bufferBeginIndex=0,this.bufferEndIndex=0,this.fragment=null,this.fragmentIndex=0,this.panL=.5,this.panR=.5}var s=new Float32Array(60),o={buffer:s,samplerate:1};e.silence=function(t){return new e(o).slice(0,1).fill(t)},e.join=function(t){for(var e=new n,i=0;i<t.length;i++)t[i]instanceof n&&e.add_fragments(t[i].fragments);return e},e.Tape=n,n.prototype.add_fragment=function(t){return this.fragments.push(t),this},n.prototype.add_fragments=function(t){for(var e=0;e<t.length;e++)this.fragments.push(t[e]);return this},n.prototype.duration=function(){for(var t=0,e=0;e<this.fragments.length;e++)t+=this.fragments[e].duration();return t},n.prototype.slice=function(t,e){var i=this.duration();t+e>i&&(e=i-t);for(var r=new n,s=t,o=e,a=0;a<this.fragments.length;a++){var l=this.fragments[a],u=l.create(s,o),h=u[0];if(s=u[1],o=u[2],h&&r.add_fragment(h),0===o)break}return r},n.prototype.cut=n.prototype.slice,n.prototype.concat=function(t){var e=new n;return e.add_fragments(this.fragments),e.add_fragments(t.fragments),e},n.prototype.loop=function(t){var e,i=[];for(e=0;e<this.fragments.length;e++)i.push(this.fragments[e].clone());var r=new n;for(e=0;t>e;e++)r.add_fragments(i);return r},n.prototype.times=n.prototype.loop,n.prototype.split=function(t){for(var e=this.duration()/t,n=[],i=0;t>i;i++)n.push(this.slice(i*e,e));return n},n.prototype.fill=function(t){var e=this.duration();if(0===e)throw"EmptyFragment";var n=t/e|0,i=t%e;return this.loop(n).plus(this.slice(0,i))},n.prototype.replace=function(t,i,r){var s=new n,o=t+i;s=s.plus(this.slice(0,t));var a=s.duration();t>a&&(s=s.plus(e.silence(t-a))),s=s.plus(r);var l=this.duration();return l>o&&(s=s.plus(this.slice(o,l-o))),s},n.prototype.reverse=function(){for(var t=new n,e=this.fragments.length;e--;){var i=this.fragments[e].clone();i.reverse=!i.isReversed(),t.add_fragment(i)}return t},n.prototype.pitch=function(t,e){var i=new n;e=e||!1;for(var r=0;r<this.fragments.length;r++){var s=this.fragments[r].clone();s.pitch*=.01*t,s.stretch=e,i.add_fragment(s)}return i},n.prototype.stretch=function(t){var e=1/(.01*t)*100;return this.pitch(e,!0)},n.prototype.pan=function(t){var e=new n;t>100?t=100:0>t&&(t=0);for(var i=0;i<this.fragments.length;i++){var r=this.fragments[i].clone();r.pan=t,e.add_fragment(r)}return e},n.prototype.silence=function(){return e.silence(this.duration())},n.prototype.join=function(t){for(var e=new n,i=0;i<t.length;i++)t[i]instanceof n&&e.add_fragments(t[i].fragments);return e},n.prototype.getBuffer=function(){var t=44100;this.fragments.length>0&&(t=this.fragments[0].samplerate);var e=new r(this,t),n=this.duration()*t|0;return{samplerate:t,buffer:e.fetch(n)}},i.prototype.duration=function(){return this._duration*(100/this.pitch)},i.prototype.original_duration=function(){return this._duration},i.prototype.isReversed=function(){return this.reverse},i.prototype.isStretched=function(){return this.stretched},i.prototype.create=function(t,e){var n=this.duration();if(t>=n)return[null,t-n,e];var i,r=t+e>=n;r?(i=n-t,e-=i):(i=e,e=0);var s=this.clone();return s.start=this.start+t*this.pitch*.01,s._duration=i*this.pitch*.01,s.reverse=!1,[s,0,e]},i.prototype.clone=function(){var t=new i;return t.buffer=this.buffer,t.samplerate=this.samplerate,t.start=this.start,t._duration=this._duration,t.reverse=this.reverse,t.pitch=this.pitch,t.stretch=this.stretch,t.pan=this.pan,t},e.Fragment=i,e.TapeStream=r,r.prototype.reset=function(){return this.isEnded=!1,this.buffer=null,this.bufferIndex=0,this.bufferIndexIncr=0,this.bufferBeginIndex=0,this.bufferEndIndex=0,this.fragment=null,this.fragmentIndex=0,this.panL=.5,this.panR=.5,this.isLooped=!1,this},r.prototype.fetch=function(e){var n=new t.fn.SignalArray(e),i=new t.fn.SignalArray(e),r=this.fragments;if(0===r.length)return[n,i];for(var o,a=100*this.samplerate,l=this.buffer,u=this.bufferIndex,h=this.bufferIndexIncr,c=this.bufferBeginIndex,f=this.bufferEndIndex,d=this.fragment,p=this.fragmentIndex,m=this.panL,g=this.panR,v=0;e>v;v++){for(;!l||c>u||u>=f;)if(!d||p<r.length)d=r[p++],l=d.buffer,h=d.samplerate/a*d.pitch,c=d.start*d.samplerate,f=c+d.original_duration()*d.samplerate,o=.01*d.pan,m=1-o,g=o,d.reverse?(h*=-1,u=f+h):u=c;else{if(!this.isLooped){this.isEnded=!0,l=s,h=0,u=0;break}l=null,u=0,h=0,c=0,f=0,d=null,p=0}n[v]=l[0|u]*m,i[v]=l[0|u]*g,u+=h}return this.buffer=l,this.bufferIndex=u,this.bufferIndexIncr=h,this.bufferBeginIndex=c,this.bufferEndIndex=f,this.fragment=d,this.fragmentIndex=p,this.panL=m,this.panR=g,[n,i]},t.modules.Scissor=e}(timbre),function(t){"use strict";function e(e){this.samplerate=e;var n=Math.ceil(Math.log(1.5*e)*Math.LOG2E);this.buffersize=1<<n,this.buffermask=this.buffersize-1,this.writeBufferL=new t.fn.SignalArray(this.buffersize),this.writeBufferR=new t.fn.SignalArray(this.buffersize),this.readBufferL=this.writeBufferL,this.readBufferR=this.writeBufferR,this.delaytime=null,this.feedback=null,this.cross=null,this.mix=null,this.prevL=0,this.prevR=0,this.readIndex=0,this.writeIndex=0,this.setParams(125,.25,!1,.45)}var n=e.prototype;n.setParams=function(t,e,n,i){if(this.delaytime!==t){this.delaytime=t;var r=.001*t*this.samplerate|0;r>this.buffermask&&(r=this.buffermask),this.writeIndex=this.readIndex+r&this.buffermask}this.feedback!==e&&(this.feedback=e),this.cross!==n&&(this.cross=n,n?(this.readBufferL=this.writeBufferR,this.readBufferR=this.writeBufferL):(this.readBufferL=this.writeBufferL,this.readBufferR=this.writeBufferR)),this.mix!==i&&(this.mix=i)},n.process=function(t,e){var n,i,r=this.readBufferL,s=this.readBufferR,o=this.writeBufferL,a=this.writeBufferR,l=this.readIndex,u=this.writeIndex,h=this.buffermask,c=this.feedback,f=this.mix,d=1-f,p=this.prevL,m=this.prevR,g=t.length;for(i=0;g>i;++i)n=r[l],o[u]=t[i]-n*c,t[i]=p=.5*(t[i]*d+n*f+p),n=s[l],a[u]=e[i]-n*c,e[i]=m=.5*(e[i]*d+n*f+m),l+=1,u=u+1&h;this.readIndex=l&this.buffermask,this.writeIndex=u,this.prevL=p,this.prevR=m},t.modules.StereoDelay=e}(timbre),function(t){"use strict";var e=t.fn,n=t.modules;e.register("audio",function(t){var n=e.getClass("buffer"),s=new n(t);return s.playbackState=e.FINISHED_STATE,s._.isLoaded=!1,Object.defineProperties(s,{isLoaded:{get:function(){return this._.isLoaded}}}),s.load=i,s.loadthis=r,s});var i=function(i){var r=this,s=this._,o=new n.Deferred(this),a=arguments,l=1;o.done(function(){r._.emit("done")}),"function"==typeof a[l]&&(o.done(a[l++]),"function"==typeof a[l]&&o.fail(a[l++])),s.loadedTime=0;var u=function(n,i){var s=r._;n?(r.playbackState=e.PLAYING_STATE,s.samplerate=n.samplerate,s.channels=n.channels,s.bufferMix=null,s.buffer=n.buffer,s.phase=0,s.phaseIncr=n.samplerate/t.samplerate,s.duration=1e3*n.duration,s.currentTime=0,s.isReversed&&(s.phaseIncr*=-1,s.phase=n.buffer[0].length+s.phaseIncr),r._.emit("loadedmetadata")):o.reject(i)},h=function(){r._.isLoaded=!0,r._.plotFlush=!0,r._.emit("loadeddata"),o.resolveWith(r)};return(new n.Decoder).decode(i,u,h),o.promise()},r=function(){return i.apply(this,arguments),this}}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.fixAR(this);var i=this._;i.biquad=new r(i.samplerate),i.freq=t(340),i.band=t(1),
i.gain=t(0),i.plotBefore=o,i.plotRange=[-18,18],i.plotFlush=!0}var n=t.fn,i=t.modules.FFT,r=t.modules.Biquad,s=20;n.extend(e);var o=function(t,e,n,i,r){t.lineWidth=1,t.strokeStyle="rgb(192, 192, 192)";for(var o=.5*this._.samplerate,a=1;10>=a;++a)for(var l=1;4>=l;l++){var u=a*Math.pow(10,l);if(!(s>=u||u>=o)){t.beginPath();var h=Math.log(u/s)/Math.log(o/s);h=(h*i+e|0)+.5,t.moveTo(h,n),t.lineTo(h,n+r),t.stroke()}}var c=r/6;for(a=1;6>a;a++){t.beginPath();var f=(n+a*c|0)+.5;t.moveTo(e,f),t.lineTo(e+i,f),t.stroke()}},a=e.prototype;Object.defineProperties(a,{type:{set:function(t){var e=this._;t!==e.biquad.type&&(e.biquad.setType(t),e.plotFlush=!0)},get:function(){return this._.biquad.type}},freq:{set:function(e){this._.freq=t(e)},get:function(){return this._.freq}},cutoff:{set:function(e){this._.freq=t(e)},get:function(){return this._.freq}},res:{set:function(e){this._.band=t(e)},get:function(){return this._.band}},Q:{set:function(e){this._.band=t(e)},get:function(){return this._.band}},band:{set:function(e){this._.band=t(e)},get:function(){return this._.band}},gain:{set:function(e){this._.gain=t(e)},get:function(){return this._.gain}}}),a.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,n.inputSignalAR(this);var i=e.freq.process(t).cells[0][0],r=e.band.process(t).cells[0][0],s=e.gain.process(t).cells[0][0];(e.prevFreq!==i||e.prevband!==r||e.prevGain!==s)&&(e.prevFreq=i,e.prevband=r,e.prevGain=s,e.biquad.setParams(i,r,s),e.plotFlush=!0),e.bypassed||e.biquad.process(this.cells[1],this.cells[2]),n.outputSignalAR(this)}return this};var l=new i(2048),u=t.Object.prototype.plot;a.plot=function(t){if(this._.plotFlush){var e=new r(this._.samplerate);e.setType(this.type),e.setParams(this.freq.valueOf(),this.band.valueOf(),this.gain.valueOf());var n=new Float32Array(l.length);n[0]=1,e.process(n,n),l.forward(n);var i,o,a,h,c,f,d,p,m=512,g=new Float32Array(m),v=.5*this._.samplerate,b=new Float32Array(m);for(l.getFrequencyData(b),i=0;m>i;++i)a=Math.pow(v/s,i/m)*s,o=a/(v/b.length),h=0|o,c=o-h,0===h?d=f=p=b[h]:(f=b[h-1],d=b[h],p=(1-c)*f+c*d),g[i]=p;this._.plotData=g,this._.plotFlush=null}return u.call(this,t)},n.register("biquad",e),n.register("lowpass",function(t){return new e(t).set("type","lowpass")}),n.register("highpass",function(t){return new e(t).set("type","highpass")}),n.register("bandpass",function(t){return new e(t).set("type","bandpass")}),n.register("lowshelf",function(t){return new e(t).set("type","lowshelf")}),n.register("highshelf",function(t){return new e(t).set("type","highshelf")}),n.register("peaking",function(t){return new e(t).set("type","peaking")}),n.register("notch",function(t){return new e(t).set("type","notch")}),n.register("allpass",function(t){return new e(t).set("type","allpass")}),n.alias("lpf","lowpass"),n.alias("hpf","highpass"),n.alias("bpf","bandpass"),n.alias("bef","notch"),n.alias("brf","notch"),n.alias("apf","allpass")}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),n.fixAR(this);var i=this._;i.pitch=t(1),i.samplerate=44100,i.channels=0,i.bufferMix=null,i.buffer=[],i.isLooped=!1,i.isReversed=!1,i.duration=0,i.currentTime=0,i.currentTimeObj=null,i.phase=0,i.phaseIncr=0,i.onended=n.make_onended(this,0),i.onlooped=s(this)}var n=t.fn,i=t.modules.Scissor.Tape,r=function(t){return n.isSignalArray(t)||t instanceof Float32Array};n.extend(e);var s=function(t){return function(){var e=t._;e.phase>=e.buffer[0].length?e.phase=0:e.phase<0&&(e.phase=e.buffer[0].length+e.phaseIncr),t._.emit("looped")}},o=e.prototype,a=function(e){var n=this._;if("object"==typeof e){var s,o,a=[];r(e)?(a[0]=e,o=1):"object"==typeof e&&(e instanceof t.Object?e=e.buffer:e instanceof i&&(e=e.getBuffer()),Array.isArray(e.buffer)?r(e.buffer[0])&&(r(e.buffer[1])&&r(e.buffer[2])?(o=2,a=e.buffer):(o=1,a=[e.buffer[0]])):r(e.buffer)&&(o=1,a=[e.buffer]),"number"==typeof e.samplerate&&(s=e.samplerate)),a.length&&(s>0&&(n.samplerate=e.samplerate),n.bufferMix=null,n.buffer=a,n.phase=0,n.phaseIncr=n.samplerate/t.samplerate,n.duration=1e3*n.buffer[0].length/n.samplerate,n.currentTime=0,n.plotFlush=!0,this.reverse(n.isReversed))}};Object.defineProperties(o,{buffer:{set:a,get:function(){var t=this._;return{samplerate:t.samplerate,channels:t.channels,buffer:t.buffer}}},pitch:{set:function(e){this._.pitch=t(e)},get:function(){return this._.pitch}},isLooped:{get:function(){return this._.isLooped}},isReversed:{get:function(){return this._.isReversed}},samplerate:{get:function(){return this._.samplerate}},duration:{get:function(){return this._.duration}},currentTime:{set:function(e){if("number"==typeof e){var n=this._;e>=0&&e<=n.duration&&(n.phase=e/1e3*n.samplerate,n.currentTime=e)}else e instanceof t.Object?this._.currentTimeObj=e:null===e&&(this._.currentTimeObj=null)},get:function(){return this._.currentTimeObj?this._.currentTimeObj:this._.currentTime}}}),o.clone=function(){var t=this._,e=n.clone(this);return t.buffer.length&&a.call(e,{buffer:t.buffer,samplerate:t.samplerate,channels:t.channels}),e.loop(t.isLooped),e.reverse(t.isReversed),e},o.slice=function(e,i){var r=this._,s=t(r.originkey),o=r.isReversed;if(r.buffer.length){if(e="number"==typeof e?.001*e*r.samplerate|0:0,i="number"==typeof i?.001*i*r.samplerate|0:r.buffer[0].length,e>i){var l=e;e=i,i=l,o=!o}2===r.channels?a.call(s,{buffer:[n.pointer(r.buffer[0],e,i-e),n.pointer(r.buffer[1],e,i-e),n.pointer(r.buffer[2],e,i-e)],samplerate:r.samplerate}):a.call(s,{buffer:n.pointer(r.buffer[0],e,i-e),samplerate:r.samplerate}),s.playbackState=n.PLAYING_STATE}return s.loop(r.isLooped),s.reverse(r.isReversed),s},o.reverse=function(t){var e=this._;return e.isReversed=!!t,e.isReversed?(e.phaseIncr>0&&(e.phaseIncr*=-1),0===e.phase&&e.buffer.length&&(e.phase=e.buffer[0].length+e.phaseIncr)):e.phaseIncr<0&&(e.phaseIncr*=-1),this},o.loop=function(t){return this._.isLooped=!!t,this},o.bang=function(t){return this.playbackState=t===!1?n.FINISHED_STATE:n.PLAYING_STATE,this._.phase=0,this._.emit("bang"),this},o.process=function(t){var e=this._;if(!e.buffer.length)return this;if(this.tickID!==t){this.tickID=t;var i,r,s,o=this.cells[1],a=this.cells[2],l=e.phase,u=e.cellsize;if(2===e.channels?(r=e.buffer[1],s=e.buffer[2]):r=s=e.buffer[0],e.currentTimeObj){var h,c=e.currentTimeObj.process(t).cells[0],f=.001*e.samplerate;for(i=0;u>i;++i)h=c[i],l=h*f,o[i]=r[0|l]||0,a[i]=s[0|l]||0;e.phase=l,e.currentTime=h}else{var d=e.pitch.process(t).cells[0][0],p=e.phaseIncr*d;for(i=0;u>i;++i)o[i]=r[0|l]||0,a[i]=s[0|l]||0,l+=p;l>=r.length?n.nextTick(e.isLooped?e.onlooped:e.onended):0>l&&n.nextTick(e.isLooped?e.onlooped:e.onended),e.phase=l,e.currentTime+=n.currentTimeIncr}n.outputSignalAR(this)}return this};var l=t.Object.prototype.plot;o.plot=function(t){var e,n,i=this._;if(i.plotFlush){2===i.channels?(e=i.buffer[1],n=i.buffer[2]):e=n=i.buffer[0];for(var r=new Float32Array(2048),s=0,o=e.length/2048,a=0;2048>a;a++)r[a]=.5*(e[0|s]+n[0|s]),s+=o;i.plotData=r,i.plotFlush=null}return l.call(this,t)},n.register("buffer",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.fixAR(this);var r=new i(this._.samplerate);r.setDelayTime(20),r.setRate(4),r.depth=20,r.feedback=.2,r.mix=.33,this._.chorus=r}var n=t.fn,i=t.modules.Chorus;n.extend(e);var r=e.prototype;Object.defineProperties(r,{type:{set:function(t){this._.chorus.setDelayTime(t)},get:function(){return this._.chorus.wave}},delay:{set:function(t){t>=.5&&80>=t&&this._.chorus.setDelayTime(t)},get:function(){return this._.chorus.delayTime}},rate:{set:function(t){"number"==typeof t&&t>0&&this._.chorus.setRate(t)},get:function(){return this._.chorus.rate}},depth:{set:function(t){"number"==typeof t&&t>=0&&100>=t&&(t*=this._.samplerate/44100,this._.chorus.depth=t)},get:function(){return this._.chorus.depth}},fb:{set:function(t){"number"==typeof t&&t>=-1&&1>=t&&(this._.chorus.feedback=.99996*t)},get:function(){return this._.chorus.feedback}},mix:{set:function(e){this._.mix=t(e)},get:function(){return this._.mix}}}),r.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,n.inputSignalAR(this),e.bypassed||e.chorus.process(this.cells[1],this.cells[2]),n.outputSignalAR(this)),this},n.register("chorus",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e);var n=this._;n.min=-.8,n.max=.8}var n=t.fn;n.extend(e);var i=e.prototype;Object.defineProperties(i,{minmax:{set:function(t){var e=this._;"number"==typeof t&&(e.min=-Math.abs(t),e.max=-e.min)},get:function(){return this._.max}},min:{set:function(t){var e=this._;"number"==typeof t&&(e.max<t?e.max=t:e.min=t)},get:function(){return this._.min}},max:{set:function(t){var e=this._;"number"==typeof t&&(t<e.min?e.min=t:e.max=t)},get:function(){return this._.max}}}),i.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,r,s=this.cells[1],o=this.cells[2],a=s.length,l=e.min,u=e.max;if(e.ar){for(n.inputSignalAR(this),i=0;a>i;++i)r=s[i],l>r?r=l:r>u&&(r=u),s[i]=r,r=o[i],l>r?r=l:r>u&&(r=u),o[i]=r;n.outputSignalAR(this)}else r=n.inputSignalKR(this),l>r?r=l:r>u&&(r=u),this.cells[0][0]=r,n.outputSignalKR(this)}return this},n.register("clip",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.fixAR(this);var i=this._;i.prevThresh=-24,i.prevKnee=30,i.prevRatio=12,i.thresh=t(i.prevThresh),i.knee=t(i.prevKnee),i.ratio=t(i.prevRatio),i.postGain=6,i.reduction=0,i.attack=3,i.release=25,i.comp=new r(i.samplerate),i.comp.dbPostGain=i.postGain,i.comp.setAttackTime(.001*i.attack),i.comp.setReleaseTime(.001*i.release),i.comp.setPreDelayTime(6),i.comp.setParams(i.prevThresh,i.prevKnee,i.prevRatio)}var n=t.fn,i=t.timevalue,r=t.modules.Compressor;n.extend(e);var s=e.prototype;Object.defineProperties(s,{thresh:{set:function(e){this._.thresh=t(e)},get:function(){return this._.thresh}},thre:{set:function(e){this._.thresh=t(e)},get:function(){return this._.thre}},knee:{set:function(e){this._.kne=t(e)},get:function(){return this._.knee}},ratio:{set:function(e){this._.ratio=t(e)},get:function(){return this._.ratio}},gain:{set:function(t){"number"==typeof t&&(this._.comp.dbPostGain=t)},get:function(){return this._.comp.dbPostGain}},attack:{set:function(t){"string"==typeof t&&(t=i(t)),"number"==typeof t&&(t=0>t?0:t>1e3?1e3:t,this._.attack=t,this._.comp.setAttackTime(.001*t))},get:function(){return this._.attack}},release:{set:function(t){"string"==typeof t&&(t=i(t)),"number"==typeof t&&(t=0>t?0:t>1e3?1e3:t,this._.release=t,this._.comp.setReleaseTime(.001*t))},get:function(){return this._.release}},reduction:{get:function(){return this._.reduction}}}),s.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,n.inputSignalAR(this);var i=e.thresh.process(t).cells[0][0],r=e.knee.process(t).cells[0][0],s=e.ratio.process(t).cells[0][0];(e.prevThresh!==i||e.prevKnee!==r||e.prevRatio!==s)&&(e.prevThresh=i,e.prevKnee=r,e.prevRatio=s,e.comp.setParams(i,r,s)),e.bypassed||(e.comp.process(this.cells[1],this.cells[2]),e.reduction=e.comp.meteringGain),n.outputSignalAR(this)}return this},n.register("comp",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.fixAR(this);var i=this._;i.time=t(100),i.fb=t(.2),i.cross=t(!1),i.mix=.33,i.delay=new r(i.samplerate)}var n=t.fn,i=t.timevalue,r=t.modules.StereoDelay;n.extend(e);var s=e.prototype;Object.defineProperties(s,{time:{set:function(e){"string"==typeof e&&(e=i(e)),this._.time=t(e)},get:function(){return this._.time}},fb:{set:function(e){this._.fb=t(e)},get:function(){return this._.fb}},cross:{set:function(e){this._.cross=t(e)},get:function(){return this._.cross}},mix:{set:function(t){"number"==typeof t&&(t=t>1?1:0>t?0:t,this._.mix=t)},get:function(){return this._.mix}}}),s.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i=e.time.process(t).cells[0][0],r=e.fb.process(t).cells[0][0],s=0!==e.cross.process(t).cells[0][0],o=e.mix;(e.prevTime!==i||e.prevFb!==r||e.prevCross!==s||e.prevMix!==o)&&(e.prevTime=i,e.prevFb=r,e.prevCross=s,e.prevMix=o,e.delay.setParams(i,r,s,o)),n.inputSignalAR(this),e.bypassed||e.delay.process(this.cells[1],this.cells[2]),n.outputSignalAR(this)}return this},n.register("delay",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.fixAR(this);var i=this._;i.pre=t(60),i.post=t(-18),i.x1L=i.x2L=i.y1L=i.y2L=0,i.x1R=i.x2R=i.y1R=i.y2R=0,i.b0=i.b1=i.b2=i.a1=i.a2=0,i.cutoff=0,i.Q=1,i.preScale=0,i.postScale=0}var n=t.fn;n.extend(e);var i=e.prototype;Object.defineProperties(i,{cutoff:{set:function(t){"number"==typeof t&&t>0&&(this._.cutoff=t)},get:function(){return this._.cutoff}},pre:{set:function(e){this._.pre=t(e)},get:function(){return this._.pre}},post:{set:function(e){this._.post=t(e)},get:function(){return this._.post}}}),i.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,n.inputSignalAR(this);var i=-e.pre.process(t).cells[0][0],s=-e.post.process(t).cells[0][0];if((e.prevPreGain!==i||e.prevPostGain!==s)&&(e.prevPreGain=i,e.prevPostGain=s,e.preScale=Math.pow(10,.05*-i),e.postScale=Math.pow(10,.05*-s)),!e.bypassed){var o,a,l,u,h,c=this.cells[1],f=this.cells[2],d=e.preScale,p=e.postScale;if(e.cutoff){e.prevCutoff!==e.cutoff&&(e.prevCutoff=e.cutoff,r(e));var m=e.x1L,g=e.x2L,v=e.y1L,b=e.y2L,y=e.x1R,_=e.x2R,w=e.y1R,x=e.y2R,A=e.b0,k=e.b1,S=e.b2,T=e.a1,C=e.a2;for(o=0,a=c.length;a>o;++o)u=c[o]*d,h=A*u+k*m+S*g-T*v-C*b,l=h*p,-1>l?l=-1:l>1&&(l=1),c[o]=l,g=m,m=u,b=v,v=h,u=f[o]*d,h=A*u+k*y+S*_-T*w-C*x,l=h*p,-1>l?l=-1:l>1&&(l=1),f[o]=l,_=y,y=u,x=w,w=h;e.x1L=m,e.x2L=g,e.y1L=v,e.y2L=b,e.x1R=y,e.x2R=_,e.y1R=w,e.y2R=x}else for(o=0,a=c.length;a>o;++o)l=c[o]*d*p,-1>l?l=-1:l>1&&(l=1),c[o]=l,l=f[o]*d*p,-1>l?l=-1:l>1&&(l=1),f[o]=l}n.outputSignalAR(this)}return this};var r=function(t){var e=2*Math.PI*t.cutoff/t.samplerate,n=Math.cos(e),i=Math.sin(e),r=i/(2*t.Q),s=1/(1+r);t.b0=.5*(1-n)*s,t.b1=1-n*s,t.b2=.5*(1-n)*s,t.a1=-2*n*s,t.a2=1-r*s};n.register("dist",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),this._.ar=!1}var n=t.fn;n.extend(e);var i=e.prototype;i.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,r,s,o,a,l,u=this.nodes,h=this.cells[0],c=this.cells[1],f=this.cells[2],d=u.length,p=h.length;if(e.ar){if(u.length>0)for(u[0].process(t),o=u[0].cells[1],a=u[0].cells[2],c.set(o),f.set(a),i=1;d>i;++i)for(u[i].process(t),o=u[i].cells[1],a=u[i].cells[2],r=0;p>r;++r)l=o[r],c[r]=0===l?0:c[r]/l,l=a[r],f[r]=0===l?0:f[r]/l;else for(r=0;p>r;++r)c[r]=f[i]=0;n.outputSignalAR(this)}else{if(u.length>0)for(s=u[0].process(t).cells[0][0],i=1;d>i;++i)l=u[i].process(t).cells[0][0],s=0===l?0:s/l;else s=0;h[0]=s,n.outputSignalKR(this)}}return this},n.register("/",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e);var n=this._;n.env=new s(n.samplerate),n.env.setStep(n.cellsize),n.tmp=new i.SignalArray(n.cellsize),n.ar=!1,n.plotFlush=!0,n.onended=l(this),this.on("ar",a)}function n(t,e,n,i,r,s){var o=n;return"number"==typeof t[i]?o=t[i]:"number"==typeof t[r]?o=t[r]:s&&("string"==typeof t[i]?o=s(t[i]):"string"==typeof t[r]&&(o=s(t[r]))),e>o&&(o=e),o}var i=t.fn,r=t.timevalue,s=t.modules.Envelope,o=i.isDictionary;i.extend(e);var a=function(t){this._.env.setStep(t?1:this._.cellsize)},l=function(t){return function(){t._.emit("ended")}},u=e.prototype;Object.defineProperties(u,{table:{set:function(t){Array.isArray(t)&&(h.call(this,t),this._.plotFlush=!0)},get:function(){return this._.env.table}},curve:{set:function(t){this._.env.setCurve(t)},get:function(){return this._.env.curve}},releaseNode:{set:function(t){this._.env.setReleaseNode(t),this._.plotFlush=!0},get:function(){return this._.env.releaseNode+1}},loopNode:{set:function(t){this._.env.setLoopNode(t),this._.plotFlush=!0},get:function(){return this._.env.loopNode+1}}}),u.clone=function(){var t=i.clone(this);return t._.env=this._.env.clone(),t},u.reset=function(){return this._.env.reset(),this},u.release=function(){var t=this._;return t.env.release(),t.emit("released"),this},u.bang=function(){var t=this._;return t.env.reset(),t.env.status=s.StatusGate,t.emit("bang"),this},u.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n,r=this.cells[1],s=this.cells[2],o=e.cellsize;if(this.nodes.length)i.inputSignalAR(this);else for(n=0;o>n;++n)r[n]=s[n]=1;var a,l=null;if(e.ar){var u=e.tmp;for(e.env.process(u),n=0;o>n;++n)r[n]*=u[n],s[n]*=u[n];l=e.env.emit}else{for(a=e.env.next(),n=0;o>n;++n)r[n]*=a,s[n]*=a;l=e.env.emit}i.outputSignalAR(this),l&&("ended"===l?i.nextTick(e.onended):this._.emit(l,e.value))}return this};var h=function(t){for(var e,n,i,o,a=this._.env,l=[t[0]||f],u=1,h=t.length;h>u;++u)e=t[u][0]||f,n=t[u][1],i=t[u][2],"number"!=typeof n&&(n="string"==typeof n?r(n):10),10>n&&(n=10),"number"==typeof i?(o=i,i=s.CurveTypeCurve):(i=s.CurveTypeDict[i]||null,o=0),l.push([e,n,i,o]);a.setTable(l)},c=t.Object.prototype.plot;u.plot=function(t){if(this._.plotFlush){var e,n,i=this._.env.clone(),r=i.getInfo(1e3),o=r.totalDuration,a=r.loopBeginTime,l=r.releaseBeginTime,u=new Float32Array(256),h=0,f=o/u.length,d=!1,p=.001*o*this._.samplerate|0;for(p/=u.length,i.setStep(p),i.status=s.StatusGate,e=0,n=u.length;n>e;++e)u[e]=i.next(),h+=f,!d&&h>=l&&(i.release(),d=!0);this._.plotData=u,this._.plotBefore=function(t,e,n,i,r){var s,u;1/0!==a&&1/0!==l&&(s=e+i*(a/o),u=e+i*(l/o),u-=s,t.fillStyle="rgba(224, 224, 224, 0.8)",t.fillRect(s,0,u,r)),1/0!==l&&(s=e+i*(l/o),u=i-s,t.fillStyle="rgba(212, 212, 212, 0.8)",t.fillRect(s,0,u,r))};var m=1/0,g=-1/0;for(e=0;n>e;++e)u[e]<m?m=u[e]:u[e]>g&&(g=u[e]);1>g&&(g=1),this._.plotRange=[m,g],this._.plotData=u,this._.plotFlush=null}return c.call(this,t)},i.register("env",e);var f=s.ZERO;i.register("perc",function(t){o(t[0])||t.unshift({});var i=t[0],s=n(i,10,10,"a","attackTime",r),a=n(i,10,1e3,"r","releaseTime",r),l=n(i,f,1,"lv","level");return i.table=[f,[l,s],[f,a]],new e(t)}),i.register("adsr",function(t){o(t[0])||t.unshift({});var i=t[0],s=n(i,10,10,"a","attackTime",r),a=n(i,10,300,"d","decayTime",r),l=n(i,f,.5,"s","sustainLevel"),u=n(i,10,1e3,"r","decayTime",r),h=n(i,f,1,"lv","level");return i.table=[f,[h,s],[l,a],[f,u]],i.releaseNode=3,new e(t)}),i.register("adshr",function(t){o(t[0])||t.unshift({});var i=t[0],s=n(i,10,10,"a","attackTime",r),a=n(i,10,300,"d","decayTime",r),l=n(i,f,.5,"s","sustainLevel"),u=n(i,10,500,"h","holdTime",r),h=n(i,10,1e3,"r","decayTime",r),c=n(i,f,1,"lv","level");return i.table=[f,[c,s],[l,a],[l,u],[f,h]],new e(t)}),i.register("asr",function(t){o(t[0])||t.unshift({});var i=t[0],s=n(i,10,10,"a","attackTime",r),a=n(i,f,.5,"s","sustainLevel"),l=n(i,10,1e3,"r","releaseTime",r);return i.table=[f,[a,s],[f,l]],i.releaseNode=2,new e(t)}),i.register("dadsr",function(t){o(t[0])||t.unshift({});var i=t[0],s=n(i,10,100,"dl","delayTime",r),a=n(i,10,10,"a","attackTime",r),l=n(i,10,300,"d","decayTime",r),u=n(i,f,.5,"s","sustainLevel"),h=n(i,10,1e3,"r","relaseTime",r),c=n(i,f,1,"lv","level");return i.table=[f,[f,s],[c,a],[u,l],[f,h]],i.releaseNode=4,new e(t)}),i.register("ahdsfr",function(t){o(t[0])||t.unshift({});var i=t[0],s=n(i,10,10,"a","attackTime",r),a=n(i,10,10,"h","holdTime",r),l=n(i,10,300,"d","decayTime",r),u=n(i,f,.5,"s","sustainLevel"),h=n(i,10,5e3,"f","fadeTime",r),c=n(i,10,1e3,"r","relaseTime",r),d=n(i,f,1,"lv","level");return i.table=[f,[d,s],[d,a],[u,l],[f,h],[f,c]],i.releaseNode=5,new e(t)}),i.register("linen",function(t){o(t[0])||t.unshift({});var i=t[0],s=n(i,10,10,"a","attackTime",r),a=n(i,10,1e3,"s","sustainTime",r),l=n(i,10,1e3,"r","releaseTime",r),u=n(i,f,1,"lv","level");return i.table=[f,[u,s],[u,a],[f,l]],new e(t)}),i.register("env.tri",function(t){o(t[0])||t.unshift({});var i=t[0],s=n(i,20,1e3,"dur","duration",r),a=n(i,f,1,"lv","level");return s*=.5,i.table=[f,[a,s],[f,s]],new e(t)}),i.register("env.cutoff",function(t){o(t[0])||t.unshift({});var i=t[0],s=n(i,10,100,"r","relaseTime",r),a=n(i,f,1,"lv","level");return i.table=[a,[f,s]],new e(t)})}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.fixAR(this);var i=this._;i.biquads=new Array(7),i.plotBefore=a,i.plotRange=[-18,18],i.plotFlush=!0}var n=t.fn,i=t.modules.FFT,r=t.modules.Biquad,s=20,o={hpf:0,lf:1,lmf:2,mf:3,hmf:4,hf:5,lpf:6};n.extend(e);var a=function(t,e,n,i,r){t.lineWidth=1,t.strokeStyle="rgb(192, 192, 192)";for(var o=.5*this._.samplerate,a=1;10>=a;++a)for(var l=1;4>=l;l++){var u=a*Math.pow(10,l);if(!(s>=u||u>=o)){t.beginPath();var h=Math.log(u/s)/Math.log(o/s);h=(h*i+e|0)+.5,t.moveTo(h,n),t.lineTo(h,n+r),t.stroke()}}var c=r/6;for(a=1;6>a;a++){t.beginPath();var f=(n+a*c|0)+.5;t.moveTo(e,f),t.lineTo(e+i,f),t.stroke()}},l=e.prototype;Object.defineProperties(l,{params:{set:function(t){if("object"==typeof t)for(var e=Object.keys(t),n=0,i=e.length;i>n;++n){var r=t[e[n]];Array.isArray(r)?this.setParams(e[n],r[0],r[1],r[2]):this.setParams(e[n])}}}}),l.setParams=function(t,e,n,i){var s=this._;if("string"==typeof t&&(t=o[t]),t>=0&&t<s.biquads.length){if(t|=0,"number"==typeof e&&"number"==typeof n){"number"!=typeof i&&(i=0);var a=s.biquads[t];if(!a)switch(a=s.biquads[t]=new r(s.samplerate),t){case 0:a.setType("highpass");break;case s.biquads.length-1:a.setType("lowpass");break;default:a.setType("peaking")}a.setParams(e,n,i)}else s.biquads[t]=void 0;s.plotFlush=!0}return this},l.getParams=function(t){var e=this._,n=e.biquads[0|t];return n?{freq:n.frequency,Q:n.Q,gain:n.gain}:void 0},l.process=function(t){var e=this._;if(this.tickID!==t){if(this.tickID=t,n.inputSignalAR(this),!e.bypassed)for(var i=this.cells[1],r=this.cells[2],s=e.biquads,o=0,a=s.length;a>o;++o)s[o]&&s[o].process(i,r);n.outputSignalAR(this)}return this};var u=new i(2048),h=t.Object.prototype.plot;l.plot=function(t){if(this._.plotFlush){var e=this._,n=new Float32Array(u.length);n[0]=1;for(var i=0,o=e.biquads.length;o>i;++i){var a=this.getParams(i);if(a){var l=new r(e.samplerate);l.setType(0===i?"highpass":i===o-1?"lowpass":"peaking"),l.setParams(a.freq,a.Q,a.gain),l.process(n,n)}}u.forward(n);var c,f,d,p,m,g,v,b=512,y=new Float32Array(b),_=.5*e.samplerate,w=new Float32Array(b);for(u.getFrequencyData(w),i=0;b>i;++i)f=Math.pow(_/s,i/b)*s,c=f/(_/w.length),d=0|c,p=c-d,0===d?g=m=v=w[d]:(m=w[d-1],g=w[d],v=(1-p)*m+p*g),y[i]=v;this._.plotData=y,this._.plotFlush=null}return h.call(this,t)},n.register("eq",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.listener(this),n.fixAR(this),this.real=new t.ChannelObject(this),this.imag=new t.ChannelObject(this),this.cells[3]=this.real.cell,this.cells[4]=this.imag.cell;var r=this._;r.fft=new i(2*r.cellsize),r.fftCell=new n.SignalArray(r.fft.length),r.prevCell=new n.SignalArray(r.cellsize),r.freqs=new n.SignalArray(r.fft.length>>1),r.plotFlush=!0,r.plotRange=[0,32],r.plotBarStyle=!0}var n=t.fn,i=t.modules.FFT;n.extend(e);var r=e.prototype;Object.defineProperties(r,{window:{set:function(t){this._.fft.setWindow(t)},get:function(){return this._.fft.windowName}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}}}),r.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,n.inputSignalAR(this),n.outputSignalAR(this);var i=this.cells[0],r=e.cellsize;e.fftCell.set(e.prevCell),e.fftCell.set(i,r),e.fft.forward(e.fftCell),e.prevCell.set(i),e.plotFlush=!0,this.cells[3].set(e.fft.real.subarray(0,r)),this.cells[4].set(e.fft.imag.subarray(0,r))}return this};var s=t.Object.prototype.plot;r.plot=function(t){return this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null),s.call(this,t)},n.register("fft",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),n.fixAR(this);var i=this._;i.freq=t(440),i.reg=32768,i.shortFlag=!1,i.phase=0,i.lastValue=0}var n=t.fn;n.extend(e);var i=e.prototype;Object.defineProperties(i,{shortFlag:{set:function(t){this._.shortFlag=!!t},get:function(){return this._.shortFlag}},freq:{set:function(e){this._.freq=t(e)},get:function(){return this._.freq}}}),i.process=function(t){var e=this._,n=this.cells[0];if(this.tickID!==t){this.tickID=t;var i,r,s=e.lastValue,o=e.phase,a=e.freq.process(t).cells[0][0]/e.samplerate,l=e.reg,u=e.mul,h=e.add;if(e.shortFlag)for(i=0,r=n.length;r>i;++i)o>=1&&(l>>=1,l|=(1&(l^l>>6))<<15,s=(1&l)-.5,o-=1),n[i]=s*u+h,o+=a;else for(i=0,r=n.length;r>i;++i)o>=1&&(l>>=1,l|=(1&(l^l>>1))<<15,s=(1&l)-.5,o-=1),n[i]=s*u+h,o+=a;e.reg=l,e.phase=o,e.lastValue=s}return this},n.register("fnoise",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.fixAR(this),this._.selected=0,this._.outputs=[]}var n=t.fn,i=function(){function e(e){t.Object.call(this,2,[]),n.fixAR(this),this._.parent=e}return n.extend(e),e.prototype.process=function(t){return this.tickID!==t&&(this.tickID=t,this._.parent.process(t)),this},e}();n.extend(e);var r=e.prototype;Object.defineProperties(r,{selected:{set:function(t){var e=this._;if("number"==typeof t){e.selected=t;for(var i=e.outputs,r=0,s=i.length;s>r;++r)i[r]&&(i[r].cells[0].set(n.emptycell),i[r].cells[1].set(n.emptycell),i[r].cells[2].set(n.emptycell))}},get:function(){return this._.selected}}}),r.at=function(t){var e=this._,n=e.outputs[t];return n||(e.outputs[t]=n=new i(this)),n},r.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,n.inputSignalAR(this),n.outputSignalAR(this);var i=e.outputs[e.selected];i&&(i.cells[0].set(this.cells[0]),i.cells[1].set(this.cells[1]),i.cells[2].set(this.cells[2]))}return this},n.register("gate",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),n.fixAR(this);var r=this._;r.fft=new i(2*r.cellsize),r.fftCell=new n.SignalArray(this._.fft.length),r.realBuffer=new n.SignalArray(this._.fft.length),r.imagBuffer=new n.SignalArray(this._.fft.length)}var n=t.fn,i=t.modules.FFT;n.extend(e);var r=e.prototype;Object.defineProperties(r,{real:{set:function(e){this._.real=t(e)},get:function(){return this._.real}},imag:{set:function(e){this._.imag=t(e)},get:function(){return this._.imag}}}),r.process=function(t){var e=this._;if(this.tickID!==t&&(this.tickID=t,e.real&&e.imag)){var i=this.cells[0],r=e.realBuffer,s=e.imagBuffer,o=e.real.process(t).cells[0],a=e.imag.process(t).cells[0];r.set(o),s.set(a),i.set(e.fft.inverse(r,s).subarray(0,e.cellsize)),n.outputSignalAR(this)}return this},n.register("ifft",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),n.timer(this),n.fixKR(this);var i=this._;i.interval=t(1e3),i.count=0,i.delay=0,i.timeout=1/0,i.currentTime=0,i.delaySamples=0,i.countSamples=0,i.onended=n.make_onended(this),this.on("start",r)}var n=t.fn,i=t.timevalue;n.extend(e);var r=function(){var t=this._;this.playbackState=n.PLAYING_STATE,t.delaySamples=.001*t.samplerate*t.delay|0,t.countSamples=t.count=t.currentTime=0};Object.defineProperty(r,"unremovable",{value:!0,writable:!1});var s=e.prototype;Object.defineProperties(s,{interval:{set:function(e){"string"==typeof e&&(e=i(e),0>=e&&(e=0)),this._.interval=t(e)},get:function(){return this._.interval}},delay:{set:function(t){"string"==typeof t&&(t=i(t)),"number"==typeof t&&t>=0&&(this._.delay=t,this._.delaySamples=.001*this._.samplerate*t|0)},get:function(){return this._.delay}},count:{set:function(t){"number"==typeof t&&(this._.count=t)},get:function(){return this._.count}},timeout:{set:function(t){"string"==typeof t&&(t=i(t)),"number"==typeof t&&t>=0&&(this._.timeout=t)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}}),s.bang=function(){var t=this._;return this.playbackState=n.PLAYING_STATE,t.delaySamples=.001*t.samplerate*t.delay|0,t.countSamples=t.count=t.currentTime=0,t.emit("bang"),this},s.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t,i.delaySamples>0&&(i.delaySamples-=e.length);var r=i.interval.process(t).cells[0][0];if(i.delaySamples<=0&&(i.countSamples-=e.length,i.countSamples<=0)){i.countSamples+=i.samplerate*r*.001|0;for(var s=this.nodes,o=i.count,a=o*i.mul+i.add,l=0,u=e.length;u>l;++l)e[l]=a;for(var h=0,c=s.length;c>h;++h)s[h].bang(o);i.count+=1}i.currentTime+=n.currentTimeIncr,i.currentTime>=i.timeout&&n.nextTick(i.onended)}return this},n.register("interval",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),n.fixAR(this);var i=this._,r=Math.ceil(Math.log(i.samplerate)*Math.LOG2E);i.buffersize=1<<r,i.buffermask=i.buffersize-1,i.buffer=new n.SignalArray(i.buffersize),i.time=0,i.readIndex=0,i.writeIndex=0}var n=t.fn,i=t.timevalue;n.extend(e);var r=e.prototype;Object.defineProperties(r,{time:{set:function(t){if("string"==typeof t&&(t=i(t)),"number"==typeof t&&t>0){var e=this._;e.time=t;var n=.001*t*e.samplerate|0;n>e.buffermask&&(n=e.buffermask),e.writeIndex=e.readIndex+n&e.buffermask}},get:function(){return this._.time}}}),r.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,n.inputSignalAR(this);var i,r=this.cells[0],s=e.buffer,o=e.buffermask,a=e.readIndex,l=e.writeIndex,u=r.length;for(i=0;u>i;++i)s[l]=r[i],r[i]=s[a],a+=1,l=l+1&o;e.readIndex=a&o,e.writeIndex=l,n.outputSignalAR(this)}return this},n.register("lag",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e);var n=this._;n.input=0,n.value=0,n.prev=null,n.ar=!1,n.map=i}var n=t.fn;n.extend(e);var i=function(t){return t},r=e.prototype;Object.defineProperties(r,{input:{set:function(t){"number"==typeof t&&(this._.input=t)},get:function(){return this._.input}},map:{set:function(t){"function"==typeof t&&(this._.map=t)},get:function(){return this._.map}}}),r.bang=function(){return this._.prev=null,this._.emit("bang"),this},r.at=function(t){return this._.map?this._.map(t):0},r.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var r,s=this.nodes.length,o=e.length;if(i.ar&&s){n.inputSignalAR(this);var a=i.map;if(a)for(r=0;o>r;++r)e[r]=a(e[r]);i.value=e[o-1],n.outputSignalAR(this)}else{var l=s?n.inputSignalKR(this):i.input;i.map&&i.prev!==l&&(i.prev=l,i.value=i.map(l));var u=i.value*i.mul+i.add;for(r=0;o>r;++r)e[r]=u}}return this},n.register("map",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e)}var n=t.fn;n.extend(e);var i=e.prototype;i.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var r,s,o,a,l=this.nodes,u=l.length,h=e.length;if(i.ar){if(l.length>0)for(o=l[0].process(t).cells[0],e.set(o),r=1;u>r;++r)for(o=l[r].process(t).cells[0],s=0;h>s;++s)a=o[s],e[s]<a&&(e[s]=a);else for(s=0;h>s;++s)e[s]=0;n.outputSignalAR(this)}else{if(l.length>0)for(o=l[0].process(t).cells[0][0],r=1;u>r;++r)a=l[r].process(t).cells[0][0],a>o&&(o=a);else o=0;e[0]=o,n.outputSignalKR(this)}}return this},n.register("max",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.fixAR(this);var r=this._;r.src=r.func=null,r.bufferL=new n.SignalArray(i),r.bufferR=new n.SignalArray(i),r.readIndex=0,r.writeIndex=0,r.totalRead=0,r.totalWrite=0}if("browser"===t.envtype){var n=t.fn,i=4096,r=i-1;n.extend(e);var s=e.prototype;s.listen=function(e){var n=o[t.env];n&&(n.set.call(this,e),n.listen.call(this))},s.unlisten=function(){var e=o[t.env];e&&e.unlisten.call(this),this.cells[0].set(n.emptycell),this.cells[1].set(n.emptycell),this.cells[2].set(n.emptycell);for(var i=this._,r=i.bufferL,s=i.bufferR,a=0,l=r.length;l>a;++a)r[a]=s[a]=0},s.process=function(t){var e=this._;if(null===e.src)return this;if(this.tickID!==t){this.tickID=t;var i=e.cellsize;if(e.totalWrite>e.totalRead+i){var s=e.readIndex,o=s+i;this.cells[1].set(e.bufferL.subarray(s,o)),this.cells[2].set(e.bufferR.subarray(s,o)),e.readIndex=o&r,e.totalRead+=i}n.outputSignalAR(this)}return this};var o={};o.webkit={set:function(t){var e=this._;if(t instanceof HTMLMediaElement){var i=n._audioContext;e.src=i.createMediaElementSource(t)}},listen:function(){var t=this._,e=n._audioContext;t.gain=e.createGainNode(),t.gain.gain.value=0,t.node=e.createJavaScriptNode(1024,2,2),t.node.onaudioprocess=a(this),t.src.connect(t.node),t.node.connect(t.gain),t.gain.connect(e.destination)},unlisten:function(){var t=this._;t.src&&t.src.disconnect(),t.gain&&t.gain.disconnect(),t.node&&t.node.disconnect()}};var a=function(t){return function(e){var n=t._,i=e.inputBuffer,s=i.length,o=n.writeIndex;n.bufferL.set(i.getChannelData(0),o),n.bufferR.set(i.getChannelData(1),o),
n.writeIndex=o+s&r,n.totalWrite+=s}};o.moz={set:function(t){var e=this._;t instanceof HTMLAudioElement&&(e.src=t,e.istep=e.samplerate/t.mozSampleRate)},listen:function(){var t=this._,e=t.bufferL,n=t.bufferR,i=0,s=0;2===t.src.mozChannels?(t.x=0,t.func=function(o){var a,l,u=t.writeIndex,h=t.totalWrite,c=o.frameBuffer,f=t.istep,d=c.length;for(a=t.x,l=0;d>l;l+=2){for(a+=f;a>0;)e[u]=.5*(c[l]+i),n[u]=.5*(c[l+1]+s),u=u+1&r,++h,a-=1;i=c[l],s=c[l+1]}t.x=a,t.writeIndex=u,t.totalWrite=h}):(t.x=0,t.func=function(s){var o,a,l=t.writeIndex,u=t.totalWrite,h=s.frameBuffer,c=t.istep,f=h.length;for(o=t.x,a=0;f>a;++a){for(o+=c;o>=0;)e[l]=n[l]=.5*(h[a]+i),l=l+1&r,++u,o-=1;i=h[a]}t.x=o,t.writeIndex=l,t.totalWrite=u}),t.src.addEventListener("MozAudioAvailable",t.func)},unlisten:function(){var t=this._;t.func&&(t.src.removeEventListener("MozAudioAvailable",t.func),t.func=null)}},n.register("mediastream",e)}}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e);var n=this._;n.midi=0,n.value=0,n.prev=null,n.a4=440,n.ar=!1}var n=t.fn;n.extend(e);var i=e.prototype;Object.defineProperties(i,{midi:{set:function(t){"number"==typeof t&&(this._.midi=t)},get:function(){return this._.midi}},a4:{set:function(t){"number"==typeof t&&(this._.a4=t,this._.prev=null)},get:function(){return this._.a4}}}),i.bang=function(){return this._.prev=null,this._.emit("bang"),this},i.at=function(t){var e=this._;return e.a4*Math.pow(2,(t-69)/12)},i.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,r=this.cells[0],s=this.nodes.length,o=r.length;if(e.ar&&s){n.inputSignalAR(this);var a=e.a4;for(i=0;o>i;++i)r[i]=a*Math.pow(2,(r[i]-69)/12);e.value=r[o-1],n.outputSignalAR(this)}else{var l=s?n.inputSignalKR(this):e.midi;e.prev!==l&&(e.prev=l,e.value=e.a4*Math.pow(2,(l-69)/12)),r[0]=e.value,n.outputSignalKR(this)}}return this},n.register("midicps",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e);var n=this._;n.midi=0,n.value=0,n.prev=null,n.range=12,n.ar=!1}var n=t.fn;n.extend(e);var i=e.prototype;Object.defineProperties(i,{midi:{set:function(t){"number"==typeof t&&(this._.midi=t)},get:function(){return this._.midi}},range:{set:function(t){"number"==typeof t&&t>0&&(this._.range=t)},get:function(){return this._.range}}}),i.bang=function(){return this._.prev=null,this._.emit("bang"),this},i.at=function(t){var e=this._;return Math.pow(2,t/e.range)},i.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var r,s=this.nodes.length,o=e.length;if(i.ar&&s){n.inputSignalAR(this);var a=i.range;for(r=0;o>r;++r)e[r]=Math.pow(2,e[r]/a);i.value=e[o-1],n.outputSignalAR(this)}else{var l=this.nodes.length?n.inputSignalKR(this):i.midi;i.prev!==l&&(i.prev=l,i.value=Math.pow(2,l/i.range));var u=i.value*i.mul+i.add;for(r=0;o>r;++r)e[r]=u}}return this},n.register("midiratio",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e)}var n=t.fn;n.extend(e);var i=e.prototype;i.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var r,s,o,a,l=this.nodes,u=l.length,h=e.length;if(i.ar){if(l.length>0)for(o=l[0].process(t).cells[0],e.set(o),r=1;u>r;++r)for(o=l[r].process(t).cells[0],s=0;h>s;++s)a=o[s],e[s]>a&&(e[s]=a);else for(s=0;h>s;++s)e[s]=0;n.outputSignalAR(this)}else{if(l.length>0)for(o=l[0].process(t).cells[0][0],r=1;u>r;++r)a=l[r].process(t).cells[0][0],o>a&&(o=a);else o=0;e[0]=o,n.outputSignalKR(this)}}return this},n.register("min",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,0,e),n.timer(this),n.fixKR(this);var r=this._;r.tracks=[],r.onended=n.make_onended(this),r.currentTime=0,this.on("start",i)}var n=t.fn;n.extend(e);var i=function(){var t=this,e=this._,i=e.mml;"string"==typeof i&&(i=[i]),e.tracks=i.map(function(e,n){return new s(t,n,e)}),e.currentTime=0,this.playbackState=n.PLAYING_STATE};Object.defineProperty(i,"unremoved",{value:!0,writable:!1});var r=e.prototype;Object.defineProperties(r,{mml:{set:function(t){var e=this._;("string"==typeof t||Array.isArray(t))&&(e.mml=t)},get:function(){return this._.mml}},currentTime:{get:function(){return this._.currentTime}}}),r.on=r.addListener=function(t,e){return"mml"===t&&(t="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener.")),this._.events.on(t,e),this},r.once=function(t,e){return"mml"===t&&(t="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener.")),this._.events.once(t,e),this},r.off=r.removeListener=function(t,e){return"mml"===t&&(t="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener.")),this._.events.off(t,e),this},r.removeAllListeners=function(t){return"mml"===t&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),t="data"),this._.events.removeAllListeners(t),this},r.listeners=function(t){return"mml"===t&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),t="data"),this._.events.listeners(t)},r.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,r,s=e.tracks;for(i=0,r=s.length;r>i;++i)s[i].process();for(;i--;)s[i].ended&&s.splice(i,1);0===s.length&&n.nextTick(e.onended),e.currentTime+=n.currentTimeIncr}return this},n.register("mml",e);var s=function(){function t(t,e,n){var i=this._={};i.sequencer=t,i.trackNum=e,i.commands=h(n),i.status={t:120,l:4,o:4,v:12,q:6,dot:0,tie:!1},i.index=0,i.queue=[],i.currentTime=0,i.queueTime=0,i.segnoIndex=-1,i.loopStack=[],i.prevNote=0,i.remain=1/0,this.ended=!1,u(this)}var e=0,i=1,r=2,s=3;t.prototype.process=function(){var t=this._,h=t.sequencer,c=t.trackNum,f=t.queue,d=!1;if(f.length)for(;f[0][0]<=t.currentTime;){var p=t.queue.shift();switch(p[1]){case i:o(h,c,p[2],p[3]),t.remain=p[4],u(this);break;case r:a(h,c,p[2],p[3]);break;case s:l(h,p[2]);break;case e:d=!0}if(0===f.length)break}t.remain-=n.currentTimeIncr,d&&(this.ended=!0),t.currentTime+=n.currentTimeIncr};var o=function(t,e,n,i){var r,s,o,a=t.nodes;for(s=0,o=a.length;o>s;++s)r=a[s],r.noteOn?r.noteOn(n,i):r.bang();t._.emit("data","noteOn",{trackNum:e,noteNum:n,velocity:i})},a=function(t,e,n,i){var r,s,o,a=t.nodes;for(s=0,o=a.length;o>s;++s)r=a[s],r.noteOff?r.noteOff(n,i):r.release&&r.release();t._.emit("data","noteOff",{trackNum:e,noteNum:n,velocity:i})},l=function(t,e){t._.emit("data","command",{command:e})},u=function(t){var n,o,a,l,u,h,c,f,d,p,m,g,v,b=t._,y=(b.sequencer,b.commands),_=b.queue,w=b.index,x=b.status,A=b.queueTime,k=b.loopStack;d=[];t:for(;;){if(y.length<=w){if(!(b.segnoIndex>=0))break;w=b.segnoIndex}switch(n=y[w++],n.name){case"@":_.push([A,s,n.val]);break;case"n":if(o=x.t||120,null!==n.len?(l=n.len,u=n.dot||0):(l=x.l,u=n.dot||x.dot),c=60/o*(4/l)*1e3,c*=[1,1.5,1.75,1.875][u]||1,h=x.v<<3,x.tie){for(g=_.length;g--;)if(_[g][2]){_.splice(g,1);break}a=b.prevNote}else a=b.prevNote=n.val+12*(x.o+1),_.push([A,i,a,h,c]);if(l>0){if(f=x.q/8,1>f)for(p=A+c*f,_.push([p,r,a,h]),g=0,v=d.length;v>g;++g)_.push([p,r,d[g],h]);if(d=[],A+=c,!x.tie)break t}else d.push(a);x.tie=!1;break;case"r":o=x.t||120,null!==n.len?(l=n.len,u=n.dot||0):(l=x.l,u=n.dot||x.dot),l>0&&(c=60/o*(4/l)*1e3,c*=[1,1.5,1.75,1.875][u]||1,A+=c);break;case"l":x.l=n.val,x.dot=n.dot;break;case"o":x.o=n.val;break;case"<":x.o<9&&(x.o+=1);break;case">":x.o>0&&(x.o-=1);break;case"v":x.v=n.val;break;case"(":x.v<15&&(x.v+=1);break;case")":x.v>0&&(x.v-=1);break;case"q":x.q=n.val;break;case"&":x.tie=!0;break;case"$":b.segnoIndex=w;break;case"[":k.push([w,null,null]);break;case"|":m=k[k.length-1],m&&1===m[1]&&(k.pop(),w=m[2]);break;case"]":m=k[k.length-1],m&&(null===m[1]&&(m[1]=n.count,m[2]=w),m[1]-=1,0===m[1]?k.pop():w=m[0]);break;case"t":x.t=null===n.val?120:n.val;break;case"EOF":_.push([A,e])}}b.index=w,b.queueTime=A},h=function(t){var e,n,i,r,s,o,a,l,u=new Array(t.length),h=[];for(s=0,o=c.length;o>s;++s)for(e=c[s],n=e.re;i=n.exec(t);){if(!u[i.index]){for(a=0,l=i[0].length;l>a;++a)u[i.index+a]=!0;r=e.func?e.func(i):{name:i[0]},r&&(r.index=i.index,r.origin=i[0],h.push(r))}for(;n.lastIndex<t.length&&u[n.lastIndex];)++n.lastIndex}return h.sort(function(t,e){return t.index-e.index}),h.push({name:"EOF"}),h},c=[{re:/@(\d*)/g,func:function(t){return{name:"@",val:t[1]||null}}},{re:/([cdefgab])([\-+]?)(\d*)(\.*)/g,func:function(t){return{name:"n",val:{c:0,d:2,e:4,f:5,g:7,a:9,b:11}[t[1]]+({"-":-1,"+":1}[t[2]]||0),len:""===t[3]?null:Math.min(0|t[3],64),dot:t[4].length}}},{re:/r(\d*)(\.*)/g,func:function(t){return{name:"r",len:""===t[1]?null:Math.max(1,Math.min(0|t[1],64)),dot:t[2].length}}},{re:/&/g},{re:/l(\d*)(\.*)/g,func:function(t){return{name:"l",val:""===t[1]?4:Math.min(0|t[1],64),dot:t[2].length}}},{re:/o([0-9])/g,func:function(t){return{name:"o",val:""===t[1]?4:0|t[1]}}},{re:/[<>]/g},{re:/v(\d*)/g,func:function(t){return{name:"v",val:""===t[1]?12:Math.min(0|t[1],15)}}},{re:/[()]/g},{re:/q([0-8])/g,func:function(t){return{name:"q",val:""===t[1]?6:Math.min(0|t[1],8)}}},{re:/\[/g},{re:/\|/g},{re:/\](\d*)/g,func:function(t){return{name:"]",count:0|t[1]||2}}},{re:/t(\d*)/g,func:function(t){return{name:"t",val:""===t[1]?null:Math.max(5,Math.min(0|t[1],300))}}},{re:/\$/g}];return t}()}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e)}var n=t.fn;n.extend(e),e.prototype.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,e.ar?(n.inputSignalAR(this),n.outputSignalAR(this)):(this.cells[0][0]=n.inputSignalKR(this),n.outputSignalKR(this))),this},n.register("mono",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e)}var n=t.fn;n.extend(e);var i=e.prototype;i.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,r,s,o,a,l=this.nodes,u=this.cells[0],h=this.cells[1],c=this.cells[2],f=l.length,d=u.length;if(e.ar){if(l.length>0)for(l[0].process(t),o=l[0].cells[1],a=l[0].cells[2],h.set(o),c.set(a),i=1;f>i;++i)for(l[i].process(t),o=l[i].cells[1],a=l[i].cells[2],r=0;d>r;++r)h[r]*=o[r],c[r]*=a[r];else for(r=0;d>r;++r)h[r]=c[r]=0;n.outputSignalAR(this)}else{if(l.length>0)for(s=l[0].process(t).cells[0][0],i=1;f>i;++i)s*=l[i].process(t).cells[0][0];else s=0;u[0]=s,n.outputSignalKR(this)}}return this},n.register("*",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e);var n=this._;n.defaultValue=0,n.index=0,n.dict={},n.ar=!1}var n=t.fn;n.extend(e);var i=e.prototype;Object.defineProperties(i,{dict:{set:function(t){if("object"==typeof t)this._.dict=t;else if("function"==typeof t){for(var e={},n=0;128>n;++n)e[n]=t(n);this._.dict=e}},get:function(){return this._.dict}},defaultValue:{set:function(t){"number"==typeof t&&(this._.defaultValue=t)},get:function(){return this._.defaultValue}},index:{set:function(t){"number"==typeof t&&(this._.index=t)},get:function(){return this._.index}}}),i.at=function(t){var e=this._;return(e.dict[0|t]||e.defaultValue)*e.mul+e.add},i.clear=function(){return this._.dict={},this},i.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var r,s,o,a=this.nodes.length,l=i.dict,u=i.defaultValue,h=i.mul,c=i.add,f=e.length;if(i.ar&&a){for(n.inputSignalAR(this),o=0;f>o;++o)r=e[o],r=0>r?r-.5|0:r+.5|0,e[o]=(l[r]||u)*h+c;n.outputSignalAR(this)}else for(r=this.nodes.length?n.inputSignalKR(this):i.index,r=0>r?r-.5|0:r+.5|0,s=(l[r]||u)*h+c,o=0;f>o;++o)e[o]=s}return this},n.register("ndict",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e)}var n=t.fn;n.extend(e);var i=e.prototype;i.process=function(t){var e=this.cells[0],n=this._;if(this.tickID!==t){this.tickID=t;var i,r,s,o=n.mul,a=n.add;if(n.ar)for(i=0,r=e.length;r>i;++i)e[i]=(2*Math.random()-1)*o+a;else for(s=(2*Math.random()+1)*o+a,i=0,r=e.length;r>i;++i)e[i]=s}return this},n.register("noise",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e);var i=this._;i.freq=t(440),i.phase=t(0),i.osc=new r(i.samplerate),i.tmp=new n.SignalArray(i.cellsize),i.osc.step=i.cellsize,this.once("init",s)}var n=t.fn,i=t.timevalue,r=t.modules.Oscillator;n.extend(e);var s=function(){var t=this._;this.wave||(this.wave="sin"),t.plotData=t.osc.wave,t.plotLineWidth=2,t.plotCyclic=!0,t.plotBefore=a},o=e.prototype;Object.defineProperties(o,{wave:{set:function(t){this._.osc.setWave(t)},get:function(){return this._.osc.wave}},freq:{set:function(e){"string"==typeof e&&(e=i(e),e=0>=e?0:1e3/e),this._.freq=t(e)},get:function(){return this._.freq}},phase:{set:function(e){this._.phase=t(e),this._.osc.feedback=!1},get:function(){return this._.phase}},fb:{set:function(e){this._.phase=t(e),this._.osc.feedback=!0},get:function(){return this._.phase}}}),o.clone=function(){var t=n.clone(this);return t._.osc=this._.osc.clone(),t._.freq=this._.freq,t._.phase=this._.phase,t},o.bang=function(){return this._.osc.reset(),this._.emit("bang"),this},o.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,r=this.cells[1],s=this.cells[2],o=e.cellsize;if(this.nodes.length)n.inputSignalAR(this);else for(i=0;o>i;++i)r[i]=s[i]=1;var a=e.osc,l=e.freq.process(t).cells[0],u=e.phase.process(t).cells[0];if(a.frequency=l[0],a.phase=u[0],e.ar){var h=e.tmp;for(e.freq.isAr?e.phase.isAr?a.processWithFreqAndPhaseArray(h,l,u):a.processWithFreqArray(h,l):e.phase.isAr?a.processWithPhaseArray(h,u):a.process(h),i=0;o>i;++i)r[i]*=h[i],s[i]*=h[i]}else{var c=a.next();for(i=0;o>i;++i)r[i]*=c,s[i]*=c}n.outputSignalAR(this)}return this};var a;"browser"===t.envtype&&(a=function(t,e,n,i,r){var s=(r>>1)+.5;t.strokeStyle="#ccc",t.lineWidth=1,t.beginPath(),t.moveTo(e,s+n),t.lineTo(e+i,s+n),t.stroke()}),n.register("osc",e),n.register("sin",function(t){return new e(t).set("wave","sin")}),n.register("cos",function(t){return new e(t).set("wave","cos")}),n.register("pulse",function(t){return new e(t).set("wave","pulse")}),n.register("tri",function(t){return new e(t).set("wave","tri")}),n.register("saw",function(t){return new e(t).set("wave","saw")}),n.register("fami",function(t){return new e(t).set("wave","fami")}),n.register("konami",function(t){return new e(t).set("wave","konami")}),n.register("+sin",function(t){return new e(t).set("wave","+sin").kr()}),n.register("+pulse",function(t){return new e(t).set("wave","+pulse").kr()}),n.register("+tri",function(t){return new e(t).set("wave","+tri").kr()}),n.register("+saw",function(t){return new e(t).set("wave","+saw").kr()}),n.alias("square","pulse")}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.fixAR(this);var i=this._;i.pos=t(0),i.panL=.5,i.panR=.5}var n=t.fn;n.extend(e);var i=e.prototype;Object.defineProperties(i,{pos:{set:function(e){this._.pos=t(e)},get:function(){return this._.pos}}}),i.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i=e.pos.process(t).cells[0][0];e.prevPos!==i&&(e.panL=1-i,e.panR=e.prevPos=i);var r,s,o,a=this.nodes,l=this.cells[1],u=this.cells[2],h=a.length,c=l.length;if(h){for(o=a[0].process(t).cells[0],s=0;c>s;++s)l[s]=u[s]=o[s];for(r=1;h>r;++r)for(o=a[r].process(t).cells[0],s=0;c>s;++s)l[s]=u[s]+=o[s];var f=e.panL,d=e.panR;for(s=0;c>s;++s)l[s]=l[s]*f,u[s]=u[s]*d}else l.set(n.emptycell),u.set(n.emptycell);n.outputSignalAR(this)}return this},n.register("pan",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e);var n=this._;n.value=0,n.env=new s(n.samplerate),n.env.step=n.cellsize,n.curve="lin",n.counter=0,n.ar=!1,n.onended=o(this),this.on("ar",a)}var n=t.fn,i=t.timevalue,r=t.modules.Envelope,s=t.modules.EnvelopeValue;n.extend(e);var o=function(t,e){return function(){if("number"==typeof e)for(var n=t.cells[0],i=t.cells[1],r=t.cells[2],s=t._.env.value,o=0,a=i.length;a>o;++o)n[0]=i[o]=r[o]=s;t._.emit("ended")}},a=function(t){this._.env.step=t?1:this._.cellsize},l=e.prototype;Object.defineProperties(l,{value:{set:function(t){"number"==typeof t&&(this._.env.value=t)},get:function(){return this._.env.value}}}),l.to=function(t,e,n){var s=this._,o=s.env;if("string"==typeof e?e=i(e):"undefined"==typeof e&&(e=0),"undefined"==typeof n)s.counter=o.setNext(t,e,r.CurveTypeLin),s.curve="lin";else{var a=r.CurveTypeDict[n];s.counter="undefined"==typeof a?o.setNext(t,e,r.CurveTypeCurve,n):o.setNext(t,e,a),s.curve=n}return s.plotFlush=!0,this},l.setAt=function(t,e){var n=this._;return this.to(n.env.value,e,"set"),n.atValue=t,this},l.linTo=function(t,e){return this.to(t,e,"lin")},l.expTo=function(t,e){return this.to(t,e,"exp")},l.sinTo=function(t,e){return this.to(t,e,"sin")},l.welTo=function(t,e){return this.to(t,e,"wel")},l.sqrTo=function(t,e){return this.to(t,e,"sqr")},l.cubTo=function(t,e){return this.to(t,e,"cub")},l.cancel=function(){var t=this._;return t.counter=t.env.setNext(t.env.value,0,r.CurveTypeSet),this},l.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,s,o=this.cells[1],a=this.cells[2],l=e.cellsize,u=e.env,h=e.counter;if(this.nodes.length)n.inputSignalAR(this);else for(i=0;l>i;++i)o[i]=a[i]=1;if(0>=h&&("set"===e.curve?u.setNext(e.atValue,0,r.CurveTypeSet):u.setNext(u.value,0,r.CurveTypeSet),n.nextTick(e.onended),e.counter=1/0),e.ar){for(i=0;l>i;++i)s=u.next(),o[i]*=s,a[i]*=s;e.counter-=e.cellsize}else{for(s=u.next(),i=0;l>i;++i)o[i]*=s,a[i]*=s;e.counter-=1}n.outputSignalAR(this),e.value=s}return this};var u=t.Object.prototype.plot;l.plot=function(t){var e=this._;if(e.plotFlush){var n,i,o,a=new s(128),l=new Float32Array(128);if("set"===e.curve)for(i=100,o=l.length;o>i;++i)l[i]=1;else for(n=r.CurveTypeDict[e.curve],"undefined"==typeof n?a.setNext(1,1e3,r.CurveTypeCurve,e.curve):a.setNext(1,1e3,n),i=0,o=l.length;o>i;++i)l[i]=a.next();e.plotData=l,e.plotRange=[0,1],e.plotFlush=null}return u.call(this,t)},n.register("param",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.fixAR(this);var i=this._;i.freq=t("sin",{freq:1,add:1e3,mul:250}).kr(),i.Q=t(1),i.allpass=[],this.steps=2}var n=t.fn,i=t.modules.Biquad;n.extend(e);var r=e.prototype;Object.defineProperties(r,{freq:{set:function(t){this._.freq=t},get:function(){return this._.freq}},Q:{set:function(e){this._.Q=t(e)},get:function(){return this._.Q}},steps:{set:function(t){if("number"==typeof t){if(t|=0,2===t||4===t||8===t||12===t){var e=this._.allpass;if(e.length<t)for(var n=e.length;t>n;++n)e[n]=new i(this._.samplerate),e[n].setType("allpass")}this._.steps=t}},get:function(){return this._.steps}}}),r.process=function(t){var e=this._;if(this.tickID!==t){if(this.tickID=t,n.inputSignalAR(this),!e.bypassed){var i,r=this.cells[1],s=this.cells[2],o=e.freq.process(t).cells[0][0],a=e.Q.process(t).cells[0][0],l=e.steps;for(i=0;l>i;i+=2)e.allpass[i].setParams(o,a,0),e.allpass[i].process(r,s),e.allpass[i+1].setParams(o,a,0),e.allpass[i+1].process(r,s)}n.outputSignalAR(this)}return this},n.register("phaser",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),i.fixAR(this);for(var n=new Uint8Array(5),r=0;5>r;++r)n[r]=(Math.random()*(1<<30)|0)%25;this._.whites=n,this._.key=0}var n=31,i=t.fn;i.extend(e);var r=e.prototype;r.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var r,s,o,a,l,u,h=i.key,c=i.whites,f=i.mul,d=i.add;for(r=0,s=e.length;s>r;++r){for(a=h++,h>n&&(h=0),u=a^h,o=l=0;5>o;++o)u&1<<o&&(c[o]=(Math.random()*(1<<30)|0)%25),l+=c[o];e[r]=(.01666666*l-1)*f+d}i.key=h}return this},i.register("pink",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),this._.freq=440,this._.buffer=null,this._.index=0}var n=t.fn;n.extend(e);var i=e.prototype;Object.defineProperties(i,{freq:{set:function(t){"number"==typeof t&&(0>t&&(t=0),this._.freq=t)},get:function(){return this._.freq}}}),i.bang=function(){for(var t=this._,e=t.freq,i=t.samplerate/e+.5|0,r=t.buffer=new n.SignalArray(i),s=0;i>s;++s)r[s]=2*Math.random()-1;return t.index=0,t.emit("bang"),this},i.process=function(t){var e=this.cells[0],n=this._;if(this.tickID!==t){this.tickID=t;var i=n.buffer;if(i){var r,s,o,a=i.length,l=n.index,u=n.mul,h=n.add,c=e.length;for(o=0;c>o;++o)r=l,s=i[l++],l>=a&&(l=0),s=.5*(s+i[l]),i[r]=s,e[o]=s*u+h;n.index=l}}return this},n.register("pluck",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),n.listener(this),n.fixAR(this);var i=this._;i.timeout=5e3,i.status=r,i.writeIndex=0,i.writeIndexIncr=1,i.currentTime=0,i.currentTimeIncr=1e3/i.samplerate,i.onended=o(this)}var n=t.fn,i=t.timevalue,r=0,s=1;n.extend(e);var o=function(t){return function(){var e=t._,i=new n.SignalArray(e.buffer.subarray(0,0|e.writeIndex));e.status=r,e.writeIndex=0,e.currentTime=0,e.emit("ended",{buffer:i,samplerate:e.samplerate})}},a=e.prototype;Object.defineProperties(a,{timeout:{set:function(t){"string"==typeof t&&(t=i(t)),"number"==typeof t&&t>0&&(this._.timeout=t)},get:function(){return this._.timeout}},samplerate:{set:function(t){"number"==typeof t&&t>0&&t<=this._.samplerate&&(this._.samplerate=t)},get:function(){return this._.samplerate}},currentTime:{get:function(){return this._.currentTime}}}),a.start=function(){var e,i=this._;return i.status===r&&(e=.01*i.timeout*i.samplerate|0,(!i.buffer||i.buffer.length<e)&&(i.buffer=new n.SignalArray(e)),i.writeIndex=0,i.writeIndexIncr=i.samplerate/t.samplerate,i.currentTime=0,i.status=s,i.emit("start"),this.listen()),this},a.stop=function(){var t=this._;return t.status===s&&(t.status=r,t.emit("stop"),n.nextTick(t.onended),this.unlisten()),this},a.bang=function(){return this._.status===r?this.srart():this._.status===s&&this.stop(),this._.emit("bang"),this},a.process=function(t){var e=this._,i=this.cells[0];if(this.tickID!==t){if(this.tickID=t,n.inputSignalAR(this),e.status===s){var r,o=i.length,a=e.buffer,l=e.timeout,u=e.writeIndex,h=e.writeIndexIncr,c=e.currentTime,f=e.currentTimeIncr;for(r=0;o>r;++r)a[0|u]=i[r],u+=h,c+=f,c>=l&&n.nextTick(e.onended);e.writeIndex=u,e.currentTime=c}n.outputSignalAR(this)}return this},n.register("record",e),n.alias("rec","record")}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.fixAR(this),this._.reverb=new i(this._.samplerate,this._.cellsize)}var n=t.fn,i=t.modules.Reverb;n.extend(e);var r=e.prototype;Object.defineProperties(r,{room:{set:function(t){"number"==typeof t&&(t=t>1?1:0>t?0:t,this._.reverb.setRoomSize(t))},get:function(){return this._.reverb.roomsize}},damp:{set:function(t){"number"==typeof t&&(t=t>1?1:0>t?0:t,this._.reverb.setDamp(t))},get:function(){return this._.reverb.damp}},mix:{set:function(t){"number"==typeof t&&(t=t>1?1:0>t?0:t,this._.reverb.wet=t)},get:function(){return this._.reverb.wet}}}),r.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,n.inputSignalAR(this),e.bypassed||e.reverb.process(this.cells[1],this.cells[2]),n.outputSignalAR(this)),this},n.register("reverb",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,0,e),n.timer(this),n.fixKR(this);var i=this._;i.queue=[],i.currentTime=0,i.maxRemain=1e3}var n=t.fn,i=t.timevalue;n.extend(e);var r=e.prototype;Object.defineProperties(r,{queue:{get:function(){return this._.queue}},remain:{get:function(){return this._.queue.length}},maxRemain:{set:function(t){"number"==typeof t&&t>0&&(this._.maxRemain=t)},get:function(){return this._.maxRemain}},isEmpty:{get:function(){return 0===this._.queue.length}},currentTime:{get:function(){return this._.currentTime}}}),r.sched=function(t,e,n){return"string"==typeof t&&(t=i(t)),"number"==typeof t&&this.schedAbs(this._.currentTime+t,e,n),this},r.schedAbs=function(e,n,r){if("string"==typeof e&&(e=i(e)),"number"==typeof e){var s=this._,o=s.queue;if(o.length>=s.maxRemain)return this;for(var a=o.length;a--&&!(o[a][0]<e););o.splice(a+1,0,[e,t(n),r])}return this},r.advance=function(t){return"string"==typeof t&&(t=i(t)),"number"==typeof t&&(this._.currentTime+=t),this},r.clear=function(){return this._.queue.splice(0),this},r.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i=null,r=e.queue;if(r.length)for(;r[0][0]<e.currentTime;){var s=e.queue.shift();if(s[1].bang(s[2]),i="sched",0===r.length){i="empty";break}}e.currentTime+=n.currentTimeIncr,i&&e.emit(i)}return this},n.register("schedule",e),n.alias("sched","schedule")}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.listener(this),n.fixAR(this);var i=this._;i.samples=0,i.writeIndex=0,i.plotFlush=!0,this.once("init",r)}var n=t.fn,i=t.timevalue;n.extend(e);var r=function(){this._.buffer||(this.size=1024),this._.interval||(this.interval=1e3)},s=e.prototype;Object.defineProperties(s,{size:{set:function(t){var e=this._;if(!e.buffer&&"number"==typeof t){var i=64>t?64:t>2048?2048:t;e.buffer=new n.SignalArray(i),e.reservedinterval&&(this.interval=e.reservedinterval,e.reservedinterval=null)}},get:function(){return this._.buffer.length}},interval:{set:function(t){var e=this._;"string"==typeof t&&(t=i(t)),"number"==typeof t&&t>0&&(e.buffer?(e.interval=t,e.samplesIncr=.001*t*e.samplerate/e.buffer.length,e.samplesIncr<1&&(e.samplesIncr=1)):e.reservedinterval=t)},get:function(){return this._.interval}},buffer:{get:function(){return this._.buffer}}}),s.bang=function(){for(var t=this._,e=t.buffer,n=0,i=e.length;i>n;++n)e[n]=0;return t.samples=0,t.writeIndex=0,this._.emit("bang"),this},s.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,n.inputSignalAR(this),n.outputSignalAR(this);var i,r=this.cells[0],s=e.cellsize,o=e.samples,a=e.samplesIncr,l=e.buffer,u=e.writeIndex,h=!1,c=l.length;for(i=0;s>i;++i)0>=o&&(l[u++]=r[i],u>=c&&(u=0),h=e.plotFlush=!0,o+=a),--o;e.samples=o,e.writeIndex=u,h&&this._.emit("data")}return this};var o=t.Object.prototype.plot;s.plot=function(t){var e=this._;if(e.plotFlush){for(var n=e.buffer,i=n.length-1,r=new Float32Array(n.length),s=e.writeIndex,a=0,l=n.length;l>a;a++)r[a]=n[++s&i];e.plotData=r,e.plotFlush=null}return o.call(this,t)},n.register("scope",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),r.fixAR(this);var n=this._;n.numberOfInputs=0,n.numberOfOutputs=0,n.bufferSize=0,n.bufferMask=0,n.duration=0,n.inputBufferL=null,n.inputBufferR=null,n.outputBufferL=null,n.outputBufferR=null,n.onaudioprocess=null,n.index=0,this.once("init",s)}function n(t,e){this.samplerate=t._.samplerate,this.length=t._.bufferSize,this.duration=t._.duration,this.numberOfChannels=e.length,this.getChannelData=function(t){return e[t]}}function i(e){var i=e._;this.node=e,this.playbackTime=t.currentTime,this.inputBuffer=2===i.numberOfInputs?new n(e,[i.inputBufferL,i.inputBufferR]):new n(e,[i.inputBufferL]),this.outputBuffer=2===i.numberOfOutputs?new n(e,[i.outputBufferL,i.outputBufferR]):new n(e,[i.outputBufferL])}var r=t.fn;r.extend(e);var s=function(){var t=this._;0===t.numberOfInputs&&(this.numberOfInputs=1),0===t.numberOfOutputs&&(this.numberOfOutputs=1),0===t.bufferSize&&(this.bufferSize=1024)},o=e.prototype;Object.defineProperties(o,{numberOfInputs:{set:function(t){var e=this._;0===e.numberOfInputs&&(e.numberOfInputs=2===t?2:1)},get:function(){return this._.numberOfInputs}},numberOfOutputs:{set:function(t){var e=this._;0===e.numberOfOutputs&&(e.numberOfOutputs=2===t?2:1)},get:function(){return this._.numberOfOutputs}},bufferSize:{set:function(t){var e=this._;0===e.bufferSize&&-1!==[256,512,1024,2048,4096,8192,16384].indexOf(t)&&(e.bufferSize=t,e.bufferMask=t-1,e.duration=t/e.samplerate,e.inputBufferL=new r.SignalArray(t),e.inputBufferR=new r.SignalArray(t),e.outputBufferL=new r.SignalArray(t),e.outputBufferR=new r.SignalArray(t))},get:function(){return this._.bufferSize}},onaudioprocess:{set:function(t){"function"==typeof t&&(this._.onaudioprocess=t)},get:function(){return this._.onaudioprocess}}}),o.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n,s=e.cellsize,o=e.bufferMask,a=e.index,l=a+s,u=this.cells[1],h=this.cells[2];if(r.inputSignalAR(this),2===e.numberOfInputs)e.inputBufferL.set(u,a),e.inputBufferR.set(h,a);else{n=e.inputBufferL;for(var c=0;s>c;c++)n[a+c]=.5*(u[c]+h[c])}u.set(e.outputBufferL.subarray(a,l)),h.set(e.outputBufferR.subarray(a,l)),e.index=l&o,0===e.index&&e.onaudioprocess&&(e.onaudioprocess(new i(this)),1===e.numberOfOutputs&&e.outputBufferR.set(e.outputBufferL)),r.outputSignalAR(this)}return this},r.register("script",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),this._.selected=0,this._.background=!1}var n=t.fn;n.extend(e);var i=e.prototype;Object.defineProperties(i,{selected:{set:function(t){"number"==typeof t&&(this._.selected=t,this.cells[1].set(n.emptycell),this.cells[2].set(n.emptycell))},get:function(){return this._.selected}},background:{set:function(t){this._.background=!!t},get:function(){return this._.background}}}),i.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,r=this.nodes,s=r.length;if(e.background)for(i=0;s>i;++i)r[i].process(t);var o=r[e.selected];o&&(e.background||o.process(t),this.cells[1].set(o.cells[1]),this.cells[2].set(o.cells[2])),n.outputSignalAR(this)}return this},n.register("selector",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.listener(this),n.fixAR(this);var i=this._;i.status=s,i.samples=0,i.samplesIncr=0,i.writeIndex=0,i.plotFlush=!0,i.plotRange=[0,32],i.plotBarStyle=!0,this.once("init",a)}var n=t.fn,i=t.timevalue,r=t.modules.FFT,s=0,o=1;n.extend(e);var a=function(){var t=this._;t.fft||(this.size=512),t.interval||(this.interval=500)},l=e.prototype;Object.defineProperties(l,{size:{set:function(t){var e=this._;if(!e.fft&&"number"==typeof t){var i=256>t?256:t>2048?2048:t;e.fft=new r(i),e.buffer=new n.SignalArray(e.fft.length),e.freqs=new n.SignalArray(e.fft.length>>1),e.reservedwindow&&(e.fft.setWindow(e.reservedwindow),e.reservedwindow=null),e.reservedinterval&&(this.interval=e.reservedinterval,e.reservedinterval=null)}},get:function(){return this._.buffer.length}},window:{set:function(t){this._.fft.setWindow(t)},get:function(){return this._.fft.windowName}},interval:{set:function(t){var e=this._;"string"==typeof t&&(t=i(t)),"number"==typeof t&&t>0&&(e.buffer?(e.interval=t,e.samplesIncr=.001*t*e.samplerate,e.samplesIncr<e.buffer.length&&(e.samplesIncr=e.buffer.length,e.interval=1e3*e.samplesIncr/e.samplerate)):e.reservedinterval=t)},get:function(){return this._.interval}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}},real:{get:function(){return this._.fft.real}},imag:{get:function(){return this._.fft.imag}}}),l.bang=function(){return this._.samples=0,this._.writeIndex=0,this._.emit("bang"),this},l.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,n.inputSignalAR(this),n.outputSignalAR(this);var i,r,a=this.cells[0],l=a.length,u=e.status,h=e.samples,c=e.samplesIncr,f=e.writeIndex,d=e.buffer,p=d.length;for(i=0;l>i;++i)0>=h&&u===s&&(u=o,f=0,h+=c),u===o&&(d[f++]=a[i],f>=p&&(e.fft.forward(d),r=e.plotFlush=!0,u=s)),--h;e.samples=h,e.status=u,e.writeIndex=f,r&&this._.emit("data")}return this};var u=t.Object.prototype.plot;l.plot=function(t){return this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null),u.call(this,t)},n.register("spectrum",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),this._.ar=!1}var n=t.fn;n.extend(e);var i=e.prototype;i.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,r,s,o,a,l=this.nodes,u=this.cells[0],h=this.cells[1],c=this.cells[2],f=l.length,d=u.length;if(e.ar){if(l.length>0)for(l[0].process(t),o=l[0].cells[1],a=l[0].cells[2],h.set(o),c.set(a),i=1;f>i;++i)for(l[i].process(t),o=l[i].cells[1],a=l[i].cells[2],r=0;d>r;++r)h[r]-=o[r],c[r]-=a[r];else for(r=0;d>r;++r)h[r]=c[i]=0;n.outputSignalAR(this)}else{if(l.length>0)for(s=l[0].process(t).cells[0][0],i=1;f>i;++i)s-=l[i].process(t).cells[0][0];else s=0;u[0]=s,n.outputSignalKR(this)}}return this},n.register("-",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.fixAR(this);var i=this._;this.playbackState=n.FINISHED_STATE,i.poly=4,i.genList=[],i.genDict={},i.synthdef=null,i.remGen=s(this),i.onended=n.make_onended(this)}var n=t.fn;n.extend(e);var i=e.prototype;Object.defineProperties(i,{def:{set:function(t){"function"==typeof t&&(this._.synthdef=t)},get:function(){return this._.synthdef}},poly:{set:function(t){"number"==typeof t&&t>0&&64>=t&&(this._.poly=t);
},get:function(){return this._.poly}}});var r=function(t,e){return function(){t._.remGen(e.gen)}},s=function(t){return function(e){var n=t._,i=n.genList.indexOf(e);-1!==i&&n.genList.splice(i,1),"undefined"!=typeof e.noteNum&&(n.genDict[e.noteNum]=null)}},o=function(e,i,s,o){s|=0,0>=s?this.noteOff(this,e):s>127&&(s=127);var a=this._,l=a.genList,u=a.genDict,h=u[e];h&&a.remGen(h);var c={freq:i,noteNum:e,velocity:s,mul:.0078125*s};if(o)for(var f in o)c[f]=o[f];c.doneAction=r(this,c),h=a.synthdef.call(this,c),h instanceof t.Object&&(h.noteNum=e,l.push(h),u[e]=c.gen=h,this.playbackState=n.PLAYING_STATE,l.length>a.poly&&a.remGen(l[0]))},a=function(){for(var t=new Float32Array(128),e=0;128>e;++e)t[e]=440*Math.pow(2,1*(e-69)/12);return t}(),l=function(t){return t>0?Math.log(1*t/440)*Math.LOG2E*12+69:0};i.noteOn=function(t,e,n){var i=a[t]||440*Math.pow(2,(t-69)/12);return o.call(this,t+.5|0,i,e,n),this},i.noteOff=function(t){var e=this._.genDict[t];return e&&e.release&&e.release(),this},i.noteOnWithFreq=function(t,e,n){var i=l(t);return o.call(this,i+.5|0,t,e,n),this},i.noteOffWithFreq=function(t){var e=l(t);return this.noteOff(e+.5|0)},i.allNoteOff=function(){for(var t=this._.genList,e=0,n=t.length;n>e;++e)t[e].release&&t[e].release()},i.allSoundOff=function(){for(var t=this._,e=t.genList,n=t.genDict;e.length;)delete n[e.shift().noteNum]},i.synth=function(e){var i,s=this._,o=s.genList,a={};if(e)for(var l in e)a[l]=e[l];return a.doneAction=r(this,a),i=s.synthdef.call(this,a),i instanceof t.Object&&(o.push(i),a.gen=i,this.playbackState=n.PLAYING_STATE,o.length>s.poly&&s.remGen(o[0])),this},i.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){if(this.tickID=t,this.playbackState===n.PLAYING_STATE){var r,s,o,a,l,u,h=i.genList,c=this.cells[1],f=this.cells[2],d=e.length;if(h.length)for(r=h[0],r.process(t),c.set(r.cells[1]),f.set(r.cells[2]),s=1,o=h.length;o>s;++s)for(r=h[s],r.process(t),l=r.cells[1],u=r.cells[2],a=0;d>a;++a)c[a]+=l[a],f[a]+=u[a];else n.nextTick(i.onended)}n.outputSignalAR(this)}return this},n.register("SynthDef",e);var u={set:function(e){n.isDictionary(e)?"string"==typeof e.type&&(this._.env=e):e instanceof t.Object&&(this._.env=e)},get:function(){return this._.env}};n.register("OscGen",function(){var n={set:function(e){e instanceof t.Object&&(this._.osc=e)},get:function(){return this._.osc}},i={set:function(t){"string"==typeof t&&(this._.wave=t)},get:function(){return this._.wave}},r=function(e){var n,i,r,s,o=this._;return i=o.osc||null,r=o.env||{},s=r.type||"perc",i instanceof t.Object&&"function"==typeof i.clone&&(i=i.clone()),i||(i=t("osc",{wave:o.wave})),i.freq=e.freq,i.mul=i.mul*e.velocity/128,n=i,r instanceof t.Object?"function"==typeof r.clone&&(n=r.clone().append(n)):n=t(s,r,n),n.on("ended",e.doneAction).bang(),n};return function(t){var s=new e(t);return s._.wave="sin",Object.defineProperties(s,{env:u,osc:n,wave:i}),s.def=r,s}}()),n.register("PluckGen",function(){var n=function(e){var n,i,r,s=this._;return i=s.env||{},r=i.type||"perc",n=t("pluck",{freq:e.freq,mul:e.velocity/128}).bang(),i instanceof t.Object?"function"==typeof i.clone&&(n=i.clone().append(n)):n=t(r,i,n),n.on("ended",e.doneAction).bang(),n};return function(t){var i=new e(t);return Object.defineProperties(i,{env:u}),i.def=n,i}}())}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),n.fixAR(this);var i=this._;i.isLooped=!1,i.onended=n.make_onended(this,0)}var n=t.fn,i=t.modules.Scissor,r=i.Tape,s=i.TapeStream,o=n.isSignalArray;n.extend(e);var a=e.prototype;Object.defineProperties(a,{tape:{set:function(e){e instanceof r?(this.playbackState=n.PLAYING_STATE,this._.tape=e,this._.tapeStream=new s(e,this._.samplerate),this._.tapeStream.isLooped=this._.isLooped):(e instanceof t.Object&&e.buffer&&(e=e.buffer),"object"==typeof e&&Array.isArray(e.buffer)&&o(e.buffer[0])&&(this.playbackState=n.PLAYING_STATE,this._.tape=new i(e),this._.tapeStream=new s(this._.tape,this._.samplerate),this._.tapeStream.isLooped=this._.isLooped))},get:function(){return this._.tape}},isLooped:{get:function(){return this._.isLooped}},buffer:{get:function(){return this._.tape?this._.tape.getBuffer():void 0}}}),a.loop=function(t){return this._.isLooped=!!t,this._.tapeStream&&(this._.tapeStream.isLooped=this._.isLooped),this},a.bang=function(){return this.playbackState=n.PLAYING_STATE,this._.tapeStream&&this._.tapeStream.reset(),this._.emit("bang"),this},a.getBuffer=function(){return this._.tape?this._.tape.getBuffer():void 0},a.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i=e.tapeStream;if(i){var r=this.cells[1],s=this.cells[2],o=i.fetch(r.length);r.set(o[0]),s.set(o[1]),this.playbackState===n.PLAYING_STATE&&i.isEnded&&n.nextTick(e.onended)}n.outputSignalAR(this)}return this},n.register("tape",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),n.timer(this);var i=this._;this.playbackState=n.FINISHED_STATE,i.task=[],i.i=0,i.j=0,i.imax=0,i.jmax=0,i.wait=0,i.count=0,i.args={},i.doNum=1,i.initFunc=n.nop,i.onended=o(this),this.on("start",s)}var n=t.fn,i=t.timevalue,r=t(function(){}).constructor;n.extend(e);var s=function(){var t,e=this._;this.playbackState=n.PLAYING_STATE,e.task=this.nodes.map(function(t){return t instanceof r?t.func:!1}).filter(function(t){return!!t}),e.i=e.j=0,e.imax=e.doNum,e.jmax=e.task.length,t=e.initFunc(),n.isDictionary(t)||(t={param:t}),e.args=t},o=function(t){return function(){t.playbackState=n.FINISHED_STATE;var e=t._,i=t.cells[0],r=t.cells[1],s=t.cells[2],o=e.args;if("number"==typeof o)for(var a=0,l=r.length;l>a;++a)i[0]=r[a]=s[a]=o;e.emit("ended",e.args)}},a=e.prototype;Object.defineProperties(a,{"do":{set:function(t){"number"==typeof t&&t>0&&(this._.doNum=1/0===t?1/0:0|t)},get:function(){return this._.doNum}},init:{set:function(t){"function"==typeof t&&(this._.initFunc=t)},get:function(){return this._.initFunc}}}),a.bang=function(){var t=this._;return t.count=0,t.emit("bang"),this},a.wait=function(t){return"string"==typeof t&&(t=i(t)),"number"==typeof t&&t>0&&(this._.count+=this._.samplerate*t*.001|0),this},a.process=function(t){var e,i=this.cells[0],r=this._;if(this.tickID!==t&&(this.tickID=t,r.i<r.imax)){for(;r.count<=0;){if(r.j>=r.jmax){if(++r.i,r.i>=r.imax){n.nextTick(r.onended);break}r.j=0}e=r.task[r.j++],e&&e.call(this,r.i,r.args)}r.count-=i.length}return this},n.register("task",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,0,e),n.timer(this),n.fixKR(this);var i=this._;this.playbackState=n.FINISHED_STATE,i.currentTime=0,i.samplesMax=0,i.samples=0,i.onended=n.make_onended(this),this.once("init",r),this.on("start",s)}var n=t.fn,i=t.timevalue;n.extend(e);var r=function(){this._.timeout||(this.timeout=1e3)},s=function(){this.playbackState=n.PLAYING_STATE};Object.defineProperty(s,"unremovable",{value:!0,writable:!1});var o=e.prototype;Object.defineProperties(o,{timeout:{set:function(t){var e=this._;"string"==typeof t&&(t=i(t)),"number"==typeof t&&t>=0&&(this.playbackState=n.PLAYING_STATE,e.timeout=t,e.samplesMax=.001*e.samplerate*t|0,e.samples=e.samplesMax)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}}),o.bang=function(){var t=this._;return this.playbackState=n.PLAYING_STATE,t.samples=t.samplesMax,t.currentTime=0,t.emit("bang"),this},o.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){if(this.tickID=t,i.samples>0&&(i.samples-=e.length),i.samples<=0){for(var r=this.nodes,s=0,o=r.length;o>s;++s)r[s].bang();n.nextTick(i.onended)}i.currentTime+=n.currentTimeIncr}return this},n.register("timeout",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),n.fixAR(this),this._.curve=null}var n=t.fn;n.extend(e);var i=e.prototype;Object.defineProperties(i,{curve:{set:function(t){n.isSignalArray(t)&&(this._.curve=t)},get:function(){return this._.curve}}}),i.process=function(t){var e=this._;if(this.tickID!==t){if(this.tickID=t,n.inputSignalAR(this),e.curve){var i,r,s=this.cells[0],o=e.curve,a=o.length,l=e.cellsize;for(r=0;l>r;++r)i=.5*(s[r]+1)*a+.5|0,0>i?i=0:i>=a-1&&(i=a-1),s[r]=o[i]}n.outputSignalAR(this)}return this},n.register("waveshaper",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e);var n=this._;n.inMin=0,n.inMax=1,n.outMin=0,n.outMax=1,n.ar=!1,this.once("init",i)}var n=t.fn;n.extend(e);var i=function(){this._.warp||(this.warp="linlin")},r=e.prototype;Object.defineProperties(r,{inMin:{set:function(t){"number"==typeof t&&(this._.inMin=t)},get:function(){return this._.inMin}},inMax:{set:function(t){"number"==typeof t&&(this._.inMax=t)},get:function(){return this._.inMax}},outMin:{set:function(t){"number"==typeof t&&(this._.outMin=t)},get:function(){return this._.outMin}},outMax:{set:function(t){"number"==typeof t&&(this._.outMax=t)},get:function(){return this._.outMax}},warp:{set:function(t){if("string"==typeof t){var e=s[t];e&&(this._.warp=e,this._.warpName=t)}},get:function(){return this._.warpName}}}),r.process=function(t){var e=this._,i=this.cells[0];if(this.tickID!==t){this.tickID=t;var r,s=e.inMin,o=e.inMax,a=e.outMin,l=e.outMax,u=e.warp,h=this.nodes.length,c=e.mul,f=e.add,d=i.length;if(e.ar&&h){for(n.inputSignalAR(this),r=0;d>r;++r)i[r]=u(i[r],s,o,a,l)*c+f;n.outputSignalAR(this)}else{var p=this.nodes.length?n.inputSignalKR(this):0,m=u(p,s,o,a,l)*c+f;for(r=0;d>r;++r)i[r]=m}}return this};var s={linlin:function(t,e,n,i,r){return e>t?i:t>n?r:n===e?i:(t-e)/(n-e)*(r-i)+i},linexp:function(t,e,n,i,r){return e>t?i:t>n?r:0===i?0:n===e?r:Math.pow(r/i,(t-e)/(n-e))*i},explin:function(t,e,n,i,r){return e>t?i:t>n?r:0===e?r:Math.log(t/e)/Math.log(n/e)*(r-i)+i},expexp:function(t,e,n,i,r){return e>t?i:t>n?r:0===e||0===i?0:Math.pow(r/i,Math.log(t/e)/Math.log(n/e))*i}};n.register("zmap",e)}(timbre);